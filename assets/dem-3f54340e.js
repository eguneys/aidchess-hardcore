var np=Object.defineProperty;var cp=(h,m,b)=>m in h?np(h,m,{enumerable:!0,configurable:!0,writable:!0,value:b}):h[m]=b;var kr=(h,m,b)=>(cp(h,typeof m!="symbol"?m+"":m,b),b);import{a as Be,l as op,b as fe,h as yr,o as _i,i as Ae,c as We,j as up,D as vp,S as gp,d as wr,e as pp,F as $p,t as te,n as hp,f as dp,s as Ei}from"./index-099accc5.js";import{C as _r}from"./chess-ece2668e.js";import{S as mp,l as bp,K as Ap}from"./solid-play-4a5fadff.js";import{G as Cp}from"./ground-6008c6c3.js";import{s as kp,R as Si}from"./replay_chess-a5cf569d.js";import"./util-2d6699b1.js";let yp=/^https:\/\/lichess\.org\/study\/([A-Za-z0-9]{8})$/;const wp=["https://lichess.org/study/8Bu5aigE"];async function _p(h){let m=h.match(yp);if(m){let b=`${m[1]}`,x=await Ep(m[1]);return{matched_reg:b,pgn:x}}}function Ep(h){return fetch(`https://lichess.org/api/study/${h}.pgn`).then(m=>m.text())}var Er=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xe={},Sp={get exports(){return Xe},set exports(h){Xe=h}};(function(h,m){(function(b,x){x(m)})(Er,function(b){var x=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Er<"u"?Er:typeof self<"u"?self:{},_={},X={get exports(){return _},set exports(T){_=T}};(function(T){(function(W,N){T.exports&&(T.exports=N())})(x,function(){function W(t,A){function r(){this.constructor=t}r.prototype=A.prototype,t.prototype=new r}function N(t,A,r,O){var K=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(K,N.prototype),K.expected=A,K.found=r,K.location=O,K.name="SyntaxError",K}W(N,Error);function P(t,A,r){return r=r||" ",t.length>A?t:(A-=t.length,r+=r.repeat(A),t+r.slice(0,A))}N.prototype.format=function(t){var A="Error: "+this.message;if(this.location){var r=null,O;for(O=0;O<t.length;O++)if(t[O].source===this.location.source){r=t[O].text.split(/\r\n|\n|\r/g);break}var K=this.location.start,M=this.location.source+":"+K.line+":"+K.column;if(r){var V=this.location.end,G=P("",K.line.toString().length," "),j=r[K.line-1],S=K.line===V.line?V.column:j.length+1,w=S-K.column||1;A+=`
 --> `+M+`
`+G+` |
`+K.line+" | "+j+`
`+G+" | "+P("",K.column-1," ")+P("",w,"^")}else A+=`
 at `+M}return A},N.buildMessage=function(t,A){var r={literal:function(S){return'"'+K(S.text)+'"'},class:function(S){var w=S.parts.map(function(D){return Array.isArray(D)?M(D[0])+"-"+M(D[1]):M(D)});return"["+(S.inverted?"^":"")+w.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(S){return S.description}};function O(S){return S.charCodeAt(0).toString(16).toUpperCase()}function K(S){return S.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+O(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+O(w)})}function M(S){return S.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+O(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+O(w)})}function V(S){return r[S.type](S)}function G(S){var w=S.map(V),D,J;if(w.sort(),w.length>0){for(D=1,J=1;D<w.length;D++)w[D-1]!==w[D]&&(w[J]=w[D],J++);w.length=J}switch(w.length){case 1:return w[0];case 2:return w[0]+" or "+w[1];default:return w.slice(0,-1).join(", ")+", or "+w[w.length-1]}}function j(S){return S?'"'+K(S)+'"':"end of input"}return"Expected "+G(t)+" but "+j(A)+" found."};function F(t,A){A=A!==void 0?A:{};var r={},O=A.grammarSource,K={pgn:xe,tags:Pa,game:Ye,games:sg},M=xe,V="Event",G="event",j="Site",S="site",w="Date",D="date",J="Round",C="round",B="White",z="white",ie="Black",Oe="black",De="Result",Ue="result",Ne="WhiteTitle",de="Whitetitle",ye="whitetitle",ne="whiteTitle",Ke="BlackTitle",Pe="Blacktitle",Tr="blacktitle",Br="blackTitle",Nr="WhiteELO",Kr="WhiteElo",Fr="Whiteelo",xr="whiteelo",Rr="whiteElo",Wr="BlackELO",Or="BlackElo",Dr="Blackelo",Ur="blackelo",Pr="blackElo",jr="WhiteUSCF",Ir="WhiteUscf",Mr="Whiteuscf",Gr="whiteuscf",Vr="whiteUscf",zr="BlackUSCF",Qr="BlackUscf",qr="Blackuscf",Lr="blackuscf",Yr="blackUscf",Zr="WhiteNA",Hr="WhiteNa",Jr="Whitena",Xr="whitena",es="whiteNa",rs="whiteNA",ss="BlackNA",fs="BlackNa",as="Blackna",is="blackna",ts="blackNA",ls="blackNa",ns="WhiteType",cs="Whitetype",os="whitetype",us="whiteType",vs="BlackType",gs="Blacktype",ps="blacktype",$s="blackType",hs="EventDate",ds="Eventdate",ms="eventdate",bs="eventDate",As="EventSponsor",Cs="Eventsponsor",ks="eventsponsor",ys="eventSponsor",ws="Section",_s="section",Es="Stage",Ss="stage",Ts="Board",Bs="board",Ns="Opening",Ks="opening",Fs="Variation",xs="variation",Rs="SubVariation",Ws="Subvariation",Os="subvariation",Ds="subVariation",Us="ECO",Ps="Eco",js="eco",Is="NIC",Ms="Nic",Gs="nic",Vs="Time",zs="time",Qs="UTCTime",qs="UTCtime",Ls="UtcTime",Ys="Utctime",Zs="utctime",Hs="utcTime",Js="UTCDate",Xs="UTCdate",ef="UtcDate",rf="Utcdate",sf="utcdate",ff="utcDate",af="TimeControl",tf="Timecontrol",lf="timecontrol",nf="timeControl",cf="SetUp",of="Setup",uf="setup",vf="setUp",gf="FEN",pf="Fen",$f="fen",hf="Termination",df="termination",mf="Annotator",bf="annotator",Af="Mode",Cf="mode",kf="PlyCount",yf="Plycount",wf="plycount",_f="plyCount",Ef="Variant",Sf="variant",Tf="WhiteRatingDiff",Bf="BlackRatingDiff",Nf="WhiteFideId",Kf="BlackFideId",Ff="WhiteTeam",xf="BlackTeam",Rf="Clock",Wf="WhiteClock",Of="BlackClock",je='"',Df="\\",Ie=".",we=":",er="/",Uf="B",Di="W",Ui="N",Pf="?",rr="-",sr="+",jf="*",If="1-0",Mf="0-1",Gf="1/2-1/2",Vf="=",zf="%csl",Qf="%cal",fr="%",qf="%eval",Lf="[%",Yf="}",Me=",",Pi="Y",ji="G",Ii="R",Mi="{",Gi="[",Vi="]",zi=";",Zf="clk",Hf="egt",Jf="emt",Xf="mct",Qi="(",qi=")",ea=" ",Li="e.p.",ra="O-O-O",sa="O-O",Yi="@",Ge="+-",fa="$$$",Zi="#",Hi="$",aa="!!",ia="??",ta="!?",la="?!",Ji="!",Xi="‼",et="⁇",rt="⁉",st="⁈",ft="□",at="∞",it="⩲",tt="⩱",lt="±",nt="∓",na="-+",ct="⨀",ot="⟳",ut="→",vt="↑",gt="⇆",pt="D",ca="x",_e=/^[ \t\n\r]/,oa=/^[\n\r]/,ua=/^[\-a-zA-Z0-9.]/,$t=/^[^"\\\r\n]/,ce=/^[0-9?]/,Y=/^[0-9]/,va=/^[^\n\r]/,ht=/^[RNBQKP]/,dt=/^[RNBQ]/,mt=/^[a-h]/,bt=/^[1-8]/,At=c("Event",!1),Ct=c("event",!1),kt=c("Site",!1),yt=c("site",!1),wt=c("Date",!1),_t=c("date",!1),Et=c("Round",!1),St=c("round",!1),Tt=c("White",!1),Bt=c("white",!1),Nt=c("Black",!1),Kt=c("black",!1),Ft=c("Result",!1),xt=c("result",!1),Rt=c("WhiteTitle",!1),Wt=c("Whitetitle",!1),Ot=c("whitetitle",!1),Dt=c("whiteTitle",!1),Ut=c("BlackTitle",!1),Pt=c("Blacktitle",!1),jt=c("blacktitle",!1),It=c("blackTitle",!1),Mt=c("WhiteELO",!1),Gt=c("WhiteElo",!1),Vt=c("Whiteelo",!1),zt=c("whiteelo",!1),Qt=c("whiteElo",!1),qt=c("BlackELO",!1),Lt=c("BlackElo",!1),Yt=c("Blackelo",!1),Zt=c("blackelo",!1),Ht=c("blackElo",!1),Jt=c("WhiteUSCF",!1),Xt=c("WhiteUscf",!1),el=c("Whiteuscf",!1),rl=c("whiteuscf",!1),sl=c("whiteUscf",!1),fl=c("BlackUSCF",!1),al=c("BlackUscf",!1),il=c("Blackuscf",!1),tl=c("blackuscf",!1),ll=c("blackUscf",!1),nl=c("WhiteNA",!1),cl=c("WhiteNa",!1),ol=c("Whitena",!1),ul=c("whitena",!1),vl=c("whiteNa",!1),gl=c("whiteNA",!1),pl=c("BlackNA",!1),$l=c("BlackNa",!1),hl=c("Blackna",!1),dl=c("blackna",!1),ml=c("blackNA",!1),bl=c("blackNa",!1),Al=c("WhiteType",!1),Cl=c("Whitetype",!1),kl=c("whitetype",!1),yl=c("whiteType",!1),wl=c("BlackType",!1),_l=c("Blacktype",!1),El=c("blacktype",!1),Sl=c("blackType",!1),Tl=c("EventDate",!1),Bl=c("Eventdate",!1),Nl=c("eventdate",!1),Kl=c("eventDate",!1),Fl=c("EventSponsor",!1),xl=c("Eventsponsor",!1),Rl=c("eventsponsor",!1),Wl=c("eventSponsor",!1),Ol=c("Section",!1),Dl=c("section",!1),Ul=c("Stage",!1),Pl=c("stage",!1),jl=c("Board",!1),Il=c("board",!1),Ml=c("Opening",!1),Gl=c("opening",!1),Vl=c("Variation",!1),zl=c("variation",!1),Ql=c("SubVariation",!1),ql=c("Subvariation",!1),Ll=c("subvariation",!1),Yl=c("subVariation",!1),Zl=c("ECO",!1),Hl=c("Eco",!1),Jl=c("eco",!1),Xl=c("NIC",!1),en=c("Nic",!1),rn=c("nic",!1),sn=c("Time",!1),fn=c("time",!1),an=c("UTCTime",!1),tn=c("UTCtime",!1),ln=c("UtcTime",!1),nn=c("Utctime",!1),cn=c("utctime",!1),on=c("utcTime",!1),un=c("UTCDate",!1),vn=c("UTCdate",!1),gn=c("UtcDate",!1),pn=c("Utcdate",!1),$n=c("utcdate",!1),hn=c("utcDate",!1),dn=c("TimeControl",!1),mn=c("Timecontrol",!1),bn=c("timecontrol",!1),An=c("timeControl",!1),Cn=c("SetUp",!1),kn=c("Setup",!1),yn=c("setup",!1),wn=c("setUp",!1),_n=c("FEN",!1),En=c("Fen",!1),Sn=c("fen",!1),Tn=c("Termination",!1),Bn=c("termination",!1),Nn=c("Annotator",!1),Kn=c("annotator",!1),Fn=c("Mode",!1),xn=c("mode",!1),Rn=c("PlyCount",!1),Wn=c("Plycount",!1),On=c("plycount",!1),Dn=c("plyCount",!1),Un=c("Variant",!1),Pn=c("variant",!1),jn=c("WhiteRatingDiff",!1),In=c("BlackRatingDiff",!1),Mn=c("WhiteFideId",!1),Gn=c("BlackFideId",!1),Vn=c("WhiteTeam",!1),zn=c("BlackTeam",!1),Qn=c("Clock",!1),qn=c("WhiteClock",!1),Ln=c("BlackClock",!1),ga=Da("whitespace"),Ee=ee([" ","	",`
`,"\r"],!1,!1),pa=ee([`
`,"\r"],!1,!1),$a=ee(["-",["a","z"],["A","Z"],["0","9"],"."],!1,!1),Ve=c('"',!1),Yn=ee(['"',"\\","\r",`
`],!0,!1),ha=c("\\",!1),oe=ee([["0","9"],"?"],!1,!1),ze=c(".",!1),Z=ee([["0","9"]],!1,!1),Se=c(":",!1),ar=c("/",!1),da=c("B",!1),Zn=c("W",!1),Hn=c("N",!1),ma=c("?",!1),ir=c("-",!1),tr=c("+",!1),ba=c("*",!1),Jn=c("1-0",!1),Xn=c("0-1",!1),ec=c("1/2-1/2",!1),lr=c("=",!1),rc=c("%csl",!1),sc=c("%cal",!1),nr=c("%",!1),fc=c("%eval",!1),ac=c("[%",!1),Aa=c("}",!1),Ca=Xv(),ka=ee([`
`,"\r"],!0,!1),Qe=c(",",!1),ic=c("Y",!1),tc=c("G",!1),lc=c("R",!1),nc=c("{",!1),cc=c("[",!1),oc=c("]",!1),uc=c(";",!1),vc=c("clk",!1),gc=c("egt",!1),pc=c("emt",!1),$c=c("mct",!1),hc=c("(",!1),dc=c(")",!1),mc=Da("integer"),ya=c(" ",!1),bc=c("e.p.",!1),Ac=c("O-O-O",!1),Cc=c("O-O",!1),kc=c("@",!1),wa=c("+-",!1),yc=c("$$$",!1),wc=c("#",!1),_c=c("$",!1),Ec=c("!!",!1),Sc=c("??",!1),Tc=c("!?",!1),Bc=c("?!",!1),Nc=c("!",!1),Kc=c("‼",!1),Fc=c("⁇",!1),xc=c("⁉",!1),Rc=c("⁈",!1),Wc=c("□",!1),Oc=c("∞",!1),Dc=c("⩲",!1),Uc=c("⩱",!1),Pc=c("±",!1),jc=c("∓",!1),Ic=c("-+",!1),Mc=c("⨀",!1),Gc=c("⟳",!1),Vc=c("→",!1),zc=c("↑",!1),Qc=c("⇆",!1),qc=c("D",!1),Lc=ee(["R","N","B","Q","K","P"],!1,!1),Yc=ee(["R","N","B","Q"],!1,!1),Zc=ee([["a","h"]],!1,!1),Hc=ee([["1","8"]],!1,!1),_a=c("x",!1),Ea=function(e,f){return f},Jc=function(e,f){return[e].concat(f)},Xc=function(e){return e},eo=function(e,f,i){var a=Je;return Je=[],{tags:e,gameComment:f,moves:i,messages:a}},Sa=function(e,f){return f},ro=function(e,f){var i={};return[e].concat(f).forEach(function(a){i[a.name]=a.value}),i},so=function(e){return e===null?{}:(e.messages=Je,e)},fo=function(e){return e},ao=function(e){return{name:"Event",value:e}},io=function(e){return{name:"Site",value:e}},to=function(e){return{name:"Date",value:e}},lo=function(e){return{name:"Round",value:e}},no=function(e){return{name:"WhiteTitle",value:e}},co=function(e){return{name:"BlackTitle",value:e}},oo=function(e){return{name:"WhiteElo",value:e}},uo=function(e){return{name:"BlackElo",value:e}},vo=function(e){return{name:"WhiteUSCF",value:e}},go=function(e){return{name:"BlackUSCF",value:e}},po=function(e){return{name:"WhiteNA",value:e}},$o=function(e){return{name:"BlackNA",value:e}},ho=function(e){return{name:"WhiteType",value:e}},mo=function(e){return{name:"BlackType",value:e}},bo=function(e){return{name:"White",value:e}},Ao=function(e){return{name:"Black",value:e}},Co=function(e){return{name:"Result",value:e}},ko=function(e){return{name:"EventDate",value:e}},yo=function(e){return{name:"EventSponsor",value:e}},wo=function(e){return{name:"Section",value:e}},_o=function(e){return{name:"Stage",value:e}},Eo=function(e){return{name:"Board",value:e}},So=function(e){return{name:"Opening",value:e}},To=function(e){return{name:"Variation",value:e}},Bo=function(e){return{name:"SubVariation",value:e}},No=function(e){return{name:"ECO",value:e}},Ko=function(e){return{name:"NIC",value:e}},Fo=function(e){return{name:"Time",value:e}},xo=function(e){return{name:"UTCTime",value:e}},Ro=function(e){return{name:"UTCDate",value:e}},Wo=function(e){return{name:"TimeControl",value:e}},Oo=function(e){return{name:"SetUp",value:e}},Do=function(e){return{name:"FEN",value:e}},Uo=function(e){return{name:"Termination",value:e}},Po=function(e){return{name:"Annotator",value:e}},jo=function(e){return{name:"Mode",value:e}},Io=function(e){return{name:"PlyCount",value:e}},Mo=function(e){return{name:"Variant",value:e}},Go=function(e){return{name:"WhiteRatingDiff",value:e}},Vo=function(e){return{name:"BlackRatingDiff",value:e}},zo=function(e){return{name:"WhiteFideId",value:e}},Qo=function(e){return{name:"BlackFideId",value:e}},qo=function(e){return{name:"WhiteTeam",value:e}},Lo=function(e){return{name:"BlackTeam",value:e}},Yo=function(e){return{name:"Clock",value:e}},Zo=function(e){return{name:"WhiteClock",value:e}},Ho=function(e){return{name:"BlackClock",value:e}},Jo=function(e,f){return L({key:e,value:f,message:`Format of tag: "${e}" not correct: "${f}"`}),{name:e,value:f}},Xo=function(e,f){return L({key:e,value:f,message:`Tag: "${e}" not known: "${f}"`}),{name:e,value:f}},eu=function(e){return e.join("")},ru=function(e){return e.map(f=>f.char||f).join("")},su=function(){return{type:"char",char:"\\"}},fu=function(){return{type:"char",char:'"'}},au=function(e){return e},iu=function(e,f,i){return{value:""+e.join("")+"."+f.join("")+"."+i.join(""),year:be(e),month:be(f),day:be(i)}},tu=function(e,f,i,a){let o=e.join("")+":"+f.join("")+":"+i.join(""),v=0;return a&&(o=o+"."+a,L({message:`Unusual use of millis in time: ${o}`}),be(a)),{value:o,hour:be(e),minute:be(f),second:be(i),millis:v}},lu=function(e){return e.join("")},nu=function(e){return e},cu=function(e,f){return e+"/"+f},ou=function(e){return e},uu=function(e){return e},vu=function(e){return e||(L({message:"Tag TimeControl has to have a value"}),"")},Ta=function(e,f){return f},gu=function(e,f){return[e].concat(f)},pu=function(e){return e},$u=function(){return{kind:"unknown",value:"?"}},hu=function(){return{kind:"unlimited",value:"-"}},du=function(e,f,i){return{kind:"movesInSecondsIncrement",moves:e,seconds:f,increment:i}},mu=function(e,f){return{kind:"movesInSeconds",moves:e,seconds:f}},bu=function(e,f){return{kind:"increment",seconds:e,increment:f}},Au=function(e){return{kind:"suddenDeath",seconds:e}},Cu=function(e){return{kind:"hourglass",seconds:e}},ku=function(e){return e},yu=function(e){return e},wu=function(e){return e},_u=function(e){return e},Eu=function(e){return e},Su=function(e){return e},Tu=function(){return 0},Bu=function(){return L({message:'Use "-" for an unknown value'}),0},Nu=function(e){return Cr(e)},Ku=function(e,f,i,a,o,v,g,$){var k=$||[],R={};return R.moveNumber=f,R.notation=i,v&&(R.commentAfter=v.comment),e&&(R.commentMove=e.comment),o&&(R.drawOffer=!0),R.variations=g||[],R.nag=a||null,k.unshift(R),R.commentDiag=v,k},Fu=function(e){return e},xu=function(e){return[e]},Ba=function(e,f){return f},Ru=function(e,f){return $e([e].concat(f))},Wu=function(e){return e},Ou=function(e){return{comment:e}},Na=function(e,f){return f},Du=function(e,f){return $e([{colorFields:e}].concat(f[0]))},Ka=function(e,f){return f},Uu=function(e,f){return $e([{colorArrows:e}].concat(f[0]))},Fa=function(e,f,i){return i},Pu=function(e,f,i){var a={};return a[e]=f,$e([a].concat(i[0]))},xa=function(e,f,i){return i},ju=function(e,f,i){var a={};return a[e]=f,$e([a].concat(i[0]))},Ra=function(e,f){return f},Iu=function(e,f){var i={};return i.eval=parseFloat(e),$e([i].concat(f[0]))},Wa=function(e,f,i){return i},Mu=function(e,f,i){var a={};return a[e]=f.join(""),$e([a].concat(i[0]))},Oa=function(e,f){return f},Gu=function(e,f){return f.length>0?$e([{comment:wi(e.join(""))}].concat(yi(f[0]))):{comment:e.join("")}},Vu=function(e){return e},zu=function(e){return e},Qu=function(e){return e.join("")},qu=function(e,f){var i=[];i.push(e);for(var a=0;a<f.length;a++)i.push(f[a][2]);return i},Lu=function(e,f){return e+f},Yu=function(e,f){var i=[];i.push(e);for(var a=0;a<f.length;a++)i.push(f[a][2]);return i},Zu=function(e,f,i){return e+f+i},Hu=function(){return"Y"},Ju=function(){return"G"},Xu=function(){return"R"},ev=function(){return"B"},rv=function(e,f){return e+f},sv=function(){return"clk"},fv=function(){return"egt"},av=function(){return"emt"},iv=function(){return"mct"},tv=function(e,f,i,a){let o=f;return e?o=e+o:L({message:"Hours and minutes missing"}),e&&(e.match(/:/g)||[]).length==2&&e.search(":")==2&&L({message:"Only 1 digit for hours normally used"}),i?o+=i:L({message:"Only 2 digit for seconds normally used"}),a&&(L({message:"Unusual use of millis in clock value"}),o+="."+a),o},lv=function(e,f,i){let a=f;return e?a=e+a:L({message:"Hours and minutes missing"}),e&&(e.match(/:/g)||[]).length==2&&e.search(":")==1&&L({message:"Only 2 digits for hours normally used"}),i?a+=i:L({message:"Only 2 digit for seconds normally used"}),a},nv=function(e,f){return f?e+f:(L({message:"No hours found"}),e)},cv=function(e,f){let i=e;return f?i+=f+":":i+=":",i},ov=function(e,f){let i=e;return f?i+=f+":":(i+=":",L({message:"Only 2 digits for minutes normally used"})),i},uv=function(e){return e},vv=function(e,f){var i=f||[];return i.unshift(e),i},gv=function(e){return e},pv=function(e){return Cr(e)},$v=function(){return""},hv=function(e,f,i,a,o,v,g){var $={};return $.fig=e||null,$.disc=f||null,$.strike=i||null,$.col=a,$.row=o,$.check=g||null,$.promotion=v,$.notation=(e||"")+(f||"")+(i||"")+a+o+(v||"")+(g||""),$},dv=function(e,f,i,a,o,v,g,$){var k={};return k.fig=e||null,k.strike=a=="x"?a:null,k.col=o,k.row=v,k.notation=(e&&e!=="P"?e:"")+f+i+(a=="x"?a:"-")+o+v+(g||"")+($||""),k.check=$||null,k.promotion=g,k},mv=function(e,f,i,a,o,v){var g={};return g.fig=e||null,g.strike=f||null,g.col=i,g.row=a,g.check=v||null,g.promotion=o,g.notation=(e||"")+(f||"")+i+a+(o||"")+(v||""),g},bv=function(e){var f={};return f.notation="O-O-O"+(e||""),f.check=e||null,f},Av=function(e){var f={};return f.notation="O-O"+(e||""),f.check=e||null,f},Cv=function(e,f,i){var a={};return a.fig=e,a.drop=!0,a.col=f,a.row=i,a.notation=e+"@"+f+i,a},kv=function(e){return e[1]},yv=function(e){return e[1]},wv=function(e){return"="+e},_v=function(e,f){var i=f||[];return i.unshift(e),i},Ev=function(e){return"$"+e},Sv=function(){return"$3"},Tv=function(){return"$4"},Bv=function(){return"$5"},Nv=function(){return"$6"},Kv=function(){return"$1"},Fv=function(){return"$2"},xv=function(){return"$3"},Rv=function(){return"$4"},Wv=function(){return"$5"},Ov=function(){return"$6"},Dv=function(){return"$7"},Uv=function(){return"$10"},Pv=function(){return"$13"},jv=function(){return"$14"},Iv=function(){return"$15"},Mv=function(){return"$16"},Gv=function(){return"$17"},Vv=function(){return"$18"},zv=function(){return"$19"},Qv=function(){return"$22"},qv=function(){return"$32"},Lv=function(){return"$36"},Yv=function(){return"$40"},Zv=function(){return"$132"},Hv=function(){return"$220"},s=0,u=0,qe=[{line:1,column:1}],se=0,cr=[],l=0,Le;if("startRule"in A){if(!(A.startRule in K))throw new Error(`Can't start parsing from rule "`+A.startRule+'".');M=K[A.startRule]}function Jv(){return or(u,s)}function c(e,f){return{type:"literal",text:e,ignoreCase:f}}function ee(e,f,i){return{type:"class",parts:e,inverted:f,ignoreCase:i}}function Xv(){return{type:"any"}}function eg(){return{type:"end"}}function Da(e){return{type:"other",description:e}}function Ua(e){var f=qe[e],i;if(f)return f;for(i=e-1;!qe[i];)i--;for(f=qe[i],f={line:f.line,column:f.column};i<e;)t.charCodeAt(i)===10?(f.line++,f.column=1):f.column++,i++;return qe[e]=f,f}function or(e,f){var i=Ua(e),a=Ua(f);return{source:O,start:{offset:e,line:i.line,column:i.column},end:{offset:f,line:a.line,column:a.column}}}function n(e){s<se||(s>se&&(se=s,cr=[]),cr.push(e))}function rg(e,f,i){return new N(N.buildMessage(e,f),e,f,i)}function sg(){var e,f,i,a,o,v;if(e=s,p(),f=s,i=Ye(),i!==r){for(a=[],o=s,p(),v=Ye(),v!==r?(u=o,o=Ea(i,v)):(s=o,o=r);o!==r;)a.push(o),o=s,p(),v=Ye(),v!==r?(u=o,o=Ea(i,v)):(s=o,o=r);u=f,f=Jc(i,a)}else s=f,f=r;return f===r&&(f=null),u=e,e=Xc(f),e}function Ye(){var e,f,i,a;return e=s,f=Pa(),i=pr(),i===r&&(i=null),a=xe(),a!==r?(u=e,e=eo(f,i,a)):(s=e,e=r),e}function Pa(){var e,f,i,a,o,v;if(e=s,p(),f=s,i=ur(),i!==r){for(a=[],o=s,p(),v=ur(),v!==r?(u=o,o=Sa(i,v)):(s=o,o=r);o!==r;)a.push(o),o=s,p(),v=ur(),v!==r?(u=o,o=Sa(i,v)):(s=o,o=r);u=f,f=ro(i,a)}else s=f,f=r;return f===r&&(f=null),i=p(),u=e,e=so(f),e}function ur(){var e,f,i,a;return e=s,f=me(),f!==r?(p(),i=fg(),i!==r?(p(),a=ue(),a!==r?(u=e,e=fo(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function fg(){var e,f,i,a,o;return e=s,f=ag(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=ao(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=ig(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=io(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ia(),f!==r?(i=p(),a=vr(),a!==r?(u=e,e=to(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=tg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=lo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=cg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=no(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=og(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=co(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ga(),f!==r?(i=p(),a=oi(),a!==r?(u=e,e=oo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Va(),f!==r?(i=p(),a=oi(),a!==r?(u=e,e=uo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=za(),f!==r?(i=p(),a=Fe(),a!==r?(u=e,e=vo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Qa(),f!==r?(i=p(),a=Fe(),a!==r?(u=e,e=go(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=ug(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=po(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=vg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=$o(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=gg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=ho(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=pg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=mo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=lg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=bo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=ng(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Ao(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ma(),f!==r?(i=p(),a=Mg(),a!==r?(u=e,e=Co(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=qa(),f!==r?(i=p(),a=vr(),a!==r?(u=e,e=ko(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=$g(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=yo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=hg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=wo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=dg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=_o(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=La(),f!==r?(i=p(),a=Fe(),a!==r?(u=e,e=Eo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=mg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=So(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=bg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=To(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ag(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Bo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Cg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=No(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=kg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Ko(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ya(),f!==r?(i=p(),a=ii(),a!==r?(u=e,e=Fo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Za(),f!==r?(i=p(),a=ii(),a!==r?(u=e,e=xo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ha(),f!==r?(i=p(),a=vr(),a!==r?(u=e,e=Ro(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ja(),f!==r?(i=p(),a=jg(),a!==r?(u=e,e=Wo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=yg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Oo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=wg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Do(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=_g(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Uo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Eg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Po(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Sg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=jo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Xa(),f!==r?(i=p(),a=Fe(),a!==r?(u=e,e=Io(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Tg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Mo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Bg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Go(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ng(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Vo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Kg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=zo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Fg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Qo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=xg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=qo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Rg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Lo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=ei(),f!==r?(i=p(),a=Dg(),a!==r?(u=e,e=Yo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=ri(),f!==r?(i=p(),a=li(),a!==r?(u=e,e=Zo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=si(),f!==r?(i=p(),a=li(),a!==r?(u=e,e=Ho(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=s,l++,i=ja(),l--,i!==r?(s=f,f=void 0):f=r,f!==r?(i=Ze(),a=p(),o=E(),o!==r?(u=e,e=Jo(i,o)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=s,l++,i=ja(),l--,i===r?f=void 0:(s=f,f=r),f!==r?(i=Ze(),a=p(),o=E(),o!==r?(u=e,e=Xo(i,o)):(s=e,e=r)):(s=e,e=r))))))))))))))))))))))))))))))))))))))))))))))))),e}function ja(){var e;return e=Ia(),e===r&&(e=Ga(),e===r&&(e=Va(),e===r&&(e=za(),e===r&&(e=Qa(),e===r&&(e=Ma(),e===r&&(e=qa(),e===r&&(e=La(),e===r&&(e=Ya(),e===r&&(e=Za(),e===r&&(e=Ha(),e===r&&(e=Ja(),e===r&&(e=Xa(),e===r&&(e=ei(),e===r&&(e=ri(),e===r&&(e=si()))))))))))))))),e}function ag(){var e;return t.substr(s,5)===V?(e=V,s+=5):(e=r,l===0&&n(At)),e===r&&(t.substr(s,5)===G?(e=G,s+=5):(e=r,l===0&&n(Ct))),e}function ig(){var e;return t.substr(s,4)===j?(e=j,s+=4):(e=r,l===0&&n(kt)),e===r&&(t.substr(s,4)===S?(e=S,s+=4):(e=r,l===0&&n(yt))),e}function Ia(){var e;return t.substr(s,4)===w?(e=w,s+=4):(e=r,l===0&&n(wt)),e===r&&(t.substr(s,4)===D?(e=D,s+=4):(e=r,l===0&&n(_t))),e}function tg(){var e;return t.substr(s,5)===J?(e=J,s+=5):(e=r,l===0&&n(Et)),e===r&&(t.substr(s,5)===C?(e=C,s+=5):(e=r,l===0&&n(St))),e}function lg(){var e;return t.substr(s,5)===B?(e=B,s+=5):(e=r,l===0&&n(Tt)),e===r&&(t.substr(s,5)===z?(e=z,s+=5):(e=r,l===0&&n(Bt))),e}function ng(){var e;return t.substr(s,5)===ie?(e=ie,s+=5):(e=r,l===0&&n(Nt)),e===r&&(t.substr(s,5)===Oe?(e=Oe,s+=5):(e=r,l===0&&n(Kt))),e}function Ma(){var e;return t.substr(s,6)===De?(e=De,s+=6):(e=r,l===0&&n(Ft)),e===r&&(t.substr(s,6)===Ue?(e=Ue,s+=6):(e=r,l===0&&n(xt))),e}function cg(){var e;return t.substr(s,10)===Ne?(e=Ne,s+=10):(e=r,l===0&&n(Rt)),e===r&&(t.substr(s,10)===de?(e=de,s+=10):(e=r,l===0&&n(Wt)),e===r&&(t.substr(s,10)===ye?(e=ye,s+=10):(e=r,l===0&&n(Ot)),e===r&&(t.substr(s,10)===ne?(e=ne,s+=10):(e=r,l===0&&n(Dt))))),e}function og(){var e;return t.substr(s,10)===Ke?(e=Ke,s+=10):(e=r,l===0&&n(Ut)),e===r&&(t.substr(s,10)===Pe?(e=Pe,s+=10):(e=r,l===0&&n(Pt)),e===r&&(t.substr(s,10)===Tr?(e=Tr,s+=10):(e=r,l===0&&n(jt)),e===r&&(t.substr(s,10)===Br?(e=Br,s+=10):(e=r,l===0&&n(It))))),e}function Ga(){var e;return t.substr(s,8)===Nr?(e=Nr,s+=8):(e=r,l===0&&n(Mt)),e===r&&(t.substr(s,8)===Kr?(e=Kr,s+=8):(e=r,l===0&&n(Gt)),e===r&&(t.substr(s,8)===Fr?(e=Fr,s+=8):(e=r,l===0&&n(Vt)),e===r&&(t.substr(s,8)===xr?(e=xr,s+=8):(e=r,l===0&&n(zt)),e===r&&(t.substr(s,8)===Rr?(e=Rr,s+=8):(e=r,l===0&&n(Qt)))))),e}function Va(){var e;return t.substr(s,8)===Wr?(e=Wr,s+=8):(e=r,l===0&&n(qt)),e===r&&(t.substr(s,8)===Or?(e=Or,s+=8):(e=r,l===0&&n(Lt)),e===r&&(t.substr(s,8)===Dr?(e=Dr,s+=8):(e=r,l===0&&n(Yt)),e===r&&(t.substr(s,8)===Ur?(e=Ur,s+=8):(e=r,l===0&&n(Zt)),e===r&&(t.substr(s,8)===Pr?(e=Pr,s+=8):(e=r,l===0&&n(Ht)))))),e}function za(){var e;return t.substr(s,9)===jr?(e=jr,s+=9):(e=r,l===0&&n(Jt)),e===r&&(t.substr(s,9)===Ir?(e=Ir,s+=9):(e=r,l===0&&n(Xt)),e===r&&(t.substr(s,9)===Mr?(e=Mr,s+=9):(e=r,l===0&&n(el)),e===r&&(t.substr(s,9)===Gr?(e=Gr,s+=9):(e=r,l===0&&n(rl)),e===r&&(t.substr(s,9)===Vr?(e=Vr,s+=9):(e=r,l===0&&n(sl)))))),e}function Qa(){var e;return t.substr(s,9)===zr?(e=zr,s+=9):(e=r,l===0&&n(fl)),e===r&&(t.substr(s,9)===Qr?(e=Qr,s+=9):(e=r,l===0&&n(al)),e===r&&(t.substr(s,9)===qr?(e=qr,s+=9):(e=r,l===0&&n(il)),e===r&&(t.substr(s,9)===Lr?(e=Lr,s+=9):(e=r,l===0&&n(tl)),e===r&&(t.substr(s,9)===Yr?(e=Yr,s+=9):(e=r,l===0&&n(ll)))))),e}function ug(){var e;return t.substr(s,7)===Zr?(e=Zr,s+=7):(e=r,l===0&&n(nl)),e===r&&(t.substr(s,7)===Hr?(e=Hr,s+=7):(e=r,l===0&&n(cl)),e===r&&(t.substr(s,7)===Jr?(e=Jr,s+=7):(e=r,l===0&&n(ol)),e===r&&(t.substr(s,7)===Xr?(e=Xr,s+=7):(e=r,l===0&&n(ul)),e===r&&(t.substr(s,7)===es?(e=es,s+=7):(e=r,l===0&&n(vl)),e===r&&(t.substr(s,7)===rs?(e=rs,s+=7):(e=r,l===0&&n(gl))))))),e}function vg(){var e;return t.substr(s,7)===ss?(e=ss,s+=7):(e=r,l===0&&n(pl)),e===r&&(t.substr(s,7)===fs?(e=fs,s+=7):(e=r,l===0&&n($l)),e===r&&(t.substr(s,7)===as?(e=as,s+=7):(e=r,l===0&&n(hl)),e===r&&(t.substr(s,7)===is?(e=is,s+=7):(e=r,l===0&&n(dl)),e===r&&(t.substr(s,7)===ts?(e=ts,s+=7):(e=r,l===0&&n(ml)),e===r&&(t.substr(s,7)===ls?(e=ls,s+=7):(e=r,l===0&&n(bl))))))),e}function gg(){var e;return t.substr(s,9)===ns?(e=ns,s+=9):(e=r,l===0&&n(Al)),e===r&&(t.substr(s,9)===cs?(e=cs,s+=9):(e=r,l===0&&n(Cl)),e===r&&(t.substr(s,9)===os?(e=os,s+=9):(e=r,l===0&&n(kl)),e===r&&(t.substr(s,9)===us?(e=us,s+=9):(e=r,l===0&&n(yl))))),e}function pg(){var e;return t.substr(s,9)===vs?(e=vs,s+=9):(e=r,l===0&&n(wl)),e===r&&(t.substr(s,9)===gs?(e=gs,s+=9):(e=r,l===0&&n(_l)),e===r&&(t.substr(s,9)===ps?(e=ps,s+=9):(e=r,l===0&&n(El)),e===r&&(t.substr(s,9)===$s?(e=$s,s+=9):(e=r,l===0&&n(Sl))))),e}function qa(){var e;return t.substr(s,9)===hs?(e=hs,s+=9):(e=r,l===0&&n(Tl)),e===r&&(t.substr(s,9)===ds?(e=ds,s+=9):(e=r,l===0&&n(Bl)),e===r&&(t.substr(s,9)===ms?(e=ms,s+=9):(e=r,l===0&&n(Nl)),e===r&&(t.substr(s,9)===bs?(e=bs,s+=9):(e=r,l===0&&n(Kl))))),e}function $g(){var e;return t.substr(s,12)===As?(e=As,s+=12):(e=r,l===0&&n(Fl)),e===r&&(t.substr(s,12)===Cs?(e=Cs,s+=12):(e=r,l===0&&n(xl)),e===r&&(t.substr(s,12)===ks?(e=ks,s+=12):(e=r,l===0&&n(Rl)),e===r&&(t.substr(s,12)===ys?(e=ys,s+=12):(e=r,l===0&&n(Wl))))),e}function hg(){var e;return t.substr(s,7)===ws?(e=ws,s+=7):(e=r,l===0&&n(Ol)),e===r&&(t.substr(s,7)===_s?(e=_s,s+=7):(e=r,l===0&&n(Dl))),e}function dg(){var e;return t.substr(s,5)===Es?(e=Es,s+=5):(e=r,l===0&&n(Ul)),e===r&&(t.substr(s,5)===Ss?(e=Ss,s+=5):(e=r,l===0&&n(Pl))),e}function La(){var e;return t.substr(s,5)===Ts?(e=Ts,s+=5):(e=r,l===0&&n(jl)),e===r&&(t.substr(s,5)===Bs?(e=Bs,s+=5):(e=r,l===0&&n(Il))),e}function mg(){var e;return t.substr(s,7)===Ns?(e=Ns,s+=7):(e=r,l===0&&n(Ml)),e===r&&(t.substr(s,7)===Ks?(e=Ks,s+=7):(e=r,l===0&&n(Gl))),e}function bg(){var e;return t.substr(s,9)===Fs?(e=Fs,s+=9):(e=r,l===0&&n(Vl)),e===r&&(t.substr(s,9)===xs?(e=xs,s+=9):(e=r,l===0&&n(zl))),e}function Ag(){var e;return t.substr(s,12)===Rs?(e=Rs,s+=12):(e=r,l===0&&n(Ql)),e===r&&(t.substr(s,12)===Ws?(e=Ws,s+=12):(e=r,l===0&&n(ql)),e===r&&(t.substr(s,12)===Os?(e=Os,s+=12):(e=r,l===0&&n(Ll)),e===r&&(t.substr(s,12)===Ds?(e=Ds,s+=12):(e=r,l===0&&n(Yl))))),e}function Cg(){var e;return t.substr(s,3)===Us?(e=Us,s+=3):(e=r,l===0&&n(Zl)),e===r&&(t.substr(s,3)===Ps?(e=Ps,s+=3):(e=r,l===0&&n(Hl)),e===r&&(t.substr(s,3)===js?(e=js,s+=3):(e=r,l===0&&n(Jl)))),e}function kg(){var e;return t.substr(s,3)===Is?(e=Is,s+=3):(e=r,l===0&&n(Xl)),e===r&&(t.substr(s,3)===Ms?(e=Ms,s+=3):(e=r,l===0&&n(en)),e===r&&(t.substr(s,3)===Gs?(e=Gs,s+=3):(e=r,l===0&&n(rn)))),e}function Ya(){var e;return t.substr(s,4)===Vs?(e=Vs,s+=4):(e=r,l===0&&n(sn)),e===r&&(t.substr(s,4)===zs?(e=zs,s+=4):(e=r,l===0&&n(fn))),e}function Za(){var e;return t.substr(s,7)===Qs?(e=Qs,s+=7):(e=r,l===0&&n(an)),e===r&&(t.substr(s,7)===qs?(e=qs,s+=7):(e=r,l===0&&n(tn)),e===r&&(t.substr(s,7)===Ls?(e=Ls,s+=7):(e=r,l===0&&n(ln)),e===r&&(t.substr(s,7)===Ys?(e=Ys,s+=7):(e=r,l===0&&n(nn)),e===r&&(t.substr(s,7)===Zs?(e=Zs,s+=7):(e=r,l===0&&n(cn)),e===r&&(t.substr(s,7)===Hs?(e=Hs,s+=7):(e=r,l===0&&n(on))))))),e}function Ha(){var e;return t.substr(s,7)===Js?(e=Js,s+=7):(e=r,l===0&&n(un)),e===r&&(t.substr(s,7)===Xs?(e=Xs,s+=7):(e=r,l===0&&n(vn)),e===r&&(t.substr(s,7)===ef?(e=ef,s+=7):(e=r,l===0&&n(gn)),e===r&&(t.substr(s,7)===rf?(e=rf,s+=7):(e=r,l===0&&n(pn)),e===r&&(t.substr(s,7)===sf?(e=sf,s+=7):(e=r,l===0&&n($n)),e===r&&(t.substr(s,7)===ff?(e=ff,s+=7):(e=r,l===0&&n(hn))))))),e}function Ja(){var e;return t.substr(s,11)===af?(e=af,s+=11):(e=r,l===0&&n(dn)),e===r&&(t.substr(s,11)===tf?(e=tf,s+=11):(e=r,l===0&&n(mn)),e===r&&(t.substr(s,11)===lf?(e=lf,s+=11):(e=r,l===0&&n(bn)),e===r&&(t.substr(s,11)===nf?(e=nf,s+=11):(e=r,l===0&&n(An))))),e}function yg(){var e;return t.substr(s,5)===cf?(e=cf,s+=5):(e=r,l===0&&n(Cn)),e===r&&(t.substr(s,5)===of?(e=of,s+=5):(e=r,l===0&&n(kn)),e===r&&(t.substr(s,5)===uf?(e=uf,s+=5):(e=r,l===0&&n(yn)),e===r&&(t.substr(s,5)===vf?(e=vf,s+=5):(e=r,l===0&&n(wn))))),e}function wg(){var e;return t.substr(s,3)===gf?(e=gf,s+=3):(e=r,l===0&&n(_n)),e===r&&(t.substr(s,3)===pf?(e=pf,s+=3):(e=r,l===0&&n(En)),e===r&&(t.substr(s,3)===$f?(e=$f,s+=3):(e=r,l===0&&n(Sn)))),e}function _g(){var e;return t.substr(s,11)===hf?(e=hf,s+=11):(e=r,l===0&&n(Tn)),e===r&&(t.substr(s,11)===df?(e=df,s+=11):(e=r,l===0&&n(Bn))),e}function Eg(){var e;return t.substr(s,9)===mf?(e=mf,s+=9):(e=r,l===0&&n(Nn)),e===r&&(t.substr(s,9)===bf?(e=bf,s+=9):(e=r,l===0&&n(Kn))),e}function Sg(){var e;return t.substr(s,4)===Af?(e=Af,s+=4):(e=r,l===0&&n(Fn)),e===r&&(t.substr(s,4)===Cf?(e=Cf,s+=4):(e=r,l===0&&n(xn))),e}function Xa(){var e;return t.substr(s,8)===kf?(e=kf,s+=8):(e=r,l===0&&n(Rn)),e===r&&(t.substr(s,8)===yf?(e=yf,s+=8):(e=r,l===0&&n(Wn)),e===r&&(t.substr(s,8)===wf?(e=wf,s+=8):(e=r,l===0&&n(On)),e===r&&(t.substr(s,8)===_f?(e=_f,s+=8):(e=r,l===0&&n(Dn))))),e}function Tg(){var e;return t.substr(s,7)===Ef?(e=Ef,s+=7):(e=r,l===0&&n(Un)),e===r&&(t.substr(s,7)===Sf?(e=Sf,s+=7):(e=r,l===0&&n(Pn))),e}function Bg(){var e;return t.substr(s,15)===Tf?(e=Tf,s+=15):(e=r,l===0&&n(jn)),e}function Ng(){var e;return t.substr(s,15)===Bf?(e=Bf,s+=15):(e=r,l===0&&n(In)),e}function Kg(){var e;return t.substr(s,11)===Nf?(e=Nf,s+=11):(e=r,l===0&&n(Mn)),e}function Fg(){var e;return t.substr(s,11)===Kf?(e=Kf,s+=11):(e=r,l===0&&n(Gn)),e}function xg(){var e;return t.substr(s,9)===Ff?(e=Ff,s+=9):(e=r,l===0&&n(Vn)),e}function Rg(){var e;return t.substr(s,9)===xf?(e=xf,s+=9):(e=r,l===0&&n(zn)),e}function ei(){var e;return t.substr(s,5)===Rf?(e=Rf,s+=5):(e=r,l===0&&n(Qn)),e}function ri(){var e;return t.substr(s,10)===Wf?(e=Wf,s+=10):(e=r,l===0&&n(qn)),e}function si(){var e;return t.substr(s,10)===Of?(e=Of,s+=10):(e=r,l===0&&n(Ln)),e}function p(){var e,f;for(l++,e=[],_e.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Ee));f!==r;)e.push(f),_e.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Ee));return l--,f=r,l===0&&n(ga),e}function Te(){var e,f;if(e=[],_e.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Ee)),f!==r)for(;f!==r;)e.push(f),_e.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Ee));else e=r;return e}function Wg(){var e,f;if(e=[],oa.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(pa)),f!==r)for(;f!==r;)e.push(f),oa.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(pa));else e=r;return e}function Ze(){var e,f,i;for(e=s,f=[],ua.test(t.charAt(s))?(i=t.charAt(s),s++):(i=r,l===0&&n($a));i!==r;)f.push(i),ua.test(t.charAt(s))?(i=t.charAt(s),s++):(i=r,l===0&&n($a));return u=e,f=eu(f),e=f,e}function I(){var e;return t.charCodeAt(s)===34?(e=je,s++):(e=r,l===0&&n(Ve)),e}function E(){var e,f,i,a,o;if(e=s,t.charCodeAt(s)===34?(f=je,s++):(f=r,l===0&&n(Ve)),f!==r){for(ai(),i=[],a=fi();a!==r;)i.push(a),a=fi();a=ai(),t.charCodeAt(s)===34?(o=je,s++):(o=r,l===0&&n(Ve)),o!==r?(u=e,e=ru(i)):(s=e,e=r)}else s=e,e=r;return e}function fi(){var e,f,i,a;return $t.test(t.charAt(s))?(e=t.charAt(s),s++):(e=r,l===0&&n(Yn)),e===r&&(e=s,f=Og(),f!==r?(i=s,t.charCodeAt(s)===92?(a=Df,s++):(a=r,l===0&&n(ha)),a!==r&&(u=i,a=su()),i=a,i===r&&(i=s,t.charCodeAt(s)===34?(a=je,s++):(a=r,l===0&&n(Ve)),a!==r&&(u=i,a=fu()),i=a),i!==r?(u=e,e=au(i)):(s=e,e=r)):(s=e,e=r)),e}function ai(){var e,f;for(l++,e=[],_e.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Ee));f!==r;)e.push(f),_e.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Ee));return l--,f=r,l===0&&n(ga),e}function Og(){var e;return t.charCodeAt(s)===92?(e=Df,s++):(e=r,l===0&&n(ha)),e}function vr(){var e,f,i,a,o,v,g,$,k;return e=s,f=I(),f!==r?(i=s,ce.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(oe)),a!==r?(ce.test(t.charAt(s))?(o=t.charAt(s),s++):(o=r,l===0&&n(oe)),o!==r?(ce.test(t.charAt(s))?(v=t.charAt(s),s++):(v=r,l===0&&n(oe)),v!==r?(ce.test(t.charAt(s))?(g=t.charAt(s),s++):(g=r,l===0&&n(oe)),g!==r?(a=[a,o,v,g],i=a):(s=i,i=r)):(s=i,i=r)):(s=i,i=r)):(s=i,i=r),i!==r?(t.charCodeAt(s)===46?(a=Ie,s++):(a=r,l===0&&n(ze)),a!==r?(o=s,ce.test(t.charAt(s))?(v=t.charAt(s),s++):(v=r,l===0&&n(oe)),v!==r?(ce.test(t.charAt(s))?(g=t.charAt(s),s++):(g=r,l===0&&n(oe)),g!==r?(v=[v,g],o=v):(s=o,o=r)):(s=o,o=r),o!==r?(t.charCodeAt(s)===46?(v=Ie,s++):(v=r,l===0&&n(ze)),v!==r?(g=s,ce.test(t.charAt(s))?($=t.charAt(s),s++):($=r,l===0&&n(oe)),$!==r?(ce.test(t.charAt(s))?(k=t.charAt(s),s++):(k=r,l===0&&n(oe)),k!==r?($=[$,k],g=$):(s=g,g=r)):(s=g,g=r),g!==r?($=I(),$!==r?(u=e,e=iu(i,o,g)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function ii(){var e,f,i,a,o,v,g,$,k;if(e=s,f=I(),f!==r){if(i=[],Y.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(Z)),a!==r)for(;a!==r;)i.push(a),Y.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(Z));else i=r;if(i!==r)if(t.charCodeAt(s)===58?(a=we,s++):(a=r,l===0&&n(Se)),a!==r){if(o=[],Y.test(t.charAt(s))?(v=t.charAt(s),s++):(v=r,l===0&&n(Z)),v!==r)for(;v!==r;)o.push(v),Y.test(t.charAt(s))?(v=t.charAt(s),s++):(v=r,l===0&&n(Z));else o=r;if(o!==r)if(t.charCodeAt(s)===58?(v=we,s++):(v=r,l===0&&n(Se)),v!==r){if(g=[],Y.test(t.charAt(s))?($=t.charAt(s),s++):($=r,l===0&&n(Z)),$!==r)for(;$!==r;)g.push($),Y.test(t.charAt(s))?($=t.charAt(s),s++):($=r,l===0&&n(Z));else g=r;g!==r?($=ti(),$===r&&($=null),k=I(),k!==r?(u=e,e=tu(i,o,g,$)):(s=e,e=r)):(s=e,e=r)}else s=e,e=r;else s=e,e=r}else s=e,e=r;else s=e,e=r}else s=e,e=r;return e}function ti(){var e,f,i,a;if(e=s,t.charCodeAt(s)===46?(f=Ie,s++):(f=r,l===0&&n(ze)),f!==r){if(i=[],Y.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(Z)),a!==r)for(;a!==r;)i.push(a),Y.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(Z));else i=r;i!==r?(u=e,e=lu(i)):(s=e,e=r)}else s=e,e=r;return e}function Dg(){var e,f,i,a;return e=s,f=I(),f!==r?(i=Ug(),i!==r?(a=I(),a!==r?(u=e,e=nu(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Ug(){var e,f,i,a;return e=s,f=Pg(),f!==r?(t.charCodeAt(s)===47?(i=er,s++):(i=r,l===0&&n(ar)),i!==r?(a=ni(),a!==r?(u=e,e=cu(f,a)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Pg(){var e;return t.charCodeAt(s)===66?(e=Uf,s++):(e=r,l===0&&n(da)),e===r&&(t.charCodeAt(s)===87?(e=Di,s++):(e=r,l===0&&n(Zn)),e===r&&(t.charCodeAt(s)===78?(e=Ui,s++):(e=r,l===0&&n(Hn)))),e}function li(){var e,f,i,a;return e=s,f=I(),f!==r?(i=ni(),i!==r?(a=I(),a!==r?(u=e,e=ou(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function ni(){var e,f;return e=s,f=pi(),f!==r&&(u=e,f=uu(f)),e=f,e}function jg(){var e,f,i,a;return e=s,f=I(),f!==r?(i=Ig(),a=I(),a!==r?(u=e,e=vu(i)):(s=e,e=r)):(s=e,e=r),e}function Ig(){var e,f,i,a,o,v,g;if(e=s,f=s,i=gr(),i!==r){for(a=[],o=s,t.charCodeAt(s)===58?(v=we,s++):(v=r,l===0&&n(Se)),v!==r?(g=gr(),g!==r?(u=o,o=Ta(i,g)):(s=o,o=r)):(s=o,o=r);o!==r;)a.push(o),o=s,t.charCodeAt(s)===58?(v=we,s++):(v=r,l===0&&n(Se)),v!==r?(g=gr(),g!==r?(u=o,o=Ta(i,g)):(s=o,o=r)):(s=o,o=r);u=f,f=gu(i,a)}else s=f,f=r;return f===r&&(f=null),u=e,f=pu(f),e=f,e}function gr(){var e,f,i,a,o,v;return e=s,t.charCodeAt(s)===63?(f=Pf,s++):(f=r,l===0&&n(ma)),f!==r&&(u=e,f=$u()),e=f,e===r&&(e=s,t.charCodeAt(s)===45?(f=rr,s++):(f=r,l===0&&n(ir)),f!==r&&(u=e,f=hu()),e=f,e===r&&(e=s,f=re(),f!==r?(t.charCodeAt(s)===47?(i=er,s++):(i=r,l===0&&n(ar)),i!==r?(a=re(),a!==r?(t.charCodeAt(s)===43?(o=sr,s++):(o=r,l===0&&n(tr)),o!==r?(v=re(),v!==r?(u=e,e=du(f,a,v)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=re(),f!==r?(t.charCodeAt(s)===47?(i=er,s++):(i=r,l===0&&n(ar)),i!==r?(a=re(),a!==r?(u=e,e=mu(f,a)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=re(),f!==r?(t.charCodeAt(s)===43?(i=sr,s++):(i=r,l===0&&n(tr)),i!==r?(a=re(),a!==r?(u=e,e=bu(f,a)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=re(),f!==r&&(u=e,f=Au(f)),e=f,e===r&&(e=s,t.charCodeAt(s)===42?(f=jf,s++):(f=r,l===0&&n(ba)),f!==r?(i=re(),i!==r?(u=e,e=Cu(i)):(s=e,e=r)):(s=e,e=r))))))),e}function Mg(){var e,f,i,a;return e=s,f=I(),f!==r?(i=ci(),i!==r?(a=I(),a!==r?(u=e,e=ku(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function ci(){var e,f;return e=s,t.substr(s,3)===If?(f=If,s+=3):(f=r,l===0&&n(Jn)),f!==r&&(u=e,f=yu(f)),e=f,e===r&&(e=s,t.substr(s,3)===Mf?(f=Mf,s+=3):(f=r,l===0&&n(Xn)),f!==r&&(u=e,f=wu(f)),e=f,e===r&&(e=s,t.substr(s,7)===Gf?(f=Gf,s+=7):(f=r,l===0&&n(ec)),f!==r&&(u=e,f=_u(f)),e=f,e===r&&(e=s,t.charCodeAt(s)===42?(f=jf,s++):(f=r,l===0&&n(ba)),f!==r&&(u=e,f=Eu(f)),e=f))),e}function oi(){var e,f,i,a;return e=s,f=Fe(),f!==r&&(u=e,f=Su(f)),e=f,e===r&&(e=s,f=I(),f!==r?(t.charCodeAt(s)===45?(i=rr,s++):(i=r,l===0&&n(ir)),i!==r?(a=I(),a!==r?(u=e,e=Tu()):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=I(),f!==r?(i=I(),i!==r?(u=e,e=Bu()):(s=e,e=r)):(s=e,e=r))),e}function Fe(){var e,f,i,a;if(e=s,f=I(),f!==r){if(i=[],Y.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(Z)),a!==r)for(;a!==r;)i.push(a),Y.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(Z));else i=r;i!==r?(a=I(),a!==r?(u=e,e=Nu(i)):(s=e,e=r)):(s=e,e=r)}else s=e,e=r;return e}function xe(){var e,f,i,a,o,v,g,$,k;return e=s,p(),f=pr(),f===r&&(f=null),p(),i=sp(),i===r&&(i=null),p(),a=fp(),a!==r?(p(),o=Ci(),o===r&&(o=null),v=Gg(),v===r&&(v=null),p(),g=pr(),g===r&&(g=null),p(),$=hi(),$===r&&($=null),k=xe(),k===r&&(k=null),u=e,e=Ku(f,i,a,o,v,g,$,k)):(s=e,e=r),e===r&&(e=s,p(),f=Vg(),f!==r?(p(),u=e,e=Fu(f)):(s=e,e=r)),e}function Gg(){var e,f,i,a;return e=s,f=di(),f!==r?(t.charCodeAt(s)===61?(i=Vf,s++):(i=r,l===0&&n(lr)),i!==r?(a=mi(),a!==r?(f=[f,i,a],e=f):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Vg(){var e,f;return e=s,f=ci(),f!==r&&(u=e,f=xu(f)),e=f,e}function pr(){var e,f,i,a,o;if(e=s,f=$r(),f!==r){for(i=[],a=s,p(),o=$r(),o!==r?(u=a,a=Ba(f,o)):(s=a,a=r);a!==r;)i.push(a),a=s,p(),o=$r(),o!==r?(u=a,a=Ba(f,o)):(s=a,a=r);u=e,e=Ru(f,i)}else s=e,e=r;return e}function $r(){var e,f,i,a;return e=s,f=Lg(),f!==r?(i=Q(),i!==r?(a=Yg(),a!==r?(u=e,e=Wu(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=zg(),f!==r&&(u=e,f=Ou(f)),e=f),e}function Q(){var e,f,i,a,o,v,g,$,k,R,y,d,U;if(e=s,f=p(),i=me(),i!==r)if(t.substr(s,4)===zf?(a=zf,s+=4):(a=r,l===0&&n(rc)),a!==r)if(o=Te(),o!==r)if(v=Qg(),v===r&&(v=null),g=p(),$=ue(),$!==r){for(k=p(),R=[],y=s,d=Q(),d!==r&&(u=y,d=Na(v,d)),y=d;y!==r;)R.push(y),y=s,d=Q(),d!==r&&(u=y,d=Na(v,d)),y=d;u=e,e=Du(v,R)}else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=p(),i=me(),i!==r)if(t.substr(s,4)===Qf?(a=Qf,s+=4):(a=r,l===0&&n(sc)),a!==r)if(o=Te(),o!==r)if(v=qg(),v===r&&(v=null),g=p(),$=ue(),$!==r){for(k=p(),R=[],y=s,d=Q(),d!==r&&(u=y,d=Ka(v,d)),y=d;y!==r;)R.push(y),y=s,d=Q(),d!==r&&(u=y,d=Ka(v,d)),y=d;u=e,e=Uu(v,R)}else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=p(),i=me(),i!==r)if(t.charCodeAt(s)===37?(a=fr,s++):(a=r,l===0&&n(nr)),a!==r)if(o=Hg(),o!==r)if(v=Te(),v!==r)if(g=pi(),g!==r)if($=p(),k=ue(),k!==r){for(R=p(),y=[],d=s,U=Q(),U!==r&&(u=d,U=Fa(o,g,U)),d=U;d!==r;)y.push(d),d=s,U=Q(),U!==r&&(u=d,U=Fa(o,g,U)),d=U;u=e,e=Pu(o,g,y)}else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=p(),i=me(),i!==r)if(t.charCodeAt(s)===37?(a=fr,s++):(a=r,l===0&&n(nr)),a!==r)if(o=Jg(),o!==r)if(v=Te(),v!==r)if(g=Xg(),g!==r)if($=p(),k=ue(),k!==r){for(R=p(),y=[],d=s,U=Q(),U!==r&&(u=d,U=xa(o,g,U)),d=U;d!==r;)y.push(d),d=s,U=Q(),U!==r&&(u=d,U=xa(o,g,U)),d=U;u=e,e=ju(o,g,y)}else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=p(),i=me(),i!==r)if(t.substr(s,5)===qf?(a=qf,s+=5):(a=r,l===0&&n(fc)),a!==r)if(o=Te(),o!==r)if(v=Ze(),g=p(),$=ue(),$!==r){for(k=p(),R=[],y=s,d=Q(),d!==r&&(u=y,d=Ra(v,d)),y=d;y!==r;)R.push(y),y=s,d=Q(),d!==r&&(u=y,d=Ra(v,d)),y=d;u=e,e=Iu(v,R)}else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=p(),i=me(),i!==r)if(t.charCodeAt(s)===37?(a=fr,s++):(a=r,l===0&&n(nr)),a!==r)if(o=Ze(),v=Te(),v!==r){if(g=[],$=vi(),$!==r)for(;$!==r;)g.push($),$=vi();else g=r;if(g!==r)if($=ue(),$!==r){for(k=p(),R=[],y=s,d=Q(),d!==r&&(u=y,d=Wa(o,g,d)),y=d;y!==r;)R.push(y),y=s,d=Q(),d!==r&&(u=y,d=Wa(o,g,d)),y=d;u=e,e=Mu(o,g,R)}else s=e,e=r;else s=e,e=r}else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=[],i=ui(),i!==r)for(;i!==r;)f.push(i),i=ui();else f=r;if(f!==r){for(i=[],a=s,o=p(),v=Q(),v!==r?(u=a,a=Oa(f,v)):(s=a,a=r);a!==r;)i.push(a),a=s,o=p(),v=Q(),v!==r?(u=a,a=Oa(f,v)):(s=a,a=r);u=e,e=Gu(f,i)}else s=e,e=r}}}}}}return e}function ui(){var e,f,i,a;return e=s,f=s,l++,t.substr(s,2)===Lf?(i=Lf,s+=2):(i=r,l===0&&n(ac)),l--,i===r?f=void 0:(s=f,f=r),f!==r?(i=s,l++,t.charCodeAt(s)===125?(a=Yf,s++):(a=r,l===0&&n(Aa)),l--,a===r?i=void 0:(s=i,i=r),i!==r?(t.length>s?(a=t.charAt(s),s++):(a=r,l===0&&n(Ca)),a!==r?(u=e,e=Vu(a)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function vi(){var e,f,i;return e=s,f=s,l++,i=ue(),l--,i===r?f=void 0:(s=f,f=r),f!==r?(t.length>s?(i=t.charAt(s),s++):(i=r,l===0&&n(Ca)),i!==r?(u=e,e=zu(i)):(s=e,e=r)):(s=e,e=r),e}function zg(){var e,f,i,a;if(e=s,f=Zg(),f!==r){for(i=[],va.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(ka));a!==r;)i.push(a),va.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(ka));a=Wg(),a!==r?(u=e,e=Qu(i)):(s=e,e=r)}else s=e,e=r;return e}function Qg(){var e,f,i,a,o,v,g;if(e=s,f=hr(),f!==r){for(p(),i=[],a=s,t.charCodeAt(s)===44?(o=Me,s++):(o=r,l===0&&n(Qe)),o!==r?(v=p(),g=hr(),g!==r?(o=[o,v,g],a=o):(s=a,a=r)):(s=a,a=r);a!==r;)i.push(a),a=s,t.charCodeAt(s)===44?(o=Me,s++):(o=r,l===0&&n(Qe)),o!==r?(v=p(),g=hr(),g!==r?(o=[o,v,g],a=o):(s=a,a=r)):(s=a,a=r);u=e,e=qu(f,i)}else s=e,e=r;return e}function hr(){var e,f,i;return e=s,f=gi(),f!==r?(i=mr(),i!==r?(u=e,e=Lu(f,i)):(s=e,e=r)):(s=e,e=r),e}function qg(){var e,f,i,a,o,v,g;if(e=s,f=dr(),f!==r){for(p(),i=[],a=s,t.charCodeAt(s)===44?(o=Me,s++):(o=r,l===0&&n(Qe)),o!==r?(v=p(),g=dr(),g!==r?(o=[o,v,g],a=o):(s=a,a=r)):(s=a,a=r);a!==r;)i.push(a),a=s,t.charCodeAt(s)===44?(o=Me,s++):(o=r,l===0&&n(Qe)),o!==r?(v=p(),g=dr(),g!==r?(o=[o,v,g],a=o):(s=a,a=r)):(s=a,a=r);u=e,e=Yu(f,i)}else s=e,e=r;return e}function dr(){var e,f,i,a;return e=s,f=gi(),f!==r?(i=mr(),i!==r?(a=mr(),a!==r?(u=e,e=Zu(f,i,a)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function gi(){var e,f;return e=s,t.charCodeAt(s)===89?(f=Pi,s++):(f=r,l===0&&n(ic)),f!==r&&(u=e,f=Hu()),e=f,e===r&&(e=s,t.charCodeAt(s)===71?(f=ji,s++):(f=r,l===0&&n(tc)),f!==r&&(u=e,f=Ju()),e=f,e===r&&(e=s,t.charCodeAt(s)===82?(f=Ii,s++):(f=r,l===0&&n(lc)),f!==r&&(u=e,f=Xu()),e=f,e===r&&(e=s,t.charCodeAt(s)===66?(f=Uf,s++):(f=r,l===0&&n(da)),f!==r&&(u=e,f=ev()),e=f))),e}function mr(){var e,f,i;return e=s,f=ge(),f!==r?(i=pe(),i!==r?(u=e,e=rv(f,i)):(s=e,e=r)):(s=e,e=r),e}function Lg(){var e;return t.charCodeAt(s)===123?(e=Mi,s++):(e=r,l===0&&n(nc)),e}function Yg(){var e;return t.charCodeAt(s)===125?(e=Yf,s++):(e=r,l===0&&n(Aa)),e}function me(){var e;return t.charCodeAt(s)===91?(e=Gi,s++):(e=r,l===0&&n(cc)),e}function ue(){var e;return t.charCodeAt(s)===93?(e=Vi,s++):(e=r,l===0&&n(oc)),e}function Zg(){var e;return t.charCodeAt(s)===59?(e=zi,s++):(e=r,l===0&&n(uc)),e}function Hg(){var e,f;return e=s,t.substr(s,3)===Zf?(f=Zf,s+=3):(f=r,l===0&&n(vc)),f!==r&&(u=e,f=sv()),e=f,e===r&&(e=s,t.substr(s,3)===Hf?(f=Hf,s+=3):(f=r,l===0&&n(gc)),f!==r&&(u=e,f=fv()),e=f,e===r&&(e=s,t.substr(s,3)===Jf?(f=Jf,s+=3):(f=r,l===0&&n(pc)),f!==r&&(u=e,f=av()),e=f)),e}function Jg(){var e,f;return e=s,t.substr(s,3)===Xf?(f=Xf,s+=3):(f=r,l===0&&n($c)),f!==r&&(u=e,f=iv()),e=f,e}function pi(){var e,f,i,a,o;return e=s,f=$i(),f===r&&(f=null),i=ve(),i!==r?(a=ve(),a===r&&(a=null),o=ti(),o===r&&(o=null),u=e,e=tv(f,i,a,o)):(s=e,e=r),e}function Xg(){var e,f,i,a;return e=s,f=$i(),f===r&&(f=null),i=ve(),i!==r?(a=ve(),a===r&&(a=null),u=e,e=lv(f,i,a)):(s=e,e=r),e}function $i(){var e,f,i;return e=s,f=ep(),f!==r?(i=rp(),i===r&&(i=null),u=e,e=nv(f,i)):(s=e,e=r),e}function ep(){var e,f,i,a;return e=s,f=ve(),f!==r?(i=ve(),i===r&&(i=null),t.charCodeAt(s)===58?(a=we,s++):(a=r,l===0&&n(Se)),a!==r?(u=e,e=cv(f,i)):(s=e,e=r)):(s=e,e=r),e}function rp(){var e,f,i,a;return e=s,f=ve(),f!==r?(i=ve(),i===r&&(i=null),t.charCodeAt(s)===58?(a=we,s++):(a=r,l===0&&n(Se)),a!==r?(u=e,e=ov(f,i)):(s=e,e=r)):(s=e,e=r),e}function ve(){var e,f;return e=s,Y.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Z)),f!==r&&(u=e,f=uv(f)),e=f,e}function hi(){var e,f,i,a,o;return e=s,f=di(),f!==r?(i=xe(),i!==r?(a=mi(),a!==r?(p(),o=hi(),o===r&&(o=null),u=e,e=vv(i,o)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function di(){var e;return t.charCodeAt(s)===40?(e=Qi,s++):(e=r,l===0&&n(hc)),e}function mi(){var e;return t.charCodeAt(s)===41?(e=qi,s++):(e=r,l===0&&n(dc)),e}function sp(){var e,f,i,a,o;if(e=s,f=re(),f!==r){for(i=[],a=Ai();a!==r;)i.push(a),a=Ai();for(a=[],o=bi();o!==r;)a.push(o),o=bi();u=e,e=gv(f)}else s=e,e=r;return e}function bi(){var e;return t.charCodeAt(s)===46?(e=Ie,s++):(e=r,l===0&&n(ze)),e}function re(){var e,f,i;if(l++,e=s,f=[],Y.test(t.charAt(s))?(i=t.charAt(s),s++):(i=r,l===0&&n(Z)),i!==r)for(;i!==r;)f.push(i),Y.test(t.charAt(s))?(i=t.charAt(s),s++):(i=r,l===0&&n(Z));else f=r;return f!==r&&(u=e,f=pv(f)),e=f,l--,e===r&&(f=r,l===0&&n(mc)),e}function Ai(){var e,f,i;if(e=s,f=[],t.charCodeAt(s)===32?(i=ea,s++):(i=r,l===0&&n(ya)),i!==r)for(;i!==r;)f.push(i),t.charCodeAt(s)===32?(i=ea,s++):(i=r,l===0&&n(ya));else f=r;return f!==r&&(u=e,f=$v()),e=f,e}function fp(){var e,f,i,a,o,v,g,$,k;return e=s,f=He(),f===r&&(f=null),i=s,l++,a=ip(),l--,a!==r?(s=i,i=void 0):i=r,i!==r?(a=ki(),a!==r?(o=Ar(),o===r&&(o=null),v=ge(),v!==r?(g=pe(),g!==r?($=br(),$===r&&($=null),k=Re(),k===r&&(k=null),p(),t.substr(s,4)===Li?s+=4:l===0&&n(bc),u=e,e=hv(f,a,o,v,g,$,k)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=He(),f===r&&(f=null),i=ge(),i!==r?(a=pe(),a!==r?(o=lp(),o===r&&(o=null),v=ge(),v!==r?(g=pe(),g!==r?($=br(),$===r&&($=null),k=Re(),k===r&&(k=null),u=e,e=dv(f,i,a,o,v,g,$,k)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=He(),f===r&&(f=null),i=Ar(),i===r&&(i=null),a=ge(),a!==r?(o=pe(),o!==r?(v=br(),v===r&&(v=null),g=Re(),g===r&&(g=null),u=e,e=mv(f,i,a,o,v,g)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,t.substr(s,5)===ra?(f=ra,s+=5):(f=r,l===0&&n(Ac)),f!==r?(i=Re(),i===r&&(i=null),u=e,e=bv(i)):(s=e,e=r),e===r&&(e=s,t.substr(s,3)===sa?(f=sa,s+=3):(f=r,l===0&&n(Cc)),f!==r?(i=Re(),i===r&&(i=null),u=e,e=Av(i)):(s=e,e=r),e===r&&(e=s,f=He(),f!==r?(t.charCodeAt(s)===64?(i=Yi,s++):(i=r,l===0&&n(kc)),i!==r?(a=ge(),a!==r?(o=pe(),o!==r?(u=e,e=Cv(f,a,o)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)))))),e}function Re(){var e,f,i,a;return e=s,f=s,i=s,l++,t.substr(s,2)===Ge?(a=Ge,s+=2):(a=r,l===0&&n(wa)),l--,a===r?i=void 0:(s=i,i=r),i!==r?(t.charCodeAt(s)===43?(a=sr,s++):(a=r,l===0&&n(tr)),a!==r?(i=[i,a],f=i):(s=f,f=r)):(s=f,f=r),f!==r&&(u=e,f=kv(f)),e=f,e===r&&(e=s,f=s,i=s,l++,t.substr(s,3)===fa?(a=fa,s+=3):(a=r,l===0&&n(yc)),l--,a===r?i=void 0:(s=i,i=r),i!==r?(t.charCodeAt(s)===35?(a=Zi,s++):(a=r,l===0&&n(wc)),a!==r?(i=[i,a],f=i):(s=f,f=r)):(s=f,f=r),f!==r&&(u=e,f=yv(f)),e=f),e}function br(){var e,f;return e=s,t.charCodeAt(s)===61?s++:l===0&&n(lr),f=tp(),f!==r?(u=e,e=wv(f)):(s=e,e=r),e}function Ci(){var e,f,i;return e=s,f=ap(),f!==r?(p(),i=Ci(),i===r&&(i=null),u=e,e=_v(f,i)):(s=e,e=r),e}function ap(){var e,f,i;return e=s,t.charCodeAt(s)===36?(f=Hi,s++):(f=r,l===0&&n(_c)),f!==r?(i=re(),i!==r?(u=e,e=Ev(i)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,t.substr(s,2)===aa?(f=aa,s+=2):(f=r,l===0&&n(Ec)),f!==r&&(u=e,f=Sv()),e=f,e===r&&(e=s,t.substr(s,2)===ia?(f=ia,s+=2):(f=r,l===0&&n(Sc)),f!==r&&(u=e,f=Tv()),e=f,e===r&&(e=s,t.substr(s,2)===ta?(f=ta,s+=2):(f=r,l===0&&n(Tc)),f!==r&&(u=e,f=Bv()),e=f,e===r&&(e=s,t.substr(s,2)===la?(f=la,s+=2):(f=r,l===0&&n(Bc)),f!==r&&(u=e,f=Nv()),e=f,e===r&&(e=s,t.charCodeAt(s)===33?(f=Ji,s++):(f=r,l===0&&n(Nc)),f!==r&&(u=e,f=Kv()),e=f,e===r&&(e=s,t.charCodeAt(s)===63?(f=Pf,s++):(f=r,l===0&&n(ma)),f!==r&&(u=e,f=Fv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8252?(f=Xi,s++):(f=r,l===0&&n(Kc)),f!==r&&(u=e,f=xv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8263?(f=et,s++):(f=r,l===0&&n(Fc)),f!==r&&(u=e,f=Rv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8265?(f=rt,s++):(f=r,l===0&&n(xc)),f!==r&&(u=e,f=Wv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8264?(f=st,s++):(f=r,l===0&&n(Rc)),f!==r&&(u=e,f=Ov()),e=f,e===r&&(e=s,t.charCodeAt(s)===9633?(f=ft,s++):(f=r,l===0&&n(Wc)),f!==r&&(u=e,f=Dv()),e=f,e===r&&(e=s,t.charCodeAt(s)===61?(f=Vf,s++):(f=r,l===0&&n(lr)),f!==r&&(u=e,f=Uv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8734?(f=at,s++):(f=r,l===0&&n(Oc)),f!==r&&(u=e,f=Pv()),e=f,e===r&&(e=s,t.charCodeAt(s)===10866?(f=it,s++):(f=r,l===0&&n(Dc)),f!==r&&(u=e,f=jv()),e=f,e===r&&(e=s,t.charCodeAt(s)===10865?(f=tt,s++):(f=r,l===0&&n(Uc)),f!==r&&(u=e,f=Iv()),e=f,e===r&&(e=s,t.charCodeAt(s)===177?(f=lt,s++):(f=r,l===0&&n(Pc)),f!==r&&(u=e,f=Mv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8723?(f=nt,s++):(f=r,l===0&&n(jc)),f!==r&&(u=e,f=Gv()),e=f,e===r&&(e=s,t.substr(s,2)===Ge?(f=Ge,s+=2):(f=r,l===0&&n(wa)),f!==r&&(u=e,f=Vv()),e=f,e===r&&(e=s,t.substr(s,2)===na?(f=na,s+=2):(f=r,l===0&&n(Ic)),f!==r&&(u=e,f=zv()),e=f,e===r&&(e=s,t.charCodeAt(s)===10752?(f=ct,s++):(f=r,l===0&&n(Mc)),f!==r&&(u=e,f=Qv()),e=f,e===r&&(e=s,t.charCodeAt(s)===10227?(f=ot,s++):(f=r,l===0&&n(Gc)),f!==r&&(u=e,f=qv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8594?(f=ut,s++):(f=r,l===0&&n(Vc)),f!==r&&(u=e,f=Lv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8593?(f=vt,s++):(f=r,l===0&&n(zc)),f!==r&&(u=e,f=Yv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8646?(f=gt,s++):(f=r,l===0&&n(Qc)),f!==r&&(u=e,f=Zv()),e=f,e===r&&(e=s,t.charCodeAt(s)===68?(f=pt,s++):(f=r,l===0&&n(qc)),f!==r&&(u=e,f=Hv()),e=f))))))))))))))))))))))))),e}function ki(){var e;return e=ge(),e===r&&(e=pe()),e}function ip(){var e,f,i,a,o;return e=s,f=ki(),f!==r?(i=Ar(),i===r&&(i=null),a=ge(),a!==r?(o=pe(),o!==r?(f=[f,i,a,o],e=f):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function He(){var e;return ht.test(t.charAt(s))?(e=t.charAt(s),s++):(e=r,l===0&&n(Lc)),e}function tp(){var e;return dt.test(t.charAt(s))?(e=t.charAt(s),s++):(e=r,l===0&&n(Yc)),e}function ge(){var e;return mt.test(t.charAt(s))?(e=t.charAt(s),s++):(e=r,l===0&&n(Zc)),e}function pe(){var e;return bt.test(t.charAt(s))?(e=t.charAt(s),s++):(e=r,l===0&&n(Hc)),e}function Ar(){var e;return t.charCodeAt(s)===120?(e=ca,s++):(e=r,l===0&&n(_a)),e}function lp(){var e;return t.charCodeAt(s)===120?(e=ca,s++):(e=r,l===0&&n(_a)),e===r&&(t.charCodeAt(s)===45?(e=rr,s++):(e=r,l===0&&n(ir))),e}var Je=[];function L(e){var f=Object.assign(e,Jv());return Je.push(f),f}function Cr(e){return parseInt(e.join(""),10)}function be(e){return e.join("").match(/\?/)?e.join(""):Cr(e)}function $e(e){var f={};return e.forEach(function(i){for(var a in i)Array.isArray(i[a])?f[a]=f[a]?f[a].concat(i[a]):i[a]:f[a]=f[a]?wi(f[a])+" "+yi(i[a]):i[a]}),f}function yi(e){if(typeof e!="string")return e;var f=/^\s+/;return e.replace(f,"")}function wi(e){if(typeof e!="string")return e;var f=/\s+$/;return e.replace(f,"")}if(Le=M(),Le!==r&&s===t.length)return Le;throw Le!==r&&s<t.length&&n(eg()),rg(cr,se<t.length?t.charAt(se):null,se<t.length?or(se,se+1):or(se,se))}return{SyntaxError:N,parse:F}})})(X);var q=_;function Ce(T,W){return!W||W.startRule==="games"?ae(T,W):he(T,W)}function he(T,W={startRule:"game"}){T=T.trim();let N=q.parse(T,W),P={moves:[],messages:[]};if(W.startRule==="pgn"){let F=N;P.moves=F}else if(W.startRule==="tags"){let F=N;P.tags=F}else P=N;return H(P,T,W)}function H(T,W,N){function P(t){if(N.startRule!=="tags"){let A=t.moves[t.moves.length-1];if(typeof A=="string"&&(t.moves.pop(),t.tags)){let r=t.tags.Result;r&&A!==r&&t.messages.push({key:"Result",value:r,message:"Result in tags is different to result in SAN"}),t.tags.Result=A}}return t}function F(t){function A(r){function O(j){return j.split(/\s+/)[1]}function K(j,S){function w(D){return D==="w"?"b":"w"}return j.turn=S,j.variations&&j.variations.forEach(function(D){let J=S;D.forEach(C=>J=K(C,J))}),w(S)}const M="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";let V=N.fen||r.tags&&r.tags.FEN||M,G=O(V);return r.moves.forEach(j=>G=K(j,G)),r}return t.moves?A(t):t}return F(P(T))}function ae(T,W={startRule:"games"}){function N(A){if(!Array.isArray(A))return[];if(A.length===0)return A;let r=A.pop();return(r.tags!==void 0||r.moves.length>0)&&A.push(r),A}function P(A,r,O={startRule:"games"}){return N(A)}const F=Object.assign({startRule:"games"},W);let t=q.parse(T,F);return t?(P(t,T,F),t.forEach(A=>{H(A,T,F)}),t):[]}const le=(T,W=`
`)=>T.replace(/\r?\n/g,W);function ke(T,W={startRule:"games"}){let N=le(T).split(`

`),P=[],F={tags:"",pgn:"",all:""};return N.forEach(function(t){if(t.startsWith("["))F.tags=t;else if(t){F.pgn=t;let A=F.tags?F.tags+`

`+F.pgn:F.pgn;F.all=A,P.push(F),F={tags:"",pgn:"",all:""}}}),P}b.parse=Ce,b.parseGame=he,b.parseGames=ae,b.split=ke,Object.defineProperty(b,"__esModule",{value:!0})})})(Sp,Xe);const Tp=(h,m)=>{let b={};return h.forEach(x=>{let _=m(x);_&&(b[x]=_)}),b},Fi=["a","b","c","d","e","f","g","h"],Bp=["1","2","3","4","5","6","7","8"],Np=["q","n","r","b"],xi=Fi.flatMap(h=>Bp.map(m=>`${h}${m}`)),Kp=h=>[h.slice(0,2),h.slice(2)],Fp=h=>h.split("="),Ri=35,Wi=String.fromCharCode(33),xp=h=>xi.indexOf(h)+1,Oi=Tp(xi,h=>String.fromCharCode(xp(h)+Ri)),Sr=h=>Oi[h]||Wi,Rp=(()=>{let h={};return Np.map((m,b)=>{Fi.map((x,_)=>{let X=m+x,q=String.fromCharCode(Ri+Object.keys(Oi).length+b*8+_-1);h[X]=q})}),h})(),Wp=(h,m)=>Rp[m+h]||Wi,Op=h=>{let[m,b]=Fp(h),[x,_]=Kp(m);return b?Sr(x)+Wp(_[0],b):Sr(x)+Sr(_)};function Dp(h){return Xe.parse(h,{startRule:"games"}).map(Up)}function Up(h){var q,Ce,he;let m=((q=h.tags)==null?void 0:q.Event)||"",b=(Ce=h.tags)==null?void 0:Ce.FEN,x=(he=h.tags)==null?void 0:he.Site,_=[];function X(H,ae,le,ke=!1){le.forEach((T,W)=>{let N=W===0&&ke,P=W===le.length-1&&T.variations.length===0,F=T.notation.notation,t=ae.fen(),A=ae.move(F).lan,r=Op(A),O=T.variations.map(G=>{let S=G[0].notation.notation;return new _r(t).move(S).lan}),M=[A,...O],V={path:H,fen:t,moves:M};P&&(V.final=!0),!N&&M.length>0&&_.push(V),T.variations.forEach(G=>{let j=new _r(t);X(H,j,G,!0)}),H=H+r})}return X("",new _r(b||Ip),h.moves),{title:m,fen:b,site:x,poss:_}}class Pp{constructor(m){kr(this,"by_fen");this.pgn=m,this.by_fen=new Map,m.poss.forEach(b=>{this.by_fen.set(b.fen,b)})}get title(){return this.pgn.title}pick_move(m){let b=this.by_fen.get(m);if(b)return jp(b.moves)}score(m){const b=this.by_fen.get(m);if(b)return{max_ply:this.pgn.poss.filter(_=>_.final).map(_=>_.path).filter(_=>_.includes(b.path)).map(_=>_.length).sort((_,X)=>_-X)[0]/2,ply:b.path.length/2}}}function jp(h){let m=h.length*(h.length+1)/2,b=Math.floor(Math.random()*m)+1,x=0;for(let _=0;_<h.length;_++)if(x+=h.length-_,b<=x)return h[_];return 0}const Ip="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class Mp{constructor(){kr(this,"_completed");this._completed=this._prop("completed",[])}_key(m){return["aidchess","dem_solves",m].join(".")}_prop(m,b){return kp(this._key(m),()=>b)}clear(){this._completed([])}complete(m){let b=this.completeds;b=b.filter(x=>x.title!==m.title),b.push(m),this._completed(b)}get completeds(){return this._completed()}}const Ti=new Mp;class Gp{complete(m){Ti.complete({title:m})}is_complete(m){return!!Ti.completeds.find(b=>b.title===m)}}const Bi=new Gp,Ni=te('<div class="show"><a class="button" target="_blank">View Solution on Lichess</a></div>'),Vp=te("<span>Loading puzzles please wait..</span>"),zp=te("<span>Puzzle complete!</span>"),Qp=te("<div><a>Next puzzle</a></div>"),qp=te("<span>Failed.</span>"),Lp=te("<div><a>Try again</a></div>"),Yp=te('<div class="dem"><div class="board-replay"><div class="board"></div><div class="replay"></div><div class="feedback"></div></div><div class="side"><div class="chapters"></div></div></div>'),Zp=te("<span>Completed</span>"),Hp=te("<div><span></span><h3></h3></div>"),Jp=h=>h?"active":"";function t$(){let[h,m]=Be("loading"),[b]=op(wp[0],_p),x=fe(()=>{let C=b();return C?Dp(C.pgn):[]}),[_,X]=Be(0),q=fe(()=>{let C=_(),B=x();if(B)return B[C]});const[Ce,he]=Be(void 0,{equals:!1}),[H,ae]=Be(""),[le,ke]=Be(Si.make(),{equals:!1}),T=fe(()=>le().moves()),W=fe(()=>le().chess(H())),N=fe(()=>le().fen(H()));fe(()=>W().pgn());const P={w:"White",b:"Black"},[F,t]=Be("w"),A=fe(()=>P[F()]),r=()=>{const C=q();m("solving"),hp(()=>{ke(Si.make(C.fen)),ae(""),t(Ki(C.fen))})};yr(_i(q,C=>{C&&r()})),yr(()=>{let C=q(),B=h();C&&B==="solved"&&(Bi.complete(C.title),he())});const O=fe(()=>{const C=q();if(C)return new Pp(C)}),K=fe(()=>{const C=O();if(C)return C.by_fen.get(N())});yr(_i(N,C=>{const B=O();if(!B)return;if(B.by_fen.size===0&&m("solved"),Ki(C)!==F()){const ie=B.pick_move(N());ie?V(ie):m("solved")}}));const M=C=>{const B=K();if(B&&(V(C),!B.moves.includes(C))){m("failed");return}},V=C=>{let B;ke(z=>(B=z.add_move(H(),C),z)),B&&ae(B)};let G=mp.make;const J={loading:()=>Vp.cloneNode(!0),solving:()=>[fe(A),"'s turn, find the solution.",(()=>{const C=Ni.cloneNode(!0),B=C.firstChild;return wr(()=>{var z;return Ei(B,"href",(z=q())==null?void 0:z.site)}),C})()],solved:()=>[zp.cloneNode(!0),(()=>{const C=Qp.cloneNode(!0),B=C.firstChild;return B.$$click=()=>X(_()+1),C})()],failed:()=>[qp.cloneNode(!0),(()=>{const C=Lp.cloneNode(!0),B=C.firstChild;return B.$$click=()=>r(),C})(),(()=>{const C=Ni.cloneNode(!0),B=C.firstChild;return wr(()=>{var z;return Ei(B,"href",(z=q())==null?void 0:z.site)}),C})()]};return(()=>{const C=Yp.cloneNode(!0),B=C.firstChild,z=B.firstChild,ie=z.nextSibling,Oe=ie.nextSibling,De=B.nextSibling,Ue=De.firstChild;Ae(z,We(Cp,{glyphs:[],get fen(){return N()},isBlack:!1,onUserMove:M}));const Ne=bp(G);return typeof Ne=="function"&&up(Ne,ie),Ae(ie,We(Ap,{get moves(){return T()},get on_path(){return H()},on_click:de=>ae(de)})),Ae(Oe,We(vp,{get component(){return J[h()]}})),Ae(Ue,We($p,{get each(){return x()},children:(de,ye)=>(()=>{const ne=Hp.cloneNode(!0),Ke=ne.firstChild,Pe=Ke.nextSibling;return ne.$$click=()=>X(ye()),Ae(Ke,()=>ye()+1),Ae(Pe,()=>de.title),Ae(ne,We(gp,{get when(){return Ce()||Bi.is_complete(de.title)},get children(){return Zp.cloneNode(!0)}}),null),wr(()=>pp(ne,Jp(ye()===_()))),ne})()})),C})()}const Ki=h=>h.split(" ")[1];dp(["click"]);export{t$ as default};
