var Re=Object.defineProperty;var Ve=(e,t,s)=>t in e?Re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var q=(e,t,s)=>(Ve(e,typeof t!="symbol"?t+"":t,s),s);import{a as S,b as k,h as Y,o as He,k as Je,s as B,c as v,m as J,F as Ne,S as oe,d as W,l as Qe,T as Ze,i as U,t as le,j as K,e as ce,f as Ie}from"./index-ce885dbc.js";import{C as Ke,G as Le}from"./ctrl-7eba919a.js";import{N as et,F as tt,R as $e,a as ue,i as de}from"./store-dbbc54ee.js";var st=Object.defineProperty,rt=(e,t,s)=>t in e?st(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,m=(e,t,s)=>(rt(e,typeof t!="symbol"?t+"":t,s),s);const P=e=>e[0](),X=(e,t)=>typeof t=="function"?e[1](t):e[1](s=>t),$=class{constructor(e,t){m(this,"x"),m(this,"y"),this.x=e,this.y=t}static get unit(){return new $(1,1)}static get zero(){return new $(0,0)}get vs(){return[this.x,this.y]}get mul_inverse(){return new $(1/this.x,1/this.y)}get inverse(){return new $(-this.x,-this.y)}get half(){return new $(this.x/2,this.y/2)}get length_squared(){return this.x*this.x+this.y*this.y}get length(){return Math.sqrt(this.length_squared)}get normalize(){return this.length===0?$.zero:this.scale(1/this.length)}get perpendicular(){return new $(-this.y,this.x)}get clone(){return new $(this.x,this.y)}get angle(){return Math.atan2(this.y,this.x)}get round(){return $.make(Math.round(this.x),Math.round(this.y))}get floor(){return $.make(Math.floor(this.x),Math.floor(this.y))}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}project_to(e){let t=e.length_squared,s=this.dot(e);return $.make(s*e.x/t,s*e.y/t)}distance(e){return this.sub(e).length}addy(e){return $.make(this.x,this.y+e)}add_angle(e){return $.from_angle(this.angle+e)}scale(e){let{clone:t}=this;return t.scale_in(e)}scale_in(e){return this.x*=e,this.y*=e,this}add(e){let{clone:t}=this;return t.add_in(e)}add_in(e){return this.x+=e.x,this.y+=e.y,this}sub(e){let{clone:t}=this;return t.sub_in(e)}sub_in(e){return this.x-=e.x,this.y-=e.y,this}mul(e){let{clone:t}=this;return t.mul_in(e)}mul_in(e){return this.x*=e.x,this.y*=e.y,this}div(e){let{clone:t}=this;return t.div_in(e)}div_in(e){return this.x/=e.x,this.y/=e.y,this}set_in(e,t=this.y){return this.x=e,this.y=t,this}};let b=$;m(b,"from_angle",e=>new $(Math.cos(e),Math.sin(e))),m(b,"make",(e,t)=>new $(e,t));const F=class{constructor(e,t,s,r,n,i){m(this,"array_t"),m(this,"a"),m(this,"b"),m(this,"c"),m(this,"d"),m(this,"tx"),m(this,"ty"),this.a=e,this.b=t,this.c=s,this.d=r,this.tx=n,this.ty=i,this.array_t=new Float32Array([e,t,0,s,r,0,n,i,1])}static get identity(){return new F(1,0,0,1,0,0)}static get unit(){return F.identity}get clone(){let{a:e,b:t,c:s,d:r,tx:n,ty:i}=this;return new F(e,t,s,r,n,i)}get inverse(){let{a:e,b:t,c:s,d:r,tx:n,ty:i}=this,l=e*r-t*s,o=r/l,h=-t/l,u=-s/l,a=e/l,p=(s*i-r*n)/l,w=-(e*i-t*n)/l;return new F(o,h,u,a,p,w)}rotate_in(e){let t=Math.cos(e),s=Math.sin(e),r=this.a*t-this.b*s,n=this.a*s+this.b*t,i=this.c*t-this.d*s,l=this.c*s+this.d*t,o=this.tx*t-this.ty*s,h=this.tx*s+this.ty*t;return this.a=r,this.b=n,this.c=i,this.d=l,this.tx=o,this.ty=h,this}rotate(e){let{clone:t}=this;return t.rotate_in(e),t}scale(e,t){let s=this.a*e,r=this.b,n=this.c,i=this.d*t,l=this.tx,o=this.ty;return new F(s,r,n,i,l,o)}translate_in(e,t){this.a,this.b,this.c,this.d;let s=e+this.tx,r=t+this.ty;return this.tx=s,this.ty=r,this}translate(e,t){let{clone:s}=this;return s.translate_in(e,t),s}scale_in(e,t){return this.a=e,this.d=t,this}mVec2(e){let t=this.a,s=this.b,r=this.c,n=this.d,i=this.tx,l=this.ty,o=t*e.x+r*e.y+i,h=s*e.x+n*e.y+l;return b.make(o,h)}mul_in(e){let{a:t,b:s,c:r,d:n,tx:i,ty:l}=this;this.a=e.a*t+e.b*r,this.b=e.a*s+e.b*n,this.c=e.c*t+e.d*r,this.d=e.c*s+e.d*n,this.tx=e.tx*t+e.ty*r+i,this.ty=e.tx*s+e.ty*n+l}set_in(e){let{a:t,b:s,c:r,d:n,tx:i,ty:l}=e;this.a=t,this.b=s,this.c=r,this.d=n,this.tx=i,this.ty=l}transform_in(e,t,s,r=b.unit.half){this.a=Math.cos(t)*e.x,this.b=Math.sin(t)*e.x,this.c=-Math.sin(t)*e.y,this.d=Math.cos(t)*e.y,this.tx=s.x-(r.x*this.a+r.y*this.c),this.ty=s.y-(r.x*this.b+r.y*this.d)}};let nt=F;m(nt,"projection",(e,t)=>{let s=0,r=0,n=1/e*2,i=-1/t*2,l=-1,o=1;return new F(n,s,r,i,l,o)});const ee=class{constructor(e,t){m(this,"o"),m(this,"r"),this.o=e,this.r=t}static get unit(){return ee.make(0,0,1)}scale(e){return ee.make(this.o.x,this.o.y,this.r*e)}copy_in(e){return this.r=e.r,this.o=e.o,this}add_o_in(e){return this.o.add_in(e),this}};let it=ee;m(it,"make",(e,t,s)=>new ee(b.make(e,t),s));const Ae=class{constructor(t,s){this.a=t,this.b=s}get center(){return this.b.add(this.a).half}get parallel(){return this.b.sub(this.a).normalize}get normal(){return this.parallel.perpendicular}get angle(){return this.b.sub(this.a).angle}get radius(){return this.length/2}get length(){return this.b.sub(this.a).length}segments(t,s){return t.map((r,n)=>this.a.add(this.normal.scale(s[n]).add(this.parallel.scale(this.length*r))))}};let ot=Ae;m(ot,"make",(e,t,s,r)=>new Ae(b.make(e,t),b.make(s,r)));const R=class{constructor(e){this.vertices=e}static get unit(){return R.make(0,0,1,1)}get vs(){let{x:e,y:t,w:s,h:r}=this;return[e,t,s,r]}get x1(){return this.vertices[0].x}get y1(){return this.vertices[0].y}get x2(){return this.vertices[2].x}get y2(){return this.vertices[2].y}get x(){return this.x1}get y(){return this.y1}get w(){return this.x2-this.x1}get h(){return this.y2-this.y1}get center(){return b.make(this.x+this.w/2,this.y+this.h/2)}get vertexData(){return new Float32Array(this.vertices.flatMap(e=>e.vs))}get indices(){return new Uint16Array([0,1,2,0,2,3])}larger(e){return R.make(this.x-e,this.y-e,this.w+e,this.h+e)}transform(e){return new R(this.vertices.map(t=>e.mVec2(t)))}};let lt=R;m(lt,"make",(e,t,s,r)=>new R([b.make(e,t),b.make(e+s,t),b.make(e+s,t+r),b.make(e,t+r)]));let te=class Te{constructor(){m(this,"m_rect"),m(this,"_$ref"),m(this,"_$clear_bounds"),this._$clear_bounds=S(void 0,{equals:!1}),this._$ref=S(),this.m_rect=k(()=>{var t;return P(this._$clear_bounds),(t=this.$ref)==null?void 0:t.getBoundingClientRect()})}static get make(){return new Te}get $ref(){return P(this._$ref)}set $ref(t){X(this._$ref,t)}get_normal_at_abs_pos(t){let{size:s,orig:r}=this;if(s&&r)return t.sub(r).div(s)}get size(){let{rect:t}=this;if(t)return b.make(t.width,t.height)}get orig(){let{rect:t}=this;if(t)return b.make(t.x,t.y)}get rect(){return this.m_rect()}$clear_bounds(){X(this._$clear_bounds,void 0)}};function at(e){var t;return e.clientX!==void 0&&e.clientY!==void 0?[e.clientX,e.clientY]:(t=e.targetTouches)!=null&&t[0]?[e.targetTouches[0].clientX,e.targetTouches[0].clientY]:[0,0]}class qe{}m(qe,"init",(e,t=document)=>{const s=f=>{let C=at(f);return C?b.make(C[0],C[1]):b.zero};let{_onDragStart:r,_onDragMove:n,_onDragEnd:i,_onContextMenu:l,_onWheel:o}=e;const h=f=>{r==null||r(s(f),f.buttons===2||f.button===2)},u=f=>{n==null||n(s(f))},a=f=>{i==null||i(s(f))},p=f=>{l&&(f.preventDefault(),l())},w=f=>{o&&(o(Math.sign(f.deltaY)),f.preventDefault())};return t.addEventListener("wheel",w,{passive:!1}),t.addEventListener("touchstart",h,{capture:!0,passive:!1}),t.addEventListener("mousedown",h,{capture:!0,passive:!1}),t.addEventListener("contextmenu",p),document.addEventListener("mousemove",u),document.addEventListener("mouseup",a),document.addEventListener("touchmove",u),document.addEventListener("touchend",a),()=>{t.removeEventListener("wheel",w),t.removeEventListener("touchstart",h),t.removeEventListener("mousedown",h),t.removeEventListener("contextmenu",p),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",a),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",a)}});const se=(e,t)=>{Y(He(()=>t.$ref,s=>{s&&Je(ht(e,s))}))},ht=(e,t)=>{let{on_wheel:s}=e;return qe.init({_onWheel(r){s(r)}},t)},re=e=>t=>setTimeout(()=>e.$ref=t),Be="abcdefgh".split(""),fe="87654321".split("");fe.slice(0).reverse();const ct="wb".split(""),ut="rkqbnp".split("");ct.flatMap(e=>ut.map(t=>`${e}${t}`));const me=Be.flatMap(e=>fe.map(t=>`${e}${t}`)),dt=new Map(me.map(e=>{let[t,s]=e.split(""),r=Be.indexOf(t),n=fe.indexOf(s);return[e,b.make(r,n)]})),De=e=>{let t=dt.get(e);return(t.x+t.y)%2===0},_t=e=>!De(e);me.filter(De);me.filter(_t);const je=class{constructor(t){m(this,"released_positions"),this.free=t,this.released_positions=new Map}acquire_pos(t,s,r=!1){let n=this.released_positions.get(t);if(!r&&n&&n.length>0)return n.sort((i,l)=>l.distance(s)-i.distance(s)),n.pop();{let i=this.free.pop();return i.x=s.x,i.y=s.y,i}}reset_fix_all(){for(let t of this.released_positions.values())t.forEach(s=>this.free.push(s));this.released_positions=new Map}release_pos(t,s){let r=this.released_positions.get(t);r||(r=[],this.released_positions.set(t,r)),r.push(s)}};let ft=je;m(ft,"make",e=>new je(e));var mt=Object.defineProperty,pt=(e,t,s)=>t in e?mt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,M=(e,t,s)=>(pt(e,typeof t!="symbol"?t+"":t,s),s);function vt(e,t,s){let r=s.length,n=t.length,i=r,l=0,o=0,h=t[n-1].nextSibling,u=null;for(;l<n||o<i;){if(t[l]===s[o]){l++,o++;continue}for(;t[n-1]===s[i-1];)n--,i--;if(n===l){const a=i<r?o?s[o-1].nextSibling:s[i-o]:h;for(;o<i;)e.insertBefore(s[o++],a)}else if(i===o)for(;l<n;)(!u||!u.has(t[l]))&&t[l].remove(),l++;else if(t[l]===s[i-1]&&s[o]===t[n-1]){const a=t[--n].nextSibling;e.insertBefore(s[o++],t[l++].nextSibling),e.insertBefore(s[--i],a),t[n]=s[i]}else{if(!u){u=new Map;let p=o;for(;p<i;)u.set(s[p],p++)}const a=u.get(t[l]);if(a!=null)if(o<a&&a<i){let p=l,w=1,f;for(;++p<n&&p<i&&!((f=u.get(t[p]))==null||f!==a+w);)w++;if(w>a-o){const C=t[l];for(;o<a;)e.insertBefore(s[o++],C)}else e.replaceChild(s[o++],t[l++])}else l++;else t[l++].remove()}}}const ke="_$DX_DELEGATE";function V(e,t,s){const r=document.createElement("template");r.innerHTML=e;let n=r.content.firstChild;return s&&(n=n.firstChild),n}function gt(e,t=window.document){const s=t[ke]||(t[ke]=new Set);for(let r=0,n=e.length;r<n;r++){const i=e[r];s.has(i)||(s.add(i),t.addEventListener(i,yt))}}function we(e,t){t==null?e.removeAttribute("class"):e.className=t}function L(e,t,s,r){if(s!==void 0&&!r&&(r=[]),typeof t!="function")return ne(e,t,r,s);W(n=>ne(e,t(),n,s),r)}function yt(e){const t=`$$${e.type}`;let s=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==s&&Object.defineProperty(e,"target",{configurable:!0,value:s}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return s||document}}),B.registry&&!B.done&&(B.done=!0,document.querySelectorAll("[id^=pl-]").forEach(r=>r.remove()));s!==null;){const r=s[t];if(r&&!s.disabled){const n=s[`${t}Data`];if(n!==void 0?r.call(s,n,e):r.call(s,e),e.cancelBubble)return}s=s.host&&s.host!==s&&s.host instanceof Node?s.host:s.parentNode}}function ne(e,t,s,r,n){for(B.context&&!s&&(s=[...e.childNodes]);typeof s=="function";)s=s();if(t===s)return s;const i=typeof t,l=r!==void 0;if(e=l&&s[0]&&s[0].parentNode||e,i==="string"||i==="number"){if(B.context)return s;if(i==="number"&&(t=t.toString()),l){let o=s[0];o&&o.nodeType===3?o.data=t:o=document.createTextNode(t),s=z(e,s,r,o)}else s!==""&&typeof s=="string"?s=e.firstChild.data=t:s=e.textContent=t}else if(t==null||i==="boolean"){if(B.context)return s;s=z(e,s,r)}else{if(i==="function")return W(()=>{let o=t();for(;typeof o=="function";)o=o();s=ne(e,o,s,r)}),()=>s;if(Array.isArray(t)){const o=[],h=s&&Array.isArray(s);if(_e(o,t,s,n))return W(()=>s=ne(e,o,s,r,!0)),()=>s;if(B.context){if(!o.length)return s;for(let u=0;u<o.length;u++)if(o[u].parentNode)return s=o}if(o.length===0){if(s=z(e,s,r),l)return s}else h?s.length===0?Ce(e,o,r):vt(e,s,o):(s&&z(e),Ce(e,o));s=o}else if(t instanceof Node){if(B.context&&t.parentNode)return s=l?[t]:t;if(Array.isArray(s)){if(l)return s=z(e,s,r,t);z(e,s,null,t)}else s==null||s===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);s=t}}return s}function _e(e,t,s,r){let n=!1;for(let i=0,l=t.length;i<l;i++){let o=t[i],h=s&&s[i];if(o instanceof Node)e.push(o);else if(!(o==null||o===!0||o===!1))if(Array.isArray(o))n=_e(e,o,h)||n;else if(typeof o=="function")if(r){for(;typeof o=="function";)o=o();n=_e(e,Array.isArray(o)?o:[o],Array.isArray(h)?h:[h])||n}else e.push(o),n=!0;else{const u=String(o);h&&h.nodeType===3&&h.data===u?e.push(h):e.push(document.createTextNode(u))}}return n}function Ce(e,t,s){for(let r=0,n=t.length;r<n;r++)e.insertBefore(t[r],s)}function z(e,t,s,r){if(s===void 0)return e.textContent="";const n=r||document.createTextNode("");if(t.length){let i=!1;for(let l=t.length-1;l>=0;l--){const o=t[l];if(n!==o){const h=o.parentNode===e;!i&&!l?h?e.replaceChild(n,o):e.insertBefore(n,s):h&&o.remove()}else i=!0}}else e.insertBefore(n,s);return[n]}class xt{constructor(){M(this,"a_moves"),this.a_moves=Oe.make(this)}get tree(){return this.a_moves.tree}set moves(t){this.a_moves.moves=t}set on_path(t){this.a_moves.on_path=t}}const Fe=class{constructor(e){M(this,"m_tree"),M(this,"_moves"),M(this,"_hover_path"),M(this,"_on_path"),this.replay=e;let t=S(void 0,{equals:!1});this._hover_path=t;let s=S(void 0,{equals:!1});this._on_path=s;let r=S([]);this._moves=r;let n=k(Qe(r[0],ze.make));function i(o){return k(()=>{let h=n().filter(a=>a.base===o),u=h.length>1;return h.map(a=>{let p=i(a.path)(),w;p.length>0&&(w=[p[0],p.slice(1)]);let f=a.ply%2===0,C=Math.ceil(a.ply/2)+(f?"...":"."),D=u||!f,T=k(()=>P(s)===a.path),d=k(()=>{var g;return((g=P(s))==null?void 0:g.slice(0,a.path.length))===a.path}),c=k(()=>P(t)===a.path),_=k(()=>{var g;return((g=P(t))==null?void 0:g.slice(0,a.path.length))===a.path}),x=k(()=>["move",T()?"on_hi":"",d()?"on_hi_sub":"",c()?"hi":"",_()?"hi_sub":""].join(" "));return{get klass(){return x()},a_move:a,index:C,show_index:D,main_children_and_rest:w}})})}let l=i("");this.m_tree=l}set on_path(e){X(this._on_path,e)}set hover_path(e){X(this._hover_path,t=>e)}get tree(){return this.m_tree()}set moves(e){X(this._moves,e)}};let Oe=Fe;M(Oe,"make",e=>new Fe(e));const Ge=class{constructor(e){M(this,"ply"),M(this,"path"),M(this,"base"),M(this,"move"),M(this,"comments"),M(this,"klass");let t=e.match(/([^ ]*) ([^ ]*) \{([^\}]*)\}/),s,r,n,i;if(t){r=t[1],n=t[2];let[h,u,a]=t[3].match(/^(__[^\_]*__)?(.*)$/);s=a,i=(u==null?void 0:u.substring(2,u.length-2))||""}else[r,n]=e.split(" "),i="";let l=r.length===2?"":r.slice(0,-2),o=r.length/2;this.path=r,this.ply=o,this.base=l,this.move=n,this.comments=s,this.klass=i}};let ze=Ge;M(ze,"make",e=>new Ge(e));const bt=V('<div class="chessreplay"><div class="moves"></div></div>'),$t=V('<div class="lines"><div class="line"></div></div>'),kt=V('<div class="line"></div>'),wt=V('<div class="index"></div>'),Ee=V("<div></div>");function Pe(e){let t=new xt;Y(()=>{t.moves=e.moves}),Y(()=>{t.on_path=e.on_path});const s=n=>{t.a_moves.hover_path=n},r=n=>{var i;t.a_moves.on_path=n,(i=e.on_click)==null||i.call(e,n)};return(()=>{const n=bt.cloneNode(!0),i=n.firstChild;return L(i,v(Ne,{get each(){return t.tree},children:l=>[v(Z,J({on_click:r,on_hover:s},l)),v(Q,{on_click:r,on_hover:s,get mcr(){return l.main_children_and_rest}})]})),n})()}const Q=e=>e.mcr?v(oe,{get when(){return e.mcr[1].length},get fallback(){return[v(Z,J({get on_click(){return e.on_click},get on_hover(){return e.on_hover}},()=>e.mcr[0])),v(Q,{get on_click(){return e.on_click},get on_hover(){return e.on_hover},get mcr(){return e.mcr[0].main_children_and_rest}})]},get children(){const t=$t.cloneNode(!0),s=t.firstChild;return L(s,v(Z,J({get on_click(){return e.on_click},get on_hover(){return e.on_hover}},()=>e.mcr[0])),null),L(s,v(Q,{get on_click(){return e.on_click},get on_hover(){return e.on_hover},get mcr(){return e.mcr[0].main_children_and_rest}}),null),L(t,v(Ne,{get each(){return e.mcr[1]},children:r=>(()=>{const n=kt.cloneNode(!0);return L(n,v(Z,J({get on_click(){return e.on_click},get on_hover(){return e.on_hover}},r)),null),L(n,v(Q,{get on_click(){return e.on_click},get on_hover(){return e.on_hover},get mcr(){return r.main_children_and_rest}}),null),n})()}),null),t}}):[],Z=e=>[(()=>{const t=Ee.cloneNode(!0);return t.$$mouseover=s=>e.on_hover(e.a_move.path),t.addEventListener("mouseleave",s=>e.on_hover(void 0)),t.$$click=s=>e.on_click(e.a_move.path),L(t,v(oe,{get when(){return e.show_index},get children(){const s=wt.cloneNode(!0);return L(s,()=>e.index),s}}),null),L(t,()=>e.a_move.move,null),W(()=>we(t,e.klass+e.a_move.klass)),t})(),(()=>{const t=Ee.cloneNode(!0);return L(t,()=>e.a_move.comments),W(()=>we(t,["comment",e.a_move.klass].join(" "))),t})()];gt(["click","mouseover"]);let Me=new Ke({emit(e){O.ai.local_eval(e),e.depth>=I&&O.ai.crunch_one()}}),Se=10,I=16;const Ct=(e,t)=>{let[s,r]=tt.apply(e);return s.fen===t?[""]:r.filter(([n,i])=>i.fen===t).map(n=>n[0])},ie=class{constructor(){q(this,"path_depths");q(this,"root");q(this,"nb_crunch");q(this,"on_root_changed");q(this,"on_crunch_done")}local_eval(t){Ct(this.root.root,t.fen).forEach(r=>{this.path_depths.set(r,t.depth),t.pvs.forEach(n=>{let i=r;n.cp/100,n.depth;let l=n.moves.slice(0,4);for(let o of l){if(this.root.node_at_path(i).children.find(a=>a.uci===o))break;i=this.root.add_move(i,o,void 0)}})}),this.on_root_changed()}crunch_one(){this.nb_crunch++,this.nb_crunch===Se&&(Me.stop(),this.on_crunch_done()),!(this.nb_crunch>Se)&&et.breadfirst(this.root.root,(t,s)=>{let r=this.path_depths.get(t);if(!r||r<I){let i=this.root.root.node_list(t).map((l,o)=>({ply:o,uci:l.uci,fen:l.fen,san:""}));return Me.start("",i),!0}return!1})}};let O=ie;q(O,"ai",new ie),q(O,"make",(t,s,r)=>{let{ai:n}=ie;n.root=t,n.nb_crunch=0,n.path_depths=new Map;let i=t.flat_export[1].map(l=>l[0]);return i.forEach(l=>n.path_depths.set(l,I)),t.root.child_paths.filter(l=>l.length%4===2).forEach(l=>n.path_depths.delete(l)),i.length>0&&n.path_depths.set("",I),n.on_root_changed=s,n.on_crunch_done=r,n.crunch_one(),n});const Et=le('<div class="guess-app"></div>'),Mt=le('<div class="opening-prep-scene"><div class="board"></div><div class="table"><div class="info"></div><div class="replay"></div><div class="controls"><button>Delete variation</button></div><div class="action"></div></div></div>'),St=le('<button class="primary">Compare AI</button>'),Nt=le('<div class="opening-prep-scene"><div class="board"></div><div class="table"><div class="info">1. Build your opening repertoire as a preset</div><div class="replay"></div><div class="controls"><button>Delete variation</button></div><div class="action"><div>2. Create a challenge</div><h3> Select a color </h3><div class="packs colors"><div class="pack"><span> White </span></div><div class="pack"><span> Black </span></div><div class="pack"><span> Random </span></div></div><button class="primary">Start Game</button></div></div></div>'),Ot=()=>[v(Ze,{children:" aidchess.com - Guess Lines "}),(()=>{const e=Et.cloneNode(!0);return U(e,v(oe,{when:!0,get fallback(){return v(At,{on_start:t=>{}})},get children(){return v(Lt,{})}})),e})()],Lt=()=>{const[e,t]=S(""),[s,r]=S($e.make(),{equals:!1}),[n,i]=S(ue.get_replay(),{equals:!1}),[l,o]=S(!1),h=()=>{o(!0);const d=O.make(s(),()=>{},()=>{let[c,_]=$e.diff_trees(n(),d.root),x=c.filter(y=>y.length%4===2),g=c.filter(y=>y.length%4===0),E=_.filter(y=>y.length%4===0);i(y=>(g.forEach(N=>y.delete_path(N)),y)),i(y=>(E.forEach(N=>{let G=d.root.node_at_path(N);y.add_move(de(N),G.uci)}),y)),r(n().clone),r(y=>(x.forEach(N=>y.delete_children(N)),y)),o(!1)})},u=k(()=>n().node_at_path(e())),a=k(()=>{let d=s().moves().map(_=>{let[x,g,E]=_.split(" ");return E="{__base__}",[x,g,E].join(" ")}),c=n().moves().filter(_=>!d.find(x=>x.split(" ")[0]===_.split(" ")[0])).map(_=>{let[x,g,E]=_.split(" ");return E="{__ghost__}",[x,g,E].join(" ")});return[...d,...c]});Y(()=>{console.log(a())}),k(()=>n().chess(e()));const p=k(()=>n().fen(e())),w=d=>{let c;i(_=>(c=_.add_move(e(),d),_)),c&&t(c)},f=()=>{let d;i(c=>(d=c.delete_variation(e()),c)),d!==void 0&&t(d)};let C=te.make,D=te.make;const T=d=>{var c;if(d<0)t(_=>de(_));else{const _=(c=u())==null?void 0:c.children[0];_&&t(x=>x+_.id)}};return se({on_wheel:T},C),se({on_wheel:T},D),Y(()=>console.log(a())),(()=>{const d=Mt.cloneNode(!0),c=d.firstChild,_=c.nextSibling,x=_.firstChild,g=x.nextSibling,E=g.nextSibling,y=E.firstChild,N=E.nextSibling,G=re(C);typeof G=="function"&&K(G,c),U(c,v(Le,{glyphs:[],get fen(){return p()},isBlack:!1,onUserMove:w}));const H=re(D);return typeof H=="function"&&K(H,g),U(g,v(Pe,{get moves(){return a()},get on_path(){return e()},on_click:j=>t(j)})),y.$$click=f,U(N,v(oe,{get when(){return l()},get fallback(){return(()=>{const j=St.cloneNode(!0);return j.$$click=h,j})()},children:"Comparing..."})),d})()},At=e=>{const[t,s]=S(""),[r,n]=S(ue.get_replay(),{equals:!1});Y(()=>{ue.set_replay(r())});const i=k(()=>r().node_at_path(t())),l=k(()=>r().moves());k(()=>r().chess(t()));const o=k(()=>r().fen(t())),h=d=>{let c;n(_=>(c=_.add_move(t(),d),_)),c&&s(c)},u=()=>{let d;n(c=>(d=c.delete_variation(t()),c)),d!==void 0&&s(d)},[a,p]=S(),w=()=>{e.on_start(a())};let f=te.make,C=te.make;const D=d=>{var c;if(d<0)s(_=>de(_));else{const _=(c=i())==null?void 0:c.children[0];_&&s(x=>x+_.id)}};se({on_wheel:D},f),se({on_wheel:D},C);const T=d=>a()===d?"primary selected":"primary";return(()=>{const d=Nt.cloneNode(!0),c=d.firstChild,_=c.nextSibling,x=_.firstChild,g=x.nextSibling,E=g.nextSibling,y=E.firstChild,N=E.nextSibling,G=N.firstChild,H=G.nextSibling,j=H.nextSibling,ae=j.firstChild,Ue=ae.firstChild,he=ae.nextSibling,Ye=he.firstChild,pe=he.nextSibling,We=pe.firstChild,Xe=j.nextSibling,ve=re(f);typeof ve=="function"&&K(ve,c),U(c,v(Le,{glyphs:[],get fen(){return o()},isBlack:!1,onUserMove:h}));const ge=re(C);return typeof ge=="function"&&K(ge,g),U(g,v(Pe,{get moves(){return l()},get on_path(){return t()},on_click:A=>s(A)})),y.$$click=u,ae.$$click=()=>p("w"),he.$$click=()=>p("b"),pe.$$click=()=>p(),Xe.$$click=w,W(A=>{const ye=T("w"),xe=T("b"),be=T(void 0);return ye!==A._v$&&ce(Ue,A._v$=ye),xe!==A._v$2&&ce(Ye,A._v$2=xe),be!==A._v$3&&ce(We,A._v$3=be),A},{_v$:void 0,_v$2:void 0,_v$3:void 0}),d})()};Ie(["click"]);export{Ot as default};
