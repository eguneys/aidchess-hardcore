var gp=Object.defineProperty;var pp=(h,m,b)=>m in h?gp(h,m,{enumerable:!0,configurable:!0,writable:!0,value:b}):h[m]=b;var Sr=(h,m,b)=>(pp(h,typeof m!="symbol"?m+"":m,b),b);import{a as we,b as re,l as $p,h as Tr,o as _i,i as te,c as xe,j as hp,D as dp,d as sr,e as Ei,F as Si,S as mp,t as ce,n as bp,f as Ap,s as Ti}from"./index-97627c47.js";import{C as Br}from"./chess-ece2668e.js";import{S as Cp,l as kp,K as yp}from"./solid-play-6c62466f.js";import{G as wp}from"./ground-f450dd88.js";import{s as _p,R as Bi}from"./replay_chess-a5cf569d.js";import"./util-2d6699b1.js";let Ep=/^https:\/\/lichess\.org\/study\/([A-Za-z0-9]{8})$/;const Ni=[{title:"Key squares",link:"https://lichess.org/study/8Bu5aigE"},{title:"Mined squares",link:"https://lichess.org/study/GzYzNhAN"}];async function Sp(h){let m=h.match(Ep);if(m){let b=`${m[1]}`,W=await Tp(m[1]);return{matched_reg:b,pgn:W}}}function Tp(h){return fetch(`https://lichess.org/api/study/${h}.pgn`).then(m=>m.text())}var Nr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fr={},Bp={get exports(){return fr},set exports(h){fr=h}};(function(h,m){(function(b,W){W(m)})(Nr,function(b){var W=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Nr<"u"?Nr:typeof self<"u"?self:{},S={},se={get exports(){return S},set exports(T){S=T}};(function(T){(function(K,x){T.exports&&(T.exports=x())})(W,function(){function K(t,A){function r(){this.constructor=t}r.prototype=A.prototype,t.prototype=new r}function x(t,A,r,O){var N=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(N,x.prototype),N.expected=A,N.found=r,N.location=O,N.name="SyntaxError",N}K(x,Error);function j(t,A,r){return r=r||" ",t.length>A?t:(A-=t.length,r+=r.repeat(A),t+r.slice(0,A))}x.prototype.format=function(t){var A="Error: "+this.message;if(this.location){var r=null,O;for(O=0;O<t.length;O++)if(t[O].source===this.location.source){r=t[O].text.split(/\r\n|\n|\r/g);break}var N=this.location.start,I=this.location.source+":"+N.line+":"+N.column;if(r){var V=this.location.end,G=j("",N.line.toString().length," "),D=r[N.line-1],_=N.line===V.line?V.column:D.length+1,w=_-N.column||1;A+=`
 --> `+I+`
`+G+` |
`+N.line+" | "+D+`
`+G+" | "+j("",N.column-1," ")+j("",w,"^")}else A+=`
 at `+I}return A},x.buildMessage=function(t,A){var r={literal:function(_){return'"'+N(_.text)+'"'},class:function(_){var w=_.parts.map(function(U){return Array.isArray(U)?I(U[0])+"-"+I(U[1]):I(U)});return"["+(_.inverted?"^":"")+w.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(_){return _.description}};function O(_){return _.charCodeAt(0).toString(16).toUpperCase()}function N(_){return _.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+O(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+O(w)})}function I(_){return _.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+O(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+O(w)})}function V(_){return r[_.type](_)}function G(_){var w=_.map(V),U,J;if(w.sort(),w.length>0){for(U=1,J=1;U<w.length;U++)w[U-1]!==w[U]&&(w[J]=w[U],J++);w.length=J}switch(w.length){case 1:return w[0];case 2:return w[0]+" or "+w[1];default:return w.slice(0,-1).join(", ")+", or "+w[w.length-1]}}function D(_){return _?'"'+N(_)+'"':"end of input"}return"Expected "+G(t)+" but "+D(A)+" found."};function F(t,A){A=A!==void 0?A:{};var r={},O=A.grammarSource,N={pgn:De,tags:Pa,game:Je,games:lg},I=De,V="Event",G="event",D="Site",_="site",w="Date",U="date",J="Round",Fe="round",ar="White",Pe="white",C="Black",B="black",z="Result",le="result",je="WhiteTitle",Re="Whitetitle",Me="whitetitle",Ie="whiteTitle",We="BlackTitle",ne="Blacktitle",ae="blacktitle",Y="blackTitle",ge="WhiteELO",Ee="WhiteElo",xr="Whiteelo",Fr="whiteelo",Rr="whiteElo",Wr="BlackELO",Or="BlackElo",Dr="Blackelo",Ur="blackelo",Pr="blackElo",jr="WhiteUSCF",Mr="WhiteUscf",Ir="Whiteuscf",Gr="whiteuscf",Vr="whiteUscf",zr="BlackUSCF",qr="BlackUscf",Qr="Blackuscf",Lr="blackuscf",Yr="blackUscf",Zr="WhiteNA",Hr="WhiteNa",Jr="Whitena",Xr="whitena",es="whiteNa",rs="whiteNA",ss="BlackNA",fs="BlackNa",as="Blackna",is="blackna",ts="blackNA",ls="blackNa",ns="WhiteType",cs="Whitetype",os="whitetype",us="whiteType",vs="BlackType",gs="Blacktype",ps="blacktype",$s="blackType",hs="EventDate",ds="Eventdate",ms="eventdate",bs="eventDate",As="EventSponsor",Cs="Eventsponsor",ks="eventsponsor",ys="eventSponsor",ws="Section",_s="section",Es="Stage",Ss="stage",Ts="Board",Bs="board",Ns="Opening",Ks="opening",xs="Variation",Fs="variation",Rs="SubVariation",Ws="Subvariation",Os="subvariation",Ds="subVariation",Us="ECO",Ps="Eco",js="eco",Ms="NIC",Is="Nic",Gs="nic",Vs="Time",zs="time",qs="UTCTime",Qs="UTCtime",Ls="UtcTime",Ys="Utctime",Zs="utctime",Hs="utcTime",Js="UTCDate",Xs="UTCdate",ef="UtcDate",rf="Utcdate",sf="utcdate",ff="utcDate",af="TimeControl",tf="Timecontrol",lf="timecontrol",nf="timeControl",cf="SetUp",of="Setup",uf="setup",vf="setUp",gf="FEN",pf="Fen",$f="fen",hf="Termination",df="termination",mf="Annotator",bf="annotator",Af="Mode",Cf="mode",kf="PlyCount",yf="Plycount",wf="plycount",_f="plyCount",Ef="Variant",Sf="variant",Tf="WhiteRatingDiff",Bf="BlackRatingDiff",Nf="WhiteFideId",Kf="BlackFideId",xf="WhiteTeam",Ff="BlackTeam",Rf="Clock",Wf="WhiteClock",Of="BlackClock",Ge='"',Df="\\",Ve=".",Se=":",ir="/",Uf="B",Ii="W",Gi="N",Pf="?",tr="-",lr="+",jf="*",Mf="1-0",If="0-1",Gf="1/2-1/2",Vf="=",zf="%csl",qf="%cal",nr="%",Qf="%eval",Lf="[%",Yf="}",ze=",",Vi="Y",zi="G",qi="R",Qi="{",Li="[",Yi="]",Zi=";",Zf="clk",Hf="egt",Jf="emt",Xf="mct",Hi="(",Ji=")",ea=" ",Xi="e.p.",ra="O-O-O",sa="O-O",et="@",qe="+-",fa="$$$",rt="#",st="$",aa="!!",ia="??",ta="!?",la="?!",ft="!",at="‼",it="⁇",tt="⁉",lt="⁈",nt="□",ct="∞",ot="⩲",ut="⩱",vt="±",gt="∓",na="-+",pt="⨀",$t="⟳",ht="→",dt="↑",mt="⇆",bt="D",ca="x",Te=/^[ \t\n\r]/,oa=/^[\n\r]/,ua=/^[\-a-zA-Z0-9.]/,At=/^[^"\\\r\n]/,pe=/^[0-9?]/,Z=/^[0-9]/,va=/^[^\n\r]/,Ct=/^[RNBQKP]/,kt=/^[RNBQ]/,yt=/^[a-h]/,wt=/^[1-8]/,_t=c("Event",!1),Et=c("event",!1),St=c("Site",!1),Tt=c("site",!1),Bt=c("Date",!1),Nt=c("date",!1),Kt=c("Round",!1),xt=c("round",!1),Ft=c("White",!1),Rt=c("white",!1),Wt=c("Black",!1),Ot=c("black",!1),Dt=c("Result",!1),Ut=c("result",!1),Pt=c("WhiteTitle",!1),jt=c("Whitetitle",!1),Mt=c("whitetitle",!1),It=c("whiteTitle",!1),Gt=c("BlackTitle",!1),Vt=c("Blacktitle",!1),zt=c("blacktitle",!1),qt=c("blackTitle",!1),Qt=c("WhiteELO",!1),Lt=c("WhiteElo",!1),Yt=c("Whiteelo",!1),Zt=c("whiteelo",!1),Ht=c("whiteElo",!1),Jt=c("BlackELO",!1),Xt=c("BlackElo",!1),el=c("Blackelo",!1),rl=c("blackelo",!1),sl=c("blackElo",!1),fl=c("WhiteUSCF",!1),al=c("WhiteUscf",!1),il=c("Whiteuscf",!1),tl=c("whiteuscf",!1),ll=c("whiteUscf",!1),nl=c("BlackUSCF",!1),cl=c("BlackUscf",!1),ol=c("Blackuscf",!1),ul=c("blackuscf",!1),vl=c("blackUscf",!1),gl=c("WhiteNA",!1),pl=c("WhiteNa",!1),$l=c("Whitena",!1),hl=c("whitena",!1),dl=c("whiteNa",!1),ml=c("whiteNA",!1),bl=c("BlackNA",!1),Al=c("BlackNa",!1),Cl=c("Blackna",!1),kl=c("blackna",!1),yl=c("blackNA",!1),wl=c("blackNa",!1),_l=c("WhiteType",!1),El=c("Whitetype",!1),Sl=c("whitetype",!1),Tl=c("whiteType",!1),Bl=c("BlackType",!1),Nl=c("Blacktype",!1),Kl=c("blacktype",!1),xl=c("blackType",!1),Fl=c("EventDate",!1),Rl=c("Eventdate",!1),Wl=c("eventdate",!1),Ol=c("eventDate",!1),Dl=c("EventSponsor",!1),Ul=c("Eventsponsor",!1),Pl=c("eventsponsor",!1),jl=c("eventSponsor",!1),Ml=c("Section",!1),Il=c("section",!1),Gl=c("Stage",!1),Vl=c("stage",!1),zl=c("Board",!1),ql=c("board",!1),Ql=c("Opening",!1),Ll=c("opening",!1),Yl=c("Variation",!1),Zl=c("variation",!1),Hl=c("SubVariation",!1),Jl=c("Subvariation",!1),Xl=c("subvariation",!1),en=c("subVariation",!1),rn=c("ECO",!1),sn=c("Eco",!1),fn=c("eco",!1),an=c("NIC",!1),tn=c("Nic",!1),ln=c("nic",!1),nn=c("Time",!1),cn=c("time",!1),on=c("UTCTime",!1),un=c("UTCtime",!1),vn=c("UtcTime",!1),gn=c("Utctime",!1),pn=c("utctime",!1),$n=c("utcTime",!1),hn=c("UTCDate",!1),dn=c("UTCdate",!1),mn=c("UtcDate",!1),bn=c("Utcdate",!1),An=c("utcdate",!1),Cn=c("utcDate",!1),kn=c("TimeControl",!1),yn=c("Timecontrol",!1),wn=c("timecontrol",!1),_n=c("timeControl",!1),En=c("SetUp",!1),Sn=c("Setup",!1),Tn=c("setup",!1),Bn=c("setUp",!1),Nn=c("FEN",!1),Kn=c("Fen",!1),xn=c("fen",!1),Fn=c("Termination",!1),Rn=c("termination",!1),Wn=c("Annotator",!1),On=c("annotator",!1),Dn=c("Mode",!1),Un=c("mode",!1),Pn=c("PlyCount",!1),jn=c("Plycount",!1),Mn=c("plycount",!1),In=c("plyCount",!1),Gn=c("Variant",!1),Vn=c("variant",!1),zn=c("WhiteRatingDiff",!1),qn=c("BlackRatingDiff",!1),Qn=c("WhiteFideId",!1),Ln=c("BlackFideId",!1),Yn=c("WhiteTeam",!1),Zn=c("BlackTeam",!1),Hn=c("Clock",!1),Jn=c("WhiteClock",!1),Xn=c("BlackClock",!1),ga=Da("whitespace"),Be=X([" ","	",`
`,"\r"],!1,!1),pa=X([`
`,"\r"],!1,!1),$a=X(["-",["a","z"],["A","Z"],["0","9"],"."],!1,!1),Qe=c('"',!1),ec=X(['"',"\\","\r",`
`],!0,!1),ha=c("\\",!1),$e=X([["0","9"],"?"],!1,!1),Le=c(".",!1),H=X([["0","9"]],!1,!1),Ne=c(":",!1),cr=c("/",!1),da=c("B",!1),rc=c("W",!1),sc=c("N",!1),ma=c("?",!1),or=c("-",!1),ur=c("+",!1),ba=c("*",!1),fc=c("1-0",!1),ac=c("0-1",!1),ic=c("1/2-1/2",!1),vr=c("=",!1),tc=c("%csl",!1),lc=c("%cal",!1),gr=c("%",!1),nc=c("%eval",!1),cc=c("[%",!1),Aa=c("}",!1),Ca=ag(),ka=X([`
`,"\r"],!0,!1),Ye=c(",",!1),oc=c("Y",!1),uc=c("G",!1),vc=c("R",!1),gc=c("{",!1),pc=c("[",!1),$c=c("]",!1),hc=c(";",!1),dc=c("clk",!1),mc=c("egt",!1),bc=c("emt",!1),Ac=c("mct",!1),Cc=c("(",!1),kc=c(")",!1),yc=Da("integer"),ya=c(" ",!1),wc=c("e.p.",!1),_c=c("O-O-O",!1),Ec=c("O-O",!1),Sc=c("@",!1),wa=c("+-",!1),Tc=c("$$$",!1),Bc=c("#",!1),Nc=c("$",!1),Kc=c("!!",!1),xc=c("??",!1),Fc=c("!?",!1),Rc=c("?!",!1),Wc=c("!",!1),Oc=c("‼",!1),Dc=c("⁇",!1),Uc=c("⁉",!1),Pc=c("⁈",!1),jc=c("□",!1),Mc=c("∞",!1),Ic=c("⩲",!1),Gc=c("⩱",!1),Vc=c("±",!1),zc=c("∓",!1),qc=c("-+",!1),Qc=c("⨀",!1),Lc=c("⟳",!1),Yc=c("→",!1),Zc=c("↑",!1),Hc=c("⇆",!1),Jc=c("D",!1),Xc=X(["R","N","B","Q","K","P"],!1,!1),eo=X(["R","N","B","Q"],!1,!1),ro=X([["a","h"]],!1,!1),so=X([["1","8"]],!1,!1),_a=c("x",!1),Ea=function(e,f){return f},fo=function(e,f){return[e].concat(f)},ao=function(e){return e},io=function(e,f,i){var a=rr;return rr=[],{tags:e,gameComment:f,moves:i,messages:a}},Sa=function(e,f){return f},to=function(e,f){var i={};return[e].concat(f).forEach(function(a){i[a.name]=a.value}),i},lo=function(e){return e===null?{}:(e.messages=rr,e)},no=function(e){return e},co=function(e){return{name:"Event",value:e}},oo=function(e){return{name:"Site",value:e}},uo=function(e){return{name:"Date",value:e}},vo=function(e){return{name:"Round",value:e}},go=function(e){return{name:"WhiteTitle",value:e}},po=function(e){return{name:"BlackTitle",value:e}},$o=function(e){return{name:"WhiteElo",value:e}},ho=function(e){return{name:"BlackElo",value:e}},mo=function(e){return{name:"WhiteUSCF",value:e}},bo=function(e){return{name:"BlackUSCF",value:e}},Ao=function(e){return{name:"WhiteNA",value:e}},Co=function(e){return{name:"BlackNA",value:e}},ko=function(e){return{name:"WhiteType",value:e}},yo=function(e){return{name:"BlackType",value:e}},wo=function(e){return{name:"White",value:e}},_o=function(e){return{name:"Black",value:e}},Eo=function(e){return{name:"Result",value:e}},So=function(e){return{name:"EventDate",value:e}},To=function(e){return{name:"EventSponsor",value:e}},Bo=function(e){return{name:"Section",value:e}},No=function(e){return{name:"Stage",value:e}},Ko=function(e){return{name:"Board",value:e}},xo=function(e){return{name:"Opening",value:e}},Fo=function(e){return{name:"Variation",value:e}},Ro=function(e){return{name:"SubVariation",value:e}},Wo=function(e){return{name:"ECO",value:e}},Oo=function(e){return{name:"NIC",value:e}},Do=function(e){return{name:"Time",value:e}},Uo=function(e){return{name:"UTCTime",value:e}},Po=function(e){return{name:"UTCDate",value:e}},jo=function(e){return{name:"TimeControl",value:e}},Mo=function(e){return{name:"SetUp",value:e}},Io=function(e){return{name:"FEN",value:e}},Go=function(e){return{name:"Termination",value:e}},Vo=function(e){return{name:"Annotator",value:e}},zo=function(e){return{name:"Mode",value:e}},qo=function(e){return{name:"PlyCount",value:e}},Qo=function(e){return{name:"Variant",value:e}},Lo=function(e){return{name:"WhiteRatingDiff",value:e}},Yo=function(e){return{name:"BlackRatingDiff",value:e}},Zo=function(e){return{name:"WhiteFideId",value:e}},Ho=function(e){return{name:"BlackFideId",value:e}},Jo=function(e){return{name:"WhiteTeam",value:e}},Xo=function(e){return{name:"BlackTeam",value:e}},eu=function(e){return{name:"Clock",value:e}},ru=function(e){return{name:"WhiteClock",value:e}},su=function(e){return{name:"BlackClock",value:e}},fu=function(e,f){return L({key:e,value:f,message:`Format of tag: "${e}" not correct: "${f}"`}),{name:e,value:f}},au=function(e,f){return L({key:e,value:f,message:`Tag: "${e}" not known: "${f}"`}),{name:e,value:f}},iu=function(e){return e.join("")},tu=function(e){return e.map(f=>f.char||f).join("")},lu=function(){return{type:"char",char:"\\"}},nu=function(){return{type:"char",char:'"'}},cu=function(e){return e},ou=function(e,f,i){return{value:""+e.join("")+"."+f.join("")+"."+i.join(""),year:ye(e),month:ye(f),day:ye(i)}},uu=function(e,f,i,a){let o=e.join("")+":"+f.join("")+":"+i.join(""),v=0;return a&&(o=o+"."+a,L({message:`Unusual use of millis in time: ${o}`}),ye(a)),{value:o,hour:ye(e),minute:ye(f),second:ye(i),millis:v}},vu=function(e){return e.join("")},gu=function(e){return e},pu=function(e,f){return e+"/"+f},$u=function(e){return e},hu=function(e){return e},du=function(e){return e||(L({message:"Tag TimeControl has to have a value"}),"")},Ta=function(e,f){return f},mu=function(e,f){return[e].concat(f)},bu=function(e){return e},Au=function(){return{kind:"unknown",value:"?"}},Cu=function(){return{kind:"unlimited",value:"-"}},ku=function(e,f,i){return{kind:"movesInSecondsIncrement",moves:e,seconds:f,increment:i}},yu=function(e,f){return{kind:"movesInSeconds",moves:e,seconds:f}},wu=function(e,f){return{kind:"increment",seconds:e,increment:f}},_u=function(e){return{kind:"suddenDeath",seconds:e}},Eu=function(e){return{kind:"hourglass",seconds:e}},Su=function(e){return e},Tu=function(e){return e},Bu=function(e){return e},Nu=function(e){return e},Ku=function(e){return e},xu=function(e){return e},Fu=function(){return 0},Ru=function(){return L({message:'Use "-" for an unknown value'}),0},Wu=function(e){return Er(e)},Ou=function(e,f,i,a,o,v,g,$){var k=$||[],R={};return R.moveNumber=f,R.notation=i,v&&(R.commentAfter=v.comment),e&&(R.commentMove=e.comment),o&&(R.drawOffer=!0),R.variations=g||[],R.nag=a||null,k.unshift(R),R.commentDiag=v,k},Du=function(e){return e},Uu=function(e){return[e]},Ba=function(e,f){return f},Pu=function(e,f){return Ae([e].concat(f))},ju=function(e){return e},Mu=function(e){return{comment:e}},Na=function(e,f){return f},Iu=function(e,f){return Ae([{colorFields:e}].concat(f[0]))},Ka=function(e,f){return f},Gu=function(e,f){return Ae([{colorArrows:e}].concat(f[0]))},xa=function(e,f,i){return i},Vu=function(e,f,i){var a={};return a[e]=f,Ae([a].concat(i[0]))},Fa=function(e,f,i){return i},zu=function(e,f,i){var a={};return a[e]=f,Ae([a].concat(i[0]))},Ra=function(e,f){return f},qu=function(e,f){var i={};return i.eval=parseFloat(e),Ae([i].concat(f[0]))},Wa=function(e,f,i){return i},Qu=function(e,f,i){var a={};return a[e]=f.join(""),Ae([a].concat(i[0]))},Oa=function(e,f){return f},Lu=function(e,f){return f.length>0?Ae([{comment:wi(e.join(""))}].concat(yi(f[0]))):{comment:e.join("")}},Yu=function(e){return e},Zu=function(e){return e},Hu=function(e){return e.join("")},Ju=function(e,f){var i=[];i.push(e);for(var a=0;a<f.length;a++)i.push(f[a][2]);return i},Xu=function(e,f){return e+f},ev=function(e,f){var i=[];i.push(e);for(var a=0;a<f.length;a++)i.push(f[a][2]);return i},rv=function(e,f,i){return e+f+i},sv=function(){return"Y"},fv=function(){return"G"},av=function(){return"R"},iv=function(){return"B"},tv=function(e,f){return e+f},lv=function(){return"clk"},nv=function(){return"egt"},cv=function(){return"emt"},ov=function(){return"mct"},uv=function(e,f,i,a){let o=f;return e?o=e+o:L({message:"Hours and minutes missing"}),e&&(e.match(/:/g)||[]).length==2&&e.search(":")==2&&L({message:"Only 1 digit for hours normally used"}),i?o+=i:L({message:"Only 2 digit for seconds normally used"}),a&&(L({message:"Unusual use of millis in clock value"}),o+="."+a),o},vv=function(e,f,i){let a=f;return e?a=e+a:L({message:"Hours and minutes missing"}),e&&(e.match(/:/g)||[]).length==2&&e.search(":")==1&&L({message:"Only 2 digits for hours normally used"}),i?a+=i:L({message:"Only 2 digit for seconds normally used"}),a},gv=function(e,f){return f?e+f:(L({message:"No hours found"}),e)},pv=function(e,f){let i=e;return f?i+=f+":":i+=":",i},$v=function(e,f){let i=e;return f?i+=f+":":(i+=":",L({message:"Only 2 digits for minutes normally used"})),i},hv=function(e){return e},dv=function(e,f){var i=f||[];return i.unshift(e),i},mv=function(e){return e},bv=function(e){return Er(e)},Av=function(){return""},Cv=function(e,f,i,a,o,v,g){var $={};return $.fig=e||null,$.disc=f||null,$.strike=i||null,$.col=a,$.row=o,$.check=g||null,$.promotion=v,$.notation=(e||"")+(f||"")+(i||"")+a+o+(v||"")+(g||""),$},kv=function(e,f,i,a,o,v,g,$){var k={};return k.fig=e||null,k.strike=a=="x"?a:null,k.col=o,k.row=v,k.notation=(e&&e!=="P"?e:"")+f+i+(a=="x"?a:"-")+o+v+(g||"")+($||""),k.check=$||null,k.promotion=g,k},yv=function(e,f,i,a,o,v){var g={};return g.fig=e||null,g.strike=f||null,g.col=i,g.row=a,g.check=v||null,g.promotion=o,g.notation=(e||"")+(f||"")+i+a+(o||"")+(v||""),g},wv=function(e){var f={};return f.notation="O-O-O"+(e||""),f.check=e||null,f},_v=function(e){var f={};return f.notation="O-O"+(e||""),f.check=e||null,f},Ev=function(e,f,i){var a={};return a.fig=e,a.drop=!0,a.col=f,a.row=i,a.notation=e+"@"+f+i,a},Sv=function(e){return e[1]},Tv=function(e){return e[1]},Bv=function(e){return"="+e},Nv=function(e,f){var i=f||[];return i.unshift(e),i},Kv=function(e){return"$"+e},xv=function(){return"$3"},Fv=function(){return"$4"},Rv=function(){return"$5"},Wv=function(){return"$6"},Ov=function(){return"$1"},Dv=function(){return"$2"},Uv=function(){return"$3"},Pv=function(){return"$4"},jv=function(){return"$5"},Mv=function(){return"$6"},Iv=function(){return"$7"},Gv=function(){return"$10"},Vv=function(){return"$13"},zv=function(){return"$14"},qv=function(){return"$15"},Qv=function(){return"$16"},Lv=function(){return"$17"},Yv=function(){return"$18"},Zv=function(){return"$19"},Hv=function(){return"$22"},Jv=function(){return"$32"},Xv=function(){return"$36"},eg=function(){return"$40"},rg=function(){return"$132"},sg=function(){return"$220"},s=0,u=0,Ze=[{line:1,column:1}],ie=0,pr=[],l=0,He;if("startRule"in A){if(!(A.startRule in N))throw new Error(`Can't start parsing from rule "`+A.startRule+'".');I=N[A.startRule]}function fg(){return $r(u,s)}function c(e,f){return{type:"literal",text:e,ignoreCase:f}}function X(e,f,i){return{type:"class",parts:e,inverted:f,ignoreCase:i}}function ag(){return{type:"any"}}function ig(){return{type:"end"}}function Da(e){return{type:"other",description:e}}function Ua(e){var f=Ze[e],i;if(f)return f;for(i=e-1;!Ze[i];)i--;for(f=Ze[i],f={line:f.line,column:f.column};i<e;)t.charCodeAt(i)===10?(f.line++,f.column=1):f.column++,i++;return Ze[e]=f,f}function $r(e,f){var i=Ua(e),a=Ua(f);return{source:O,start:{offset:e,line:i.line,column:i.column},end:{offset:f,line:a.line,column:a.column}}}function n(e){s<ie||(s>ie&&(ie=s,pr=[]),pr.push(e))}function tg(e,f,i){return new x(x.buildMessage(e,f),e,f,i)}function lg(){var e,f,i,a,o,v;if(e=s,p(),f=s,i=Je(),i!==r){for(a=[],o=s,p(),v=Je(),v!==r?(u=o,o=Ea(i,v)):(s=o,o=r);o!==r;)a.push(o),o=s,p(),v=Je(),v!==r?(u=o,o=Ea(i,v)):(s=o,o=r);u=f,f=fo(i,a)}else s=f,f=r;return f===r&&(f=null),u=e,e=ao(f),e}function Je(){var e,f,i,a;return e=s,f=Pa(),i=br(),i===r&&(i=null),a=De(),a!==r?(u=e,e=io(f,i,a)):(s=e,e=r),e}function Pa(){var e,f,i,a,o,v;if(e=s,p(),f=s,i=hr(),i!==r){for(a=[],o=s,p(),v=hr(),v!==r?(u=o,o=Sa(i,v)):(s=o,o=r);o!==r;)a.push(o),o=s,p(),v=hr(),v!==r?(u=o,o=Sa(i,v)):(s=o,o=r);u=f,f=to(i,a)}else s=f,f=r;return f===r&&(f=null),i=p(),u=e,e=lo(f),e}function hr(){var e,f,i,a;return e=s,f=ke(),f!==r?(p(),i=ng(),i!==r?(p(),a=he(),a!==r?(u=e,e=no(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function ng(){var e,f,i,a,o;return e=s,f=cg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=co(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=og(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=oo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ma(),f!==r?(i=p(),a=dr(),a!==r?(u=e,e=uo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=ug(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=vo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=pg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=go(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=$g(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=po(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ga(),f!==r?(i=p(),a=oi(),a!==r?(u=e,e=$o(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Va(),f!==r?(i=p(),a=oi(),a!==r?(u=e,e=ho(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=za(),f!==r?(i=p(),a=Oe(),a!==r?(u=e,e=mo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=qa(),f!==r?(i=p(),a=Oe(),a!==r?(u=e,e=bo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=hg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Ao(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=dg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Co(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=mg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=ko(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=bg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=yo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=vg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=wo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=gg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=_o(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ia(),f!==r?(i=p(),a=Qg(),a!==r?(u=e,e=Eo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Qa(),f!==r?(i=p(),a=dr(),a!==r?(u=e,e=So(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ag(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=To(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Cg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Bo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=kg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=No(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=La(),f!==r?(i=p(),a=Oe(),a!==r?(u=e,e=Ko(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=yg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=xo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=wg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Fo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=_g(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Ro(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Eg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Wo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Sg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Oo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ya(),f!==r?(i=p(),a=ii(),a!==r?(u=e,e=Do(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Za(),f!==r?(i=p(),a=ii(),a!==r?(u=e,e=Uo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ha(),f!==r?(i=p(),a=dr(),a!==r?(u=e,e=Po(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ja(),f!==r?(i=p(),a=zg(),a!==r?(u=e,e=jo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Tg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Mo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Bg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Io(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ng(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Go(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Kg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Vo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=xg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=zo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Xa(),f!==r?(i=p(),a=Oe(),a!==r?(u=e,e=qo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Fg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Qo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Rg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Lo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Wg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Yo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Og(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Zo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Dg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Ho(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Ug(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Jo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Pg(),f!==r?(i=p(),a=E(),a!==r?(u=e,e=Xo(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=ei(),f!==r?(i=p(),a=Ig(),a!==r?(u=e,e=eu(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=ri(),f!==r?(i=p(),a=li(),a!==r?(u=e,e=ru(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=si(),f!==r?(i=p(),a=li(),a!==r?(u=e,e=su(a)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=s,l++,i=ja(),l--,i!==r?(s=f,f=void 0):f=r,f!==r?(i=Xe(),a=p(),o=E(),o!==r?(u=e,e=fu(i,o)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=s,l++,i=ja(),l--,i===r?f=void 0:(s=f,f=r),f!==r?(i=Xe(),a=p(),o=E(),o!==r?(u=e,e=au(i,o)):(s=e,e=r)):(s=e,e=r))))))))))))))))))))))))))))))))))))))))))))))))),e}function ja(){var e;return e=Ma(),e===r&&(e=Ga(),e===r&&(e=Va(),e===r&&(e=za(),e===r&&(e=qa(),e===r&&(e=Ia(),e===r&&(e=Qa(),e===r&&(e=La(),e===r&&(e=Ya(),e===r&&(e=Za(),e===r&&(e=Ha(),e===r&&(e=Ja(),e===r&&(e=Xa(),e===r&&(e=ei(),e===r&&(e=ri(),e===r&&(e=si()))))))))))))))),e}function cg(){var e;return t.substr(s,5)===V?(e=V,s+=5):(e=r,l===0&&n(_t)),e===r&&(t.substr(s,5)===G?(e=G,s+=5):(e=r,l===0&&n(Et))),e}function og(){var e;return t.substr(s,4)===D?(e=D,s+=4):(e=r,l===0&&n(St)),e===r&&(t.substr(s,4)===_?(e=_,s+=4):(e=r,l===0&&n(Tt))),e}function Ma(){var e;return t.substr(s,4)===w?(e=w,s+=4):(e=r,l===0&&n(Bt)),e===r&&(t.substr(s,4)===U?(e=U,s+=4):(e=r,l===0&&n(Nt))),e}function ug(){var e;return t.substr(s,5)===J?(e=J,s+=5):(e=r,l===0&&n(Kt)),e===r&&(t.substr(s,5)===Fe?(e=Fe,s+=5):(e=r,l===0&&n(xt))),e}function vg(){var e;return t.substr(s,5)===ar?(e=ar,s+=5):(e=r,l===0&&n(Ft)),e===r&&(t.substr(s,5)===Pe?(e=Pe,s+=5):(e=r,l===0&&n(Rt))),e}function gg(){var e;return t.substr(s,5)===C?(e=C,s+=5):(e=r,l===0&&n(Wt)),e===r&&(t.substr(s,5)===B?(e=B,s+=5):(e=r,l===0&&n(Ot))),e}function Ia(){var e;return t.substr(s,6)===z?(e=z,s+=6):(e=r,l===0&&n(Dt)),e===r&&(t.substr(s,6)===le?(e=le,s+=6):(e=r,l===0&&n(Ut))),e}function pg(){var e;return t.substr(s,10)===je?(e=je,s+=10):(e=r,l===0&&n(Pt)),e===r&&(t.substr(s,10)===Re?(e=Re,s+=10):(e=r,l===0&&n(jt)),e===r&&(t.substr(s,10)===Me?(e=Me,s+=10):(e=r,l===0&&n(Mt)),e===r&&(t.substr(s,10)===Ie?(e=Ie,s+=10):(e=r,l===0&&n(It))))),e}function $g(){var e;return t.substr(s,10)===We?(e=We,s+=10):(e=r,l===0&&n(Gt)),e===r&&(t.substr(s,10)===ne?(e=ne,s+=10):(e=r,l===0&&n(Vt)),e===r&&(t.substr(s,10)===ae?(e=ae,s+=10):(e=r,l===0&&n(zt)),e===r&&(t.substr(s,10)===Y?(e=Y,s+=10):(e=r,l===0&&n(qt))))),e}function Ga(){var e;return t.substr(s,8)===ge?(e=ge,s+=8):(e=r,l===0&&n(Qt)),e===r&&(t.substr(s,8)===Ee?(e=Ee,s+=8):(e=r,l===0&&n(Lt)),e===r&&(t.substr(s,8)===xr?(e=xr,s+=8):(e=r,l===0&&n(Yt)),e===r&&(t.substr(s,8)===Fr?(e=Fr,s+=8):(e=r,l===0&&n(Zt)),e===r&&(t.substr(s,8)===Rr?(e=Rr,s+=8):(e=r,l===0&&n(Ht)))))),e}function Va(){var e;return t.substr(s,8)===Wr?(e=Wr,s+=8):(e=r,l===0&&n(Jt)),e===r&&(t.substr(s,8)===Or?(e=Or,s+=8):(e=r,l===0&&n(Xt)),e===r&&(t.substr(s,8)===Dr?(e=Dr,s+=8):(e=r,l===0&&n(el)),e===r&&(t.substr(s,8)===Ur?(e=Ur,s+=8):(e=r,l===0&&n(rl)),e===r&&(t.substr(s,8)===Pr?(e=Pr,s+=8):(e=r,l===0&&n(sl)))))),e}function za(){var e;return t.substr(s,9)===jr?(e=jr,s+=9):(e=r,l===0&&n(fl)),e===r&&(t.substr(s,9)===Mr?(e=Mr,s+=9):(e=r,l===0&&n(al)),e===r&&(t.substr(s,9)===Ir?(e=Ir,s+=9):(e=r,l===0&&n(il)),e===r&&(t.substr(s,9)===Gr?(e=Gr,s+=9):(e=r,l===0&&n(tl)),e===r&&(t.substr(s,9)===Vr?(e=Vr,s+=9):(e=r,l===0&&n(ll)))))),e}function qa(){var e;return t.substr(s,9)===zr?(e=zr,s+=9):(e=r,l===0&&n(nl)),e===r&&(t.substr(s,9)===qr?(e=qr,s+=9):(e=r,l===0&&n(cl)),e===r&&(t.substr(s,9)===Qr?(e=Qr,s+=9):(e=r,l===0&&n(ol)),e===r&&(t.substr(s,9)===Lr?(e=Lr,s+=9):(e=r,l===0&&n(ul)),e===r&&(t.substr(s,9)===Yr?(e=Yr,s+=9):(e=r,l===0&&n(vl)))))),e}function hg(){var e;return t.substr(s,7)===Zr?(e=Zr,s+=7):(e=r,l===0&&n(gl)),e===r&&(t.substr(s,7)===Hr?(e=Hr,s+=7):(e=r,l===0&&n(pl)),e===r&&(t.substr(s,7)===Jr?(e=Jr,s+=7):(e=r,l===0&&n($l)),e===r&&(t.substr(s,7)===Xr?(e=Xr,s+=7):(e=r,l===0&&n(hl)),e===r&&(t.substr(s,7)===es?(e=es,s+=7):(e=r,l===0&&n(dl)),e===r&&(t.substr(s,7)===rs?(e=rs,s+=7):(e=r,l===0&&n(ml))))))),e}function dg(){var e;return t.substr(s,7)===ss?(e=ss,s+=7):(e=r,l===0&&n(bl)),e===r&&(t.substr(s,7)===fs?(e=fs,s+=7):(e=r,l===0&&n(Al)),e===r&&(t.substr(s,7)===as?(e=as,s+=7):(e=r,l===0&&n(Cl)),e===r&&(t.substr(s,7)===is?(e=is,s+=7):(e=r,l===0&&n(kl)),e===r&&(t.substr(s,7)===ts?(e=ts,s+=7):(e=r,l===0&&n(yl)),e===r&&(t.substr(s,7)===ls?(e=ls,s+=7):(e=r,l===0&&n(wl))))))),e}function mg(){var e;return t.substr(s,9)===ns?(e=ns,s+=9):(e=r,l===0&&n(_l)),e===r&&(t.substr(s,9)===cs?(e=cs,s+=9):(e=r,l===0&&n(El)),e===r&&(t.substr(s,9)===os?(e=os,s+=9):(e=r,l===0&&n(Sl)),e===r&&(t.substr(s,9)===us?(e=us,s+=9):(e=r,l===0&&n(Tl))))),e}function bg(){var e;return t.substr(s,9)===vs?(e=vs,s+=9):(e=r,l===0&&n(Bl)),e===r&&(t.substr(s,9)===gs?(e=gs,s+=9):(e=r,l===0&&n(Nl)),e===r&&(t.substr(s,9)===ps?(e=ps,s+=9):(e=r,l===0&&n(Kl)),e===r&&(t.substr(s,9)===$s?(e=$s,s+=9):(e=r,l===0&&n(xl))))),e}function Qa(){var e;return t.substr(s,9)===hs?(e=hs,s+=9):(e=r,l===0&&n(Fl)),e===r&&(t.substr(s,9)===ds?(e=ds,s+=9):(e=r,l===0&&n(Rl)),e===r&&(t.substr(s,9)===ms?(e=ms,s+=9):(e=r,l===0&&n(Wl)),e===r&&(t.substr(s,9)===bs?(e=bs,s+=9):(e=r,l===0&&n(Ol))))),e}function Ag(){var e;return t.substr(s,12)===As?(e=As,s+=12):(e=r,l===0&&n(Dl)),e===r&&(t.substr(s,12)===Cs?(e=Cs,s+=12):(e=r,l===0&&n(Ul)),e===r&&(t.substr(s,12)===ks?(e=ks,s+=12):(e=r,l===0&&n(Pl)),e===r&&(t.substr(s,12)===ys?(e=ys,s+=12):(e=r,l===0&&n(jl))))),e}function Cg(){var e;return t.substr(s,7)===ws?(e=ws,s+=7):(e=r,l===0&&n(Ml)),e===r&&(t.substr(s,7)===_s?(e=_s,s+=7):(e=r,l===0&&n(Il))),e}function kg(){var e;return t.substr(s,5)===Es?(e=Es,s+=5):(e=r,l===0&&n(Gl)),e===r&&(t.substr(s,5)===Ss?(e=Ss,s+=5):(e=r,l===0&&n(Vl))),e}function La(){var e;return t.substr(s,5)===Ts?(e=Ts,s+=5):(e=r,l===0&&n(zl)),e===r&&(t.substr(s,5)===Bs?(e=Bs,s+=5):(e=r,l===0&&n(ql))),e}function yg(){var e;return t.substr(s,7)===Ns?(e=Ns,s+=7):(e=r,l===0&&n(Ql)),e===r&&(t.substr(s,7)===Ks?(e=Ks,s+=7):(e=r,l===0&&n(Ll))),e}function wg(){var e;return t.substr(s,9)===xs?(e=xs,s+=9):(e=r,l===0&&n(Yl)),e===r&&(t.substr(s,9)===Fs?(e=Fs,s+=9):(e=r,l===0&&n(Zl))),e}function _g(){var e;return t.substr(s,12)===Rs?(e=Rs,s+=12):(e=r,l===0&&n(Hl)),e===r&&(t.substr(s,12)===Ws?(e=Ws,s+=12):(e=r,l===0&&n(Jl)),e===r&&(t.substr(s,12)===Os?(e=Os,s+=12):(e=r,l===0&&n(Xl)),e===r&&(t.substr(s,12)===Ds?(e=Ds,s+=12):(e=r,l===0&&n(en))))),e}function Eg(){var e;return t.substr(s,3)===Us?(e=Us,s+=3):(e=r,l===0&&n(rn)),e===r&&(t.substr(s,3)===Ps?(e=Ps,s+=3):(e=r,l===0&&n(sn)),e===r&&(t.substr(s,3)===js?(e=js,s+=3):(e=r,l===0&&n(fn)))),e}function Sg(){var e;return t.substr(s,3)===Ms?(e=Ms,s+=3):(e=r,l===0&&n(an)),e===r&&(t.substr(s,3)===Is?(e=Is,s+=3):(e=r,l===0&&n(tn)),e===r&&(t.substr(s,3)===Gs?(e=Gs,s+=3):(e=r,l===0&&n(ln)))),e}function Ya(){var e;return t.substr(s,4)===Vs?(e=Vs,s+=4):(e=r,l===0&&n(nn)),e===r&&(t.substr(s,4)===zs?(e=zs,s+=4):(e=r,l===0&&n(cn))),e}function Za(){var e;return t.substr(s,7)===qs?(e=qs,s+=7):(e=r,l===0&&n(on)),e===r&&(t.substr(s,7)===Qs?(e=Qs,s+=7):(e=r,l===0&&n(un)),e===r&&(t.substr(s,7)===Ls?(e=Ls,s+=7):(e=r,l===0&&n(vn)),e===r&&(t.substr(s,7)===Ys?(e=Ys,s+=7):(e=r,l===0&&n(gn)),e===r&&(t.substr(s,7)===Zs?(e=Zs,s+=7):(e=r,l===0&&n(pn)),e===r&&(t.substr(s,7)===Hs?(e=Hs,s+=7):(e=r,l===0&&n($n))))))),e}function Ha(){var e;return t.substr(s,7)===Js?(e=Js,s+=7):(e=r,l===0&&n(hn)),e===r&&(t.substr(s,7)===Xs?(e=Xs,s+=7):(e=r,l===0&&n(dn)),e===r&&(t.substr(s,7)===ef?(e=ef,s+=7):(e=r,l===0&&n(mn)),e===r&&(t.substr(s,7)===rf?(e=rf,s+=7):(e=r,l===0&&n(bn)),e===r&&(t.substr(s,7)===sf?(e=sf,s+=7):(e=r,l===0&&n(An)),e===r&&(t.substr(s,7)===ff?(e=ff,s+=7):(e=r,l===0&&n(Cn))))))),e}function Ja(){var e;return t.substr(s,11)===af?(e=af,s+=11):(e=r,l===0&&n(kn)),e===r&&(t.substr(s,11)===tf?(e=tf,s+=11):(e=r,l===0&&n(yn)),e===r&&(t.substr(s,11)===lf?(e=lf,s+=11):(e=r,l===0&&n(wn)),e===r&&(t.substr(s,11)===nf?(e=nf,s+=11):(e=r,l===0&&n(_n))))),e}function Tg(){var e;return t.substr(s,5)===cf?(e=cf,s+=5):(e=r,l===0&&n(En)),e===r&&(t.substr(s,5)===of?(e=of,s+=5):(e=r,l===0&&n(Sn)),e===r&&(t.substr(s,5)===uf?(e=uf,s+=5):(e=r,l===0&&n(Tn)),e===r&&(t.substr(s,5)===vf?(e=vf,s+=5):(e=r,l===0&&n(Bn))))),e}function Bg(){var e;return t.substr(s,3)===gf?(e=gf,s+=3):(e=r,l===0&&n(Nn)),e===r&&(t.substr(s,3)===pf?(e=pf,s+=3):(e=r,l===0&&n(Kn)),e===r&&(t.substr(s,3)===$f?(e=$f,s+=3):(e=r,l===0&&n(xn)))),e}function Ng(){var e;return t.substr(s,11)===hf?(e=hf,s+=11):(e=r,l===0&&n(Fn)),e===r&&(t.substr(s,11)===df?(e=df,s+=11):(e=r,l===0&&n(Rn))),e}function Kg(){var e;return t.substr(s,9)===mf?(e=mf,s+=9):(e=r,l===0&&n(Wn)),e===r&&(t.substr(s,9)===bf?(e=bf,s+=9):(e=r,l===0&&n(On))),e}function xg(){var e;return t.substr(s,4)===Af?(e=Af,s+=4):(e=r,l===0&&n(Dn)),e===r&&(t.substr(s,4)===Cf?(e=Cf,s+=4):(e=r,l===0&&n(Un))),e}function Xa(){var e;return t.substr(s,8)===kf?(e=kf,s+=8):(e=r,l===0&&n(Pn)),e===r&&(t.substr(s,8)===yf?(e=yf,s+=8):(e=r,l===0&&n(jn)),e===r&&(t.substr(s,8)===wf?(e=wf,s+=8):(e=r,l===0&&n(Mn)),e===r&&(t.substr(s,8)===_f?(e=_f,s+=8):(e=r,l===0&&n(In))))),e}function Fg(){var e;return t.substr(s,7)===Ef?(e=Ef,s+=7):(e=r,l===0&&n(Gn)),e===r&&(t.substr(s,7)===Sf?(e=Sf,s+=7):(e=r,l===0&&n(Vn))),e}function Rg(){var e;return t.substr(s,15)===Tf?(e=Tf,s+=15):(e=r,l===0&&n(zn)),e}function Wg(){var e;return t.substr(s,15)===Bf?(e=Bf,s+=15):(e=r,l===0&&n(qn)),e}function Og(){var e;return t.substr(s,11)===Nf?(e=Nf,s+=11):(e=r,l===0&&n(Qn)),e}function Dg(){var e;return t.substr(s,11)===Kf?(e=Kf,s+=11):(e=r,l===0&&n(Ln)),e}function Ug(){var e;return t.substr(s,9)===xf?(e=xf,s+=9):(e=r,l===0&&n(Yn)),e}function Pg(){var e;return t.substr(s,9)===Ff?(e=Ff,s+=9):(e=r,l===0&&n(Zn)),e}function ei(){var e;return t.substr(s,5)===Rf?(e=Rf,s+=5):(e=r,l===0&&n(Hn)),e}function ri(){var e;return t.substr(s,10)===Wf?(e=Wf,s+=10):(e=r,l===0&&n(Jn)),e}function si(){var e;return t.substr(s,10)===Of?(e=Of,s+=10):(e=r,l===0&&n(Xn)),e}function p(){var e,f;for(l++,e=[],Te.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Be));f!==r;)e.push(f),Te.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Be));return l--,f=r,l===0&&n(ga),e}function Ke(){var e,f;if(e=[],Te.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Be)),f!==r)for(;f!==r;)e.push(f),Te.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Be));else e=r;return e}function jg(){var e,f;if(e=[],oa.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(pa)),f!==r)for(;f!==r;)e.push(f),oa.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(pa));else e=r;return e}function Xe(){var e,f,i;for(e=s,f=[],ua.test(t.charAt(s))?(i=t.charAt(s),s++):(i=r,l===0&&n($a));i!==r;)f.push(i),ua.test(t.charAt(s))?(i=t.charAt(s),s++):(i=r,l===0&&n($a));return u=e,f=iu(f),e=f,e}function M(){var e;return t.charCodeAt(s)===34?(e=Ge,s++):(e=r,l===0&&n(Qe)),e}function E(){var e,f,i,a,o;if(e=s,t.charCodeAt(s)===34?(f=Ge,s++):(f=r,l===0&&n(Qe)),f!==r){for(ai(),i=[],a=fi();a!==r;)i.push(a),a=fi();a=ai(),t.charCodeAt(s)===34?(o=Ge,s++):(o=r,l===0&&n(Qe)),o!==r?(u=e,e=tu(i)):(s=e,e=r)}else s=e,e=r;return e}function fi(){var e,f,i,a;return At.test(t.charAt(s))?(e=t.charAt(s),s++):(e=r,l===0&&n(ec)),e===r&&(e=s,f=Mg(),f!==r?(i=s,t.charCodeAt(s)===92?(a=Df,s++):(a=r,l===0&&n(ha)),a!==r&&(u=i,a=lu()),i=a,i===r&&(i=s,t.charCodeAt(s)===34?(a=Ge,s++):(a=r,l===0&&n(Qe)),a!==r&&(u=i,a=nu()),i=a),i!==r?(u=e,e=cu(i)):(s=e,e=r)):(s=e,e=r)),e}function ai(){var e,f;for(l++,e=[],Te.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Be));f!==r;)e.push(f),Te.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(Be));return l--,f=r,l===0&&n(ga),e}function Mg(){var e;return t.charCodeAt(s)===92?(e=Df,s++):(e=r,l===0&&n(ha)),e}function dr(){var e,f,i,a,o,v,g,$,k;return e=s,f=M(),f!==r?(i=s,pe.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n($e)),a!==r?(pe.test(t.charAt(s))?(o=t.charAt(s),s++):(o=r,l===0&&n($e)),o!==r?(pe.test(t.charAt(s))?(v=t.charAt(s),s++):(v=r,l===0&&n($e)),v!==r?(pe.test(t.charAt(s))?(g=t.charAt(s),s++):(g=r,l===0&&n($e)),g!==r?(a=[a,o,v,g],i=a):(s=i,i=r)):(s=i,i=r)):(s=i,i=r)):(s=i,i=r),i!==r?(t.charCodeAt(s)===46?(a=Ve,s++):(a=r,l===0&&n(Le)),a!==r?(o=s,pe.test(t.charAt(s))?(v=t.charAt(s),s++):(v=r,l===0&&n($e)),v!==r?(pe.test(t.charAt(s))?(g=t.charAt(s),s++):(g=r,l===0&&n($e)),g!==r?(v=[v,g],o=v):(s=o,o=r)):(s=o,o=r),o!==r?(t.charCodeAt(s)===46?(v=Ve,s++):(v=r,l===0&&n(Le)),v!==r?(g=s,pe.test(t.charAt(s))?($=t.charAt(s),s++):($=r,l===0&&n($e)),$!==r?(pe.test(t.charAt(s))?(k=t.charAt(s),s++):(k=r,l===0&&n($e)),k!==r?($=[$,k],g=$):(s=g,g=r)):(s=g,g=r),g!==r?($=M(),$!==r?(u=e,e=ou(i,o,g)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function ii(){var e,f,i,a,o,v,g,$,k;if(e=s,f=M(),f!==r){if(i=[],Z.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(H)),a!==r)for(;a!==r;)i.push(a),Z.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(H));else i=r;if(i!==r)if(t.charCodeAt(s)===58?(a=Se,s++):(a=r,l===0&&n(Ne)),a!==r){if(o=[],Z.test(t.charAt(s))?(v=t.charAt(s),s++):(v=r,l===0&&n(H)),v!==r)for(;v!==r;)o.push(v),Z.test(t.charAt(s))?(v=t.charAt(s),s++):(v=r,l===0&&n(H));else o=r;if(o!==r)if(t.charCodeAt(s)===58?(v=Se,s++):(v=r,l===0&&n(Ne)),v!==r){if(g=[],Z.test(t.charAt(s))?($=t.charAt(s),s++):($=r,l===0&&n(H)),$!==r)for(;$!==r;)g.push($),Z.test(t.charAt(s))?($=t.charAt(s),s++):($=r,l===0&&n(H));else g=r;g!==r?($=ti(),$===r&&($=null),k=M(),k!==r?(u=e,e=uu(i,o,g,$)):(s=e,e=r)):(s=e,e=r)}else s=e,e=r;else s=e,e=r}else s=e,e=r;else s=e,e=r}else s=e,e=r;return e}function ti(){var e,f,i,a;if(e=s,t.charCodeAt(s)===46?(f=Ve,s++):(f=r,l===0&&n(Le)),f!==r){if(i=[],Z.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(H)),a!==r)for(;a!==r;)i.push(a),Z.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(H));else i=r;i!==r?(u=e,e=vu(i)):(s=e,e=r)}else s=e,e=r;return e}function Ig(){var e,f,i,a;return e=s,f=M(),f!==r?(i=Gg(),i!==r?(a=M(),a!==r?(u=e,e=gu(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Gg(){var e,f,i,a;return e=s,f=Vg(),f!==r?(t.charCodeAt(s)===47?(i=ir,s++):(i=r,l===0&&n(cr)),i!==r?(a=ni(),a!==r?(u=e,e=pu(f,a)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Vg(){var e;return t.charCodeAt(s)===66?(e=Uf,s++):(e=r,l===0&&n(da)),e===r&&(t.charCodeAt(s)===87?(e=Ii,s++):(e=r,l===0&&n(rc)),e===r&&(t.charCodeAt(s)===78?(e=Gi,s++):(e=r,l===0&&n(sc)))),e}function li(){var e,f,i,a;return e=s,f=M(),f!==r?(i=ni(),i!==r?(a=M(),a!==r?(u=e,e=$u(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function ni(){var e,f;return e=s,f=pi(),f!==r&&(u=e,f=hu(f)),e=f,e}function zg(){var e,f,i,a;return e=s,f=M(),f!==r?(i=qg(),a=M(),a!==r?(u=e,e=du(i)):(s=e,e=r)):(s=e,e=r),e}function qg(){var e,f,i,a,o,v,g;if(e=s,f=s,i=mr(),i!==r){for(a=[],o=s,t.charCodeAt(s)===58?(v=Se,s++):(v=r,l===0&&n(Ne)),v!==r?(g=mr(),g!==r?(u=o,o=Ta(i,g)):(s=o,o=r)):(s=o,o=r);o!==r;)a.push(o),o=s,t.charCodeAt(s)===58?(v=Se,s++):(v=r,l===0&&n(Ne)),v!==r?(g=mr(),g!==r?(u=o,o=Ta(i,g)):(s=o,o=r)):(s=o,o=r);u=f,f=mu(i,a)}else s=f,f=r;return f===r&&(f=null),u=e,f=bu(f),e=f,e}function mr(){var e,f,i,a,o,v;return e=s,t.charCodeAt(s)===63?(f=Pf,s++):(f=r,l===0&&n(ma)),f!==r&&(u=e,f=Au()),e=f,e===r&&(e=s,t.charCodeAt(s)===45?(f=tr,s++):(f=r,l===0&&n(or)),f!==r&&(u=e,f=Cu()),e=f,e===r&&(e=s,f=ee(),f!==r?(t.charCodeAt(s)===47?(i=ir,s++):(i=r,l===0&&n(cr)),i!==r?(a=ee(),a!==r?(t.charCodeAt(s)===43?(o=lr,s++):(o=r,l===0&&n(ur)),o!==r?(v=ee(),v!==r?(u=e,e=ku(f,a,v)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=ee(),f!==r?(t.charCodeAt(s)===47?(i=ir,s++):(i=r,l===0&&n(cr)),i!==r?(a=ee(),a!==r?(u=e,e=yu(f,a)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=ee(),f!==r?(t.charCodeAt(s)===43?(i=lr,s++):(i=r,l===0&&n(ur)),i!==r?(a=ee(),a!==r?(u=e,e=wu(f,a)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=ee(),f!==r&&(u=e,f=_u(f)),e=f,e===r&&(e=s,t.charCodeAt(s)===42?(f=jf,s++):(f=r,l===0&&n(ba)),f!==r?(i=ee(),i!==r?(u=e,e=Eu(i)):(s=e,e=r)):(s=e,e=r))))))),e}function Qg(){var e,f,i,a;return e=s,f=M(),f!==r?(i=ci(),i!==r?(a=M(),a!==r?(u=e,e=Su(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function ci(){var e,f;return e=s,t.substr(s,3)===Mf?(f=Mf,s+=3):(f=r,l===0&&n(fc)),f!==r&&(u=e,f=Tu(f)),e=f,e===r&&(e=s,t.substr(s,3)===If?(f=If,s+=3):(f=r,l===0&&n(ac)),f!==r&&(u=e,f=Bu(f)),e=f,e===r&&(e=s,t.substr(s,7)===Gf?(f=Gf,s+=7):(f=r,l===0&&n(ic)),f!==r&&(u=e,f=Nu(f)),e=f,e===r&&(e=s,t.charCodeAt(s)===42?(f=jf,s++):(f=r,l===0&&n(ba)),f!==r&&(u=e,f=Ku(f)),e=f))),e}function oi(){var e,f,i,a;return e=s,f=Oe(),f!==r&&(u=e,f=xu(f)),e=f,e===r&&(e=s,f=M(),f!==r?(t.charCodeAt(s)===45?(i=tr,s++):(i=r,l===0&&n(or)),i!==r?(a=M(),a!==r?(u=e,e=Fu()):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=M(),f!==r?(i=M(),i!==r?(u=e,e=Ru()):(s=e,e=r)):(s=e,e=r))),e}function Oe(){var e,f,i,a;if(e=s,f=M(),f!==r){if(i=[],Z.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(H)),a!==r)for(;a!==r;)i.push(a),Z.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(H));else i=r;i!==r?(a=M(),a!==r?(u=e,e=Wu(i)):(s=e,e=r)):(s=e,e=r)}else s=e,e=r;return e}function De(){var e,f,i,a,o,v,g,$,k;return e=s,p(),f=br(),f===r&&(f=null),p(),i=lp(),i===r&&(i=null),p(),a=np(),a!==r?(p(),o=Ci(),o===r&&(o=null),v=Lg(),v===r&&(v=null),p(),g=br(),g===r&&(g=null),p(),$=hi(),$===r&&($=null),k=De(),k===r&&(k=null),u=e,e=Ou(f,i,a,o,v,g,$,k)):(s=e,e=r),e===r&&(e=s,p(),f=Yg(),f!==r?(p(),u=e,e=Du(f)):(s=e,e=r)),e}function Lg(){var e,f,i,a;return e=s,f=di(),f!==r?(t.charCodeAt(s)===61?(i=Vf,s++):(i=r,l===0&&n(vr)),i!==r?(a=mi(),a!==r?(f=[f,i,a],e=f):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Yg(){var e,f;return e=s,f=ci(),f!==r&&(u=e,f=Uu(f)),e=f,e}function br(){var e,f,i,a,o;if(e=s,f=Ar(),f!==r){for(i=[],a=s,p(),o=Ar(),o!==r?(u=a,a=Ba(f,o)):(s=a,a=r);a!==r;)i.push(a),a=s,p(),o=Ar(),o!==r?(u=a,a=Ba(f,o)):(s=a,a=r);u=e,e=Pu(f,i)}else s=e,e=r;return e}function Ar(){var e,f,i,a;return e=s,f=Xg(),f!==r?(i=q(),i!==r?(a=ep(),a!==r?(u=e,e=ju(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=Zg(),f!==r&&(u=e,f=Mu(f)),e=f),e}function q(){var e,f,i,a,o,v,g,$,k,R,y,d,P;if(e=s,f=p(),i=ke(),i!==r)if(t.substr(s,4)===zf?(a=zf,s+=4):(a=r,l===0&&n(tc)),a!==r)if(o=Ke(),o!==r)if(v=Hg(),v===r&&(v=null),g=p(),$=he(),$!==r){for(k=p(),R=[],y=s,d=q(),d!==r&&(u=y,d=Na(v,d)),y=d;y!==r;)R.push(y),y=s,d=q(),d!==r&&(u=y,d=Na(v,d)),y=d;u=e,e=Iu(v,R)}else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=p(),i=ke(),i!==r)if(t.substr(s,4)===qf?(a=qf,s+=4):(a=r,l===0&&n(lc)),a!==r)if(o=Ke(),o!==r)if(v=Jg(),v===r&&(v=null),g=p(),$=he(),$!==r){for(k=p(),R=[],y=s,d=q(),d!==r&&(u=y,d=Ka(v,d)),y=d;y!==r;)R.push(y),y=s,d=q(),d!==r&&(u=y,d=Ka(v,d)),y=d;u=e,e=Gu(v,R)}else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=p(),i=ke(),i!==r)if(t.charCodeAt(s)===37?(a=nr,s++):(a=r,l===0&&n(gr)),a!==r)if(o=sp(),o!==r)if(v=Ke(),v!==r)if(g=pi(),g!==r)if($=p(),k=he(),k!==r){for(R=p(),y=[],d=s,P=q(),P!==r&&(u=d,P=xa(o,g,P)),d=P;d!==r;)y.push(d),d=s,P=q(),P!==r&&(u=d,P=xa(o,g,P)),d=P;u=e,e=Vu(o,g,y)}else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=p(),i=ke(),i!==r)if(t.charCodeAt(s)===37?(a=nr,s++):(a=r,l===0&&n(gr)),a!==r)if(o=fp(),o!==r)if(v=Ke(),v!==r)if(g=ap(),g!==r)if($=p(),k=he(),k!==r){for(R=p(),y=[],d=s,P=q(),P!==r&&(u=d,P=Fa(o,g,P)),d=P;d!==r;)y.push(d),d=s,P=q(),P!==r&&(u=d,P=Fa(o,g,P)),d=P;u=e,e=zu(o,g,y)}else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=p(),i=ke(),i!==r)if(t.substr(s,5)===Qf?(a=Qf,s+=5):(a=r,l===0&&n(nc)),a!==r)if(o=Ke(),o!==r)if(v=Xe(),g=p(),$=he(),$!==r){for(k=p(),R=[],y=s,d=q(),d!==r&&(u=y,d=Ra(v,d)),y=d;y!==r;)R.push(y),y=s,d=q(),d!==r&&(u=y,d=Ra(v,d)),y=d;u=e,e=qu(v,R)}else s=e,e=r;else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=p(),i=ke(),i!==r)if(t.charCodeAt(s)===37?(a=nr,s++):(a=r,l===0&&n(gr)),a!==r)if(o=Xe(),v=Ke(),v!==r){if(g=[],$=vi(),$!==r)for(;$!==r;)g.push($),$=vi();else g=r;if(g!==r)if($=he(),$!==r){for(k=p(),R=[],y=s,d=q(),d!==r&&(u=y,d=Wa(o,g,d)),y=d;y!==r;)R.push(y),y=s,d=q(),d!==r&&(u=y,d=Wa(o,g,d)),y=d;u=e,e=Qu(o,g,R)}else s=e,e=r;else s=e,e=r}else s=e,e=r;else s=e,e=r;else s=e,e=r;if(e===r){if(e=s,f=[],i=ui(),i!==r)for(;i!==r;)f.push(i),i=ui();else f=r;if(f!==r){for(i=[],a=s,o=p(),v=q(),v!==r?(u=a,a=Oa(f,v)):(s=a,a=r);a!==r;)i.push(a),a=s,o=p(),v=q(),v!==r?(u=a,a=Oa(f,v)):(s=a,a=r);u=e,e=Lu(f,i)}else s=e,e=r}}}}}}return e}function ui(){var e,f,i,a;return e=s,f=s,l++,t.substr(s,2)===Lf?(i=Lf,s+=2):(i=r,l===0&&n(cc)),l--,i===r?f=void 0:(s=f,f=r),f!==r?(i=s,l++,t.charCodeAt(s)===125?(a=Yf,s++):(a=r,l===0&&n(Aa)),l--,a===r?i=void 0:(s=i,i=r),i!==r?(t.length>s?(a=t.charAt(s),s++):(a=r,l===0&&n(Ca)),a!==r?(u=e,e=Yu(a)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function vi(){var e,f,i;return e=s,f=s,l++,i=he(),l--,i===r?f=void 0:(s=f,f=r),f!==r?(t.length>s?(i=t.charAt(s),s++):(i=r,l===0&&n(Ca)),i!==r?(u=e,e=Zu(i)):(s=e,e=r)):(s=e,e=r),e}function Zg(){var e,f,i,a;if(e=s,f=rp(),f!==r){for(i=[],va.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(ka));a!==r;)i.push(a),va.test(t.charAt(s))?(a=t.charAt(s),s++):(a=r,l===0&&n(ka));a=jg(),a!==r?(u=e,e=Hu(i)):(s=e,e=r)}else s=e,e=r;return e}function Hg(){var e,f,i,a,o,v,g;if(e=s,f=Cr(),f!==r){for(p(),i=[],a=s,t.charCodeAt(s)===44?(o=ze,s++):(o=r,l===0&&n(Ye)),o!==r?(v=p(),g=Cr(),g!==r?(o=[o,v,g],a=o):(s=a,a=r)):(s=a,a=r);a!==r;)i.push(a),a=s,t.charCodeAt(s)===44?(o=ze,s++):(o=r,l===0&&n(Ye)),o!==r?(v=p(),g=Cr(),g!==r?(o=[o,v,g],a=o):(s=a,a=r)):(s=a,a=r);u=e,e=Ju(f,i)}else s=e,e=r;return e}function Cr(){var e,f,i;return e=s,f=gi(),f!==r?(i=yr(),i!==r?(u=e,e=Xu(f,i)):(s=e,e=r)):(s=e,e=r),e}function Jg(){var e,f,i,a,o,v,g;if(e=s,f=kr(),f!==r){for(p(),i=[],a=s,t.charCodeAt(s)===44?(o=ze,s++):(o=r,l===0&&n(Ye)),o!==r?(v=p(),g=kr(),g!==r?(o=[o,v,g],a=o):(s=a,a=r)):(s=a,a=r);a!==r;)i.push(a),a=s,t.charCodeAt(s)===44?(o=ze,s++):(o=r,l===0&&n(Ye)),o!==r?(v=p(),g=kr(),g!==r?(o=[o,v,g],a=o):(s=a,a=r)):(s=a,a=r);u=e,e=ev(f,i)}else s=e,e=r;return e}function kr(){var e,f,i,a;return e=s,f=gi(),f!==r?(i=yr(),i!==r?(a=yr(),a!==r?(u=e,e=rv(f,i,a)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function gi(){var e,f;return e=s,t.charCodeAt(s)===89?(f=Vi,s++):(f=r,l===0&&n(oc)),f!==r&&(u=e,f=sv()),e=f,e===r&&(e=s,t.charCodeAt(s)===71?(f=zi,s++):(f=r,l===0&&n(uc)),f!==r&&(u=e,f=fv()),e=f,e===r&&(e=s,t.charCodeAt(s)===82?(f=qi,s++):(f=r,l===0&&n(vc)),f!==r&&(u=e,f=av()),e=f,e===r&&(e=s,t.charCodeAt(s)===66?(f=Uf,s++):(f=r,l===0&&n(da)),f!==r&&(u=e,f=iv()),e=f))),e}function yr(){var e,f,i;return e=s,f=me(),f!==r?(i=be(),i!==r?(u=e,e=tv(f,i)):(s=e,e=r)):(s=e,e=r),e}function Xg(){var e;return t.charCodeAt(s)===123?(e=Qi,s++):(e=r,l===0&&n(gc)),e}function ep(){var e;return t.charCodeAt(s)===125?(e=Yf,s++):(e=r,l===0&&n(Aa)),e}function ke(){var e;return t.charCodeAt(s)===91?(e=Li,s++):(e=r,l===0&&n(pc)),e}function he(){var e;return t.charCodeAt(s)===93?(e=Yi,s++):(e=r,l===0&&n($c)),e}function rp(){var e;return t.charCodeAt(s)===59?(e=Zi,s++):(e=r,l===0&&n(hc)),e}function sp(){var e,f;return e=s,t.substr(s,3)===Zf?(f=Zf,s+=3):(f=r,l===0&&n(dc)),f!==r&&(u=e,f=lv()),e=f,e===r&&(e=s,t.substr(s,3)===Hf?(f=Hf,s+=3):(f=r,l===0&&n(mc)),f!==r&&(u=e,f=nv()),e=f,e===r&&(e=s,t.substr(s,3)===Jf?(f=Jf,s+=3):(f=r,l===0&&n(bc)),f!==r&&(u=e,f=cv()),e=f)),e}function fp(){var e,f;return e=s,t.substr(s,3)===Xf?(f=Xf,s+=3):(f=r,l===0&&n(Ac)),f!==r&&(u=e,f=ov()),e=f,e}function pi(){var e,f,i,a,o;return e=s,f=$i(),f===r&&(f=null),i=de(),i!==r?(a=de(),a===r&&(a=null),o=ti(),o===r&&(o=null),u=e,e=uv(f,i,a,o)):(s=e,e=r),e}function ap(){var e,f,i,a;return e=s,f=$i(),f===r&&(f=null),i=de(),i!==r?(a=de(),a===r&&(a=null),u=e,e=vv(f,i,a)):(s=e,e=r),e}function $i(){var e,f,i;return e=s,f=ip(),f!==r?(i=tp(),i===r&&(i=null),u=e,e=gv(f,i)):(s=e,e=r),e}function ip(){var e,f,i,a;return e=s,f=de(),f!==r?(i=de(),i===r&&(i=null),t.charCodeAt(s)===58?(a=Se,s++):(a=r,l===0&&n(Ne)),a!==r?(u=e,e=pv(f,i)):(s=e,e=r)):(s=e,e=r),e}function tp(){var e,f,i,a;return e=s,f=de(),f!==r?(i=de(),i===r&&(i=null),t.charCodeAt(s)===58?(a=Se,s++):(a=r,l===0&&n(Ne)),a!==r?(u=e,e=$v(f,i)):(s=e,e=r)):(s=e,e=r),e}function de(){var e,f;return e=s,Z.test(t.charAt(s))?(f=t.charAt(s),s++):(f=r,l===0&&n(H)),f!==r&&(u=e,f=hv(f)),e=f,e}function hi(){var e,f,i,a,o;return e=s,f=di(),f!==r?(i=De(),i!==r?(a=mi(),a!==r?(p(),o=hi(),o===r&&(o=null),u=e,e=dv(i,o)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function di(){var e;return t.charCodeAt(s)===40?(e=Hi,s++):(e=r,l===0&&n(Cc)),e}function mi(){var e;return t.charCodeAt(s)===41?(e=Ji,s++):(e=r,l===0&&n(kc)),e}function lp(){var e,f,i,a,o;if(e=s,f=ee(),f!==r){for(i=[],a=Ai();a!==r;)i.push(a),a=Ai();for(a=[],o=bi();o!==r;)a.push(o),o=bi();u=e,e=mv(f)}else s=e,e=r;return e}function bi(){var e;return t.charCodeAt(s)===46?(e=Ve,s++):(e=r,l===0&&n(Le)),e}function ee(){var e,f,i;if(l++,e=s,f=[],Z.test(t.charAt(s))?(i=t.charAt(s),s++):(i=r,l===0&&n(H)),i!==r)for(;i!==r;)f.push(i),Z.test(t.charAt(s))?(i=t.charAt(s),s++):(i=r,l===0&&n(H));else f=r;return f!==r&&(u=e,f=bv(f)),e=f,l--,e===r&&(f=r,l===0&&n(yc)),e}function Ai(){var e,f,i;if(e=s,f=[],t.charCodeAt(s)===32?(i=ea,s++):(i=r,l===0&&n(ya)),i!==r)for(;i!==r;)f.push(i),t.charCodeAt(s)===32?(i=ea,s++):(i=r,l===0&&n(ya));else f=r;return f!==r&&(u=e,f=Av()),e=f,e}function np(){var e,f,i,a,o,v,g,$,k;return e=s,f=er(),f===r&&(f=null),i=s,l++,a=op(),l--,a!==r?(s=i,i=void 0):i=r,i!==r?(a=ki(),a!==r?(o=_r(),o===r&&(o=null),v=me(),v!==r?(g=be(),g!==r?($=wr(),$===r&&($=null),k=Ue(),k===r&&(k=null),p(),t.substr(s,4)===Xi?s+=4:l===0&&n(wc),u=e,e=Cv(f,a,o,v,g,$,k)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=er(),f===r&&(f=null),i=me(),i!==r?(a=be(),a!==r?(o=vp(),o===r&&(o=null),v=me(),v!==r?(g=be(),g!==r?($=wr(),$===r&&($=null),k=Ue(),k===r&&(k=null),u=e,e=kv(f,i,a,o,v,g,$,k)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,f=er(),f===r&&(f=null),i=_r(),i===r&&(i=null),a=me(),a!==r?(o=be(),o!==r?(v=wr(),v===r&&(v=null),g=Ue(),g===r&&(g=null),u=e,e=yv(f,i,a,o,v,g)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,t.substr(s,5)===ra?(f=ra,s+=5):(f=r,l===0&&n(_c)),f!==r?(i=Ue(),i===r&&(i=null),u=e,e=wv(i)):(s=e,e=r),e===r&&(e=s,t.substr(s,3)===sa?(f=sa,s+=3):(f=r,l===0&&n(Ec)),f!==r?(i=Ue(),i===r&&(i=null),u=e,e=_v(i)):(s=e,e=r),e===r&&(e=s,f=er(),f!==r?(t.charCodeAt(s)===64?(i=et,s++):(i=r,l===0&&n(Sc)),i!==r?(a=me(),a!==r?(o=be(),o!==r?(u=e,e=Ev(f,a,o)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)))))),e}function Ue(){var e,f,i,a;return e=s,f=s,i=s,l++,t.substr(s,2)===qe?(a=qe,s+=2):(a=r,l===0&&n(wa)),l--,a===r?i=void 0:(s=i,i=r),i!==r?(t.charCodeAt(s)===43?(a=lr,s++):(a=r,l===0&&n(ur)),a!==r?(i=[i,a],f=i):(s=f,f=r)):(s=f,f=r),f!==r&&(u=e,f=Sv(f)),e=f,e===r&&(e=s,f=s,i=s,l++,t.substr(s,3)===fa?(a=fa,s+=3):(a=r,l===0&&n(Tc)),l--,a===r?i=void 0:(s=i,i=r),i!==r?(t.charCodeAt(s)===35?(a=rt,s++):(a=r,l===0&&n(Bc)),a!==r?(i=[i,a],f=i):(s=f,f=r)):(s=f,f=r),f!==r&&(u=e,f=Tv(f)),e=f),e}function wr(){var e,f;return e=s,t.charCodeAt(s)===61?s++:l===0&&n(vr),f=up(),f!==r?(u=e,e=Bv(f)):(s=e,e=r),e}function Ci(){var e,f,i;return e=s,f=cp(),f!==r?(p(),i=Ci(),i===r&&(i=null),u=e,e=Nv(f,i)):(s=e,e=r),e}function cp(){var e,f,i;return e=s,t.charCodeAt(s)===36?(f=st,s++):(f=r,l===0&&n(Nc)),f!==r?(i=ee(),i!==r?(u=e,e=Kv(i)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,t.substr(s,2)===aa?(f=aa,s+=2):(f=r,l===0&&n(Kc)),f!==r&&(u=e,f=xv()),e=f,e===r&&(e=s,t.substr(s,2)===ia?(f=ia,s+=2):(f=r,l===0&&n(xc)),f!==r&&(u=e,f=Fv()),e=f,e===r&&(e=s,t.substr(s,2)===ta?(f=ta,s+=2):(f=r,l===0&&n(Fc)),f!==r&&(u=e,f=Rv()),e=f,e===r&&(e=s,t.substr(s,2)===la?(f=la,s+=2):(f=r,l===0&&n(Rc)),f!==r&&(u=e,f=Wv()),e=f,e===r&&(e=s,t.charCodeAt(s)===33?(f=ft,s++):(f=r,l===0&&n(Wc)),f!==r&&(u=e,f=Ov()),e=f,e===r&&(e=s,t.charCodeAt(s)===63?(f=Pf,s++):(f=r,l===0&&n(ma)),f!==r&&(u=e,f=Dv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8252?(f=at,s++):(f=r,l===0&&n(Oc)),f!==r&&(u=e,f=Uv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8263?(f=it,s++):(f=r,l===0&&n(Dc)),f!==r&&(u=e,f=Pv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8265?(f=tt,s++):(f=r,l===0&&n(Uc)),f!==r&&(u=e,f=jv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8264?(f=lt,s++):(f=r,l===0&&n(Pc)),f!==r&&(u=e,f=Mv()),e=f,e===r&&(e=s,t.charCodeAt(s)===9633?(f=nt,s++):(f=r,l===0&&n(jc)),f!==r&&(u=e,f=Iv()),e=f,e===r&&(e=s,t.charCodeAt(s)===61?(f=Vf,s++):(f=r,l===0&&n(vr)),f!==r&&(u=e,f=Gv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8734?(f=ct,s++):(f=r,l===0&&n(Mc)),f!==r&&(u=e,f=Vv()),e=f,e===r&&(e=s,t.charCodeAt(s)===10866?(f=ot,s++):(f=r,l===0&&n(Ic)),f!==r&&(u=e,f=zv()),e=f,e===r&&(e=s,t.charCodeAt(s)===10865?(f=ut,s++):(f=r,l===0&&n(Gc)),f!==r&&(u=e,f=qv()),e=f,e===r&&(e=s,t.charCodeAt(s)===177?(f=vt,s++):(f=r,l===0&&n(Vc)),f!==r&&(u=e,f=Qv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8723?(f=gt,s++):(f=r,l===0&&n(zc)),f!==r&&(u=e,f=Lv()),e=f,e===r&&(e=s,t.substr(s,2)===qe?(f=qe,s+=2):(f=r,l===0&&n(wa)),f!==r&&(u=e,f=Yv()),e=f,e===r&&(e=s,t.substr(s,2)===na?(f=na,s+=2):(f=r,l===0&&n(qc)),f!==r&&(u=e,f=Zv()),e=f,e===r&&(e=s,t.charCodeAt(s)===10752?(f=pt,s++):(f=r,l===0&&n(Qc)),f!==r&&(u=e,f=Hv()),e=f,e===r&&(e=s,t.charCodeAt(s)===10227?(f=$t,s++):(f=r,l===0&&n(Lc)),f!==r&&(u=e,f=Jv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8594?(f=ht,s++):(f=r,l===0&&n(Yc)),f!==r&&(u=e,f=Xv()),e=f,e===r&&(e=s,t.charCodeAt(s)===8593?(f=dt,s++):(f=r,l===0&&n(Zc)),f!==r&&(u=e,f=eg()),e=f,e===r&&(e=s,t.charCodeAt(s)===8646?(f=mt,s++):(f=r,l===0&&n(Hc)),f!==r&&(u=e,f=rg()),e=f,e===r&&(e=s,t.charCodeAt(s)===68?(f=bt,s++):(f=r,l===0&&n(Jc)),f!==r&&(u=e,f=sg()),e=f))))))))))))))))))))))))),e}function ki(){var e;return e=me(),e===r&&(e=be()),e}function op(){var e,f,i,a,o;return e=s,f=ki(),f!==r?(i=_r(),i===r&&(i=null),a=me(),a!==r?(o=be(),o!==r?(f=[f,i,a,o],e=f):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function er(){var e;return Ct.test(t.charAt(s))?(e=t.charAt(s),s++):(e=r,l===0&&n(Xc)),e}function up(){var e;return kt.test(t.charAt(s))?(e=t.charAt(s),s++):(e=r,l===0&&n(eo)),e}function me(){var e;return yt.test(t.charAt(s))?(e=t.charAt(s),s++):(e=r,l===0&&n(ro)),e}function be(){var e;return wt.test(t.charAt(s))?(e=t.charAt(s),s++):(e=r,l===0&&n(so)),e}function _r(){var e;return t.charCodeAt(s)===120?(e=ca,s++):(e=r,l===0&&n(_a)),e}function vp(){var e;return t.charCodeAt(s)===120?(e=ca,s++):(e=r,l===0&&n(_a)),e===r&&(t.charCodeAt(s)===45?(e=tr,s++):(e=r,l===0&&n(or))),e}var rr=[];function L(e){var f=Object.assign(e,fg());return rr.push(f),f}function Er(e){return parseInt(e.join(""),10)}function ye(e){return e.join("").match(/\?/)?e.join(""):Er(e)}function Ae(e){var f={};return e.forEach(function(i){for(var a in i)Array.isArray(i[a])?f[a]=f[a]?f[a].concat(i[a]):i[a]:f[a]=f[a]?wi(f[a])+" "+yi(i[a]):i[a]}),f}function yi(e){if(typeof e!="string")return e;var f=/^\s+/;return e.replace(f,"")}function wi(e){if(typeof e!="string")return e;var f=/\s+$/;return e.replace(f,"")}if(He=I(),He!==r&&s===t.length)return He;throw He!==r&&s<t.length&&n(ig()),tg(pr,ie<t.length?t.charAt(ie):null,ie<t.length?$r(ie,ie+1):$r(ie,ie))}return{SyntaxError:x,parse:F}})})(se);var fe=S;function oe(T,K){return!K||K.startRule==="games"?Ce(T,K):ue(T,K)}function ue(T,K={startRule:"game"}){T=T.trim();let x=fe.parse(T,K),j={moves:[],messages:[]};if(K.startRule==="pgn"){let F=x;j.moves=F}else if(K.startRule==="tags"){let F=x;j.tags=F}else j=x;return Q(j,T,K)}function Q(T,K,x){function j(t){if(x.startRule!=="tags"){let A=t.moves[t.moves.length-1];if(typeof A=="string"&&(t.moves.pop(),t.tags)){let r=t.tags.Result;r&&A!==r&&t.messages.push({key:"Result",value:r,message:"Result in tags is different to result in SAN"}),t.tags.Result=A}}return t}function F(t){function A(r){function O(D){return D.split(/\s+/)[1]}function N(D,_){function w(U){return U==="w"?"b":"w"}return D.turn=_,D.variations&&D.variations.forEach(function(U){let J=_;U.forEach(Fe=>J=N(Fe,J))}),w(_)}const I="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";let V=x.fen||r.tags&&r.tags.FEN||I,G=O(V);return r.moves.forEach(D=>G=N(D,G)),r}return t.moves?A(t):t}return F(j(T))}function Ce(T,K={startRule:"games"}){function x(A){if(!Array.isArray(A))return[];if(A.length===0)return A;let r=A.pop();return(r.tags!==void 0||r.moves.length>0)&&A.push(r),A}function j(A,r,O={startRule:"games"}){return x(A)}const F=Object.assign({startRule:"games"},K);let t=fe.parse(T,F);return t?(j(t,T,F),t.forEach(A=>{Q(A,T,F)}),t):[]}const _e=(T,K=`
`)=>T.replace(/\r?\n/g,K);function ve(T,K={startRule:"games"}){let x=_e(T).split(`

`),j=[],F={tags:"",pgn:"",all:""};return x.forEach(function(t){if(t.startsWith("["))F.tags=t;else if(t){F.pgn=t;let A=F.tags?F.tags+`

`+F.pgn:F.pgn;F.all=A,j.push(F),F={tags:"",pgn:"",all:""}}}),j}b.parse=oe,b.parseGame=ue,b.parseGames=Ce,b.split=ve,Object.defineProperty(b,"__esModule",{value:!0})})})(Bp,fr);const Np=(h,m)=>{let b={};return h.forEach(W=>{let S=m(W);S&&(b[W]=S)}),b},Di=["a","b","c","d","e","f","g","h"],Kp=["1","2","3","4","5","6","7","8"],xp=["q","n","r","b"],Ui=Di.flatMap(h=>Kp.map(m=>`${h}${m}`)),Fp=h=>[h.slice(0,2),h.slice(2)],Rp=h=>h.split("="),Pi=35,ji=String.fromCharCode(33),Wp=h=>Ui.indexOf(h)+1,Mi=Np(Ui,h=>String.fromCharCode(Wp(h)+Pi)),Kr=h=>Mi[h]||ji,Op=(()=>{let h={};return xp.map((m,b)=>{Di.map((W,S)=>{let se=m+W,fe=String.fromCharCode(Pi+Object.keys(Mi).length+b*8+S-1);h[se]=fe})}),h})(),Dp=(h,m)=>Op[m+h]||ji,Up=h=>{let[m,b]=Rp(h),[W,S]=Fp(m);return b?Kr(W)+Dp(S[0],b):Kr(W)+Kr(S)};function Pp(h){return fr.parse(h,{startRule:"games"}).map(jp)}function jp(h){var fe,oe,ue;let m=((fe=h.tags)==null?void 0:fe.Event)||"",b=(oe=h.tags)==null?void 0:oe.FEN,W=(ue=h.tags)==null?void 0:ue.Site,S=[];function se(Q,Ce,_e,ve=!1){_e.forEach((T,K)=>{let x=K===0&&ve,j=K===_e.length-1&&T.variations.length===0,F=T.notation.notation,t=Ce.fen(),A=Ce.move(F).lan,r=Up(A),O=T.variations.map(G=>{let _=G[0].notation.notation;return new Br(t).move(_).lan}),I=[A,...O],V={path:Q,fen:t,moves:I};j&&(V.final=!0),!x&&I.length>0&&S.push(V),T.variations.forEach(G=>{let D=new Br(t);se(Q,D,G,!0)}),Q=Q+r})}return se("",new Br(b||Gp),h.moves),{title:m,fen:b,site:W,poss:S}}class Mp{constructor(m){Sr(this,"by_fen");this.pgn=m,this.by_fen=new Map,m.poss.forEach(b=>{this.by_fen.set(b.fen,b)})}get title(){return this.pgn.title}pick_move(m){let b=this.by_fen.get(m);if(b)return Ip(b.moves)}score(m){const b=this.by_fen.get(m);if(b)return{max_ply:this.pgn.poss.filter(S=>S.final).map(S=>S.path).filter(S=>S.includes(b.path)).map(S=>S.length).sort((S,se)=>S-se)[0]/2,ply:b.path.length/2}}}function Ip(h){let m=h.length*(h.length+1)/2,b=Math.floor(Math.random()*m)+1,W=0;for(let S=0;S<h.length;S++)if(W+=h.length-S,b<=W)return h[S];return 0}const Gp="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class Vp{constructor(){Sr(this,"_completed");this._completed=this._prop("completed",[])}_key(m){return["aidchess","dem_solves",m].join(".")}_prop(m,b){return _p(this._key(m),()=>b)}clear(){this._completed([])}complete(m){let b=this.completeds;b=b.filter(W=>W.title!==m.title),b.push(m),this._completed(b)}get completeds(){return this._completed()}}const Ki=new Vp;class zp{complete(m){Ki.complete({title:m})}is_complete(m){return!!Ki.completeds.find(b=>b.title===m)}}const xi=new zp,Fi=ce('<div class="show"><a class="button" target="_blank">View Solution on Lichess</a></div>'),qp=ce("<span>Loading puzzles please wait..</span>"),Qp=ce("<span>Puzzle complete!</span>"),Lp=ce("<div><a>Next puzzle</a></div>"),Yp=ce("<span>Failed.</span>"),Zp=ce("<div><a>Try again</a></div>"),Hp=ce('<div class="dem"><div class="board-replay"><div class="board"></div><div class="replay"></div><div class="feedback"></div></div><div class="studies"></div><div class="side"><div class="chapters"></div></div></div>'),Ri=ce("<div><span></span><h3></h3></div>"),Jp=ce("<span>Completed</span>"),Wi=h=>h?"active":"";function t$(){let[h,m]=we("loading"),[b,W]=we(0),S=re(()=>Ni[b()]),[se]=$p(()=>S().link,Sp),fe=re(()=>{let C=se();return C?Pp(C.pgn):[]}),[oe,ue]=we(0),Q=re(()=>{let C=oe(),B=fe();if(B)return B[C]});const[Ce,_e]=we(void 0,{equals:!1}),[ve,T]=we(""),[K,x]=we(Bi.make(),{equals:!1}),j=re(()=>K().moves()),F=re(()=>K().chess(ve())),t=re(()=>K().fen(ve()));re(()=>F().pgn());const A={w:"White",b:"Black"},[r,O]=we("w"),N=re(()=>A[r()]),I=()=>{const C=Q();m("solving"),bp(()=>{x(Bi.make(C.fen)),T(""),C.title.match(" pw")?O("w"):C.title.match(" pb")?O("b"):O(Oi(C.fen))})};Tr(_i(Q,C=>{C&&I()})),Tr(()=>{let C=Q(),B=h();C&&B==="solved"&&(xi.complete(C.title),_e())});const V=re(()=>{const C=Q();if(C)return new Mp(C)}),G=re(()=>{const C=V();if(C)return C.by_fen.get(t())});Tr(_i(t,C=>{const B=V();if(!B)return;if(B.by_fen.size===0&&m("solved"),Oi(C)!==r()){const le=B.pick_move(t());le?_(le):h()!=="failed"&&m("solved")}}));const D=C=>{const B=G();B&&(B.moves.includes(C)||m("failed"),_(C))},_=C=>{let B;x(z=>(B=z.add_move(ve(),C),z)),B&&T(B)};let w=Cp.make;const Pe={loading:()=>qp.cloneNode(!0),solving:()=>[re(N),"'s turn, find the solution.",(()=>{const C=Fi.cloneNode(!0),B=C.firstChild;return sr(()=>{var z;return Ti(B,"href",(z=Q())==null?void 0:z.site)}),C})()],solved:()=>[Qp.cloneNode(!0),(()=>{const C=Lp.cloneNode(!0),B=C.firstChild;return B.$$click=()=>ue(oe()+1),C})()],failed:()=>[Yp.cloneNode(!0),(()=>{const C=Zp.cloneNode(!0),B=C.firstChild;return B.$$click=()=>I(),C})(),(()=>{const C=Fi.cloneNode(!0),B=C.firstChild;return sr(()=>{var z;return Ti(B,"href",(z=Q())==null?void 0:z.site)}),C})()]};return(()=>{const C=Hp.cloneNode(!0),B=C.firstChild,z=B.firstChild,le=z.nextSibling,je=le.nextSibling,Re=B.nextSibling,Me=Re.nextSibling,Ie=Me.firstChild;te(z,xe(wp,{glyphs:[],get fen(){return t()},isBlack:!1,onUserMove:D}));const We=kp(w);return typeof We=="function"&&hp(We,le),te(le,xe(yp,{get moves(){return j()},get on_path(){return ve()},on_click:ne=>T(ne)})),te(je,xe(dp,{get component(){return Pe[h()]}})),te(Re,xe(Si,{each:Ni,children:(ne,ae)=>(()=>{const Y=Ri.cloneNode(!0),ge=Y.firstChild,Ee=ge.nextSibling;return Y.$$click=()=>W(ae()),te(ge,()=>ae()+1),te(Ee,()=>ne.title),sr(()=>Ei(Y,Wi(ae()===b()))),Y})()})),te(Ie,xe(Si,{get each(){return fe()},children:(ne,ae)=>(()=>{const Y=Ri.cloneNode(!0),ge=Y.firstChild,Ee=ge.nextSibling;return Y.$$click=()=>ue(ae()),te(ge,()=>ae()+1),te(Ee,()=>ne.title),te(Y,xe(mp,{get when(){return Ce()||xi.is_complete(ne.title)},get children(){return Jp.cloneNode(!0)}}),null),sr(()=>Ei(Y,Wi(ae()===oe()))),Y})()})),C})()}const Oi=h=>h.split(" ")[1];Ap(["click"]);export{t$ as default};
